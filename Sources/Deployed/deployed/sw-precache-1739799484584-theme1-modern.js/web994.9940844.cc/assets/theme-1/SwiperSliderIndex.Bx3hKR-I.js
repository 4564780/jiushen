import{a as N,az as h,cd as B,bq as Y,I as x,q as E,cZ as w,kk as z,cp as F,ln as U,bu as j,dN as J,a6 as O,v as V}from"./main.C8q1iJMV.js";import{M as L,u as W,S as Z,R as G,a as H}from"./SlideItemIndex.1G2Tn6E0.js";import{S as K,a as Q}from"../vendors/vendor-swiper.ZXc-sUCV.js";import"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import{l as D,f as y,p as t,r as f,w as X,o as ee,a as te,A as C,q as ae,n as ie}from"../vendors/vendor-@vue.DNlpgob2.js";import{R as ne}from"./RecordInfoIndex.DfJ68Kg9.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-stable.LD58Pbb3.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"./ModalContentIndex.Dj08dEyt.js";import"./index.C870Y1OX.js";import"./index.nTWlx4yZ.js";import"./ListItemIndex.Bcx-5lrU.js";import"./SourceTextIndex.B2mGCFWw.js";import"./ReceiveCountdownIndex.C4K-6t0P.js";import"./useReceiveOne.D6y37THV.js";const d={"canreceive-info-bottom":"_canreceive-info-bottom_1yo3y_17","canreceive-info-title":"_canreceive-info-title_1yo3y_23","canreceive-info-currency":"_canreceive-info-currency_1yo3y_26","canreceive-info-activity":"_canreceive-info-activity_1yo3y_27"},[ce]=E("pages-can-receive-receive-info"),re=D({name:ce,props:{lastDataList:{type:Array,default:()=>[]},swiperNowIdx:{type:Number,default:void 0}},emits:["retry"],setup(s){const{t:I}=N(),g=h(),p=y(()=>{var a,c;return(c=B[((a=g.userInfos)==null?void 0:a.currency)||"CNY"])==null?void 0:c.PAY_JB}),v=y(()=>{var a;if(s.swiperNowIdx!==void 0){const c=s.lastDataList[s.swiperNowIdx];if(c){const r=Math.floor(c.reward||0).toString(),i=Math.floor(c.activity||0).toString();return{reward:"".concat(r.length>4?r==null?void 0:r.replace(/\d/g,"*"):"***").concat((a=Y(0))==null?void 0:a.replace(/\d/g,"*")),activityShow:!!c.activity,activity:i.length>4?i==null?void 0:i.replace(/\d/g,"*"):"****"}}}return{reward:"****.**",activity:"****"}});return()=>{var a,c,r;return t("div",{class:[d["canreceive-info-bottom"],"canreceive-info-bottom"]},[t("div",{class:d["canreceive-info-title"]},[I("lobby.reward.base.toBeCollected")]),t("div",{class:d["canreceive-info-currency"]},[t(x,{class:[d["icon-text"]],src:p.value},null),t("span",{class:d["canreceive-info-value"]},[(a=v.value)==null?void 0:a.reward])]),!!((c=v.value)!=null&&c.activityShow)&&t("div",{class:d["canreceive-info-activity"]},[t(x,{src:"/lobby_asset/common/web/common/comm_icon_shy.svg"},null),t("span",{class:d["canreceive-info-value"]},[(r=v.value)==null?void 0:r.activity])])])}}}),l={"canreceive-top-box":"_canreceive-top-box_1ggg5_17","canreceive-header":"_canreceive-header_1ggg5_25","canreceive-select":"_canreceive-select_1ggg5_31","canreceive-placeholder":"_canreceive-placeholder_1ggg5_42","redpack-mode":"_redpack-mode_1ggg5_46","swiper-container":"_swiper-container_1ggg5_49","swiper-slide":"_swiper-slide_1ggg5_53","treasure-mode":"_treasure-mode_1ggg5_59","image-loaded":"_image-loaded_1ggg5_72","receive-records":"_receive-records_1ggg5_85"},[oe]=E("pages-home-discount-can-receive-modes-swiper"),Ce=D({name:oe,props:{canReceiveStyle:{type:Number,default:w.Normal}},setup(s){const{t:I}=N(),g=z(),p=f(),v=f(0),a=f(null),c=f(!1),r=f(void 0),i=F(U,{immediate:!1,transformFn:e=>{var o,m;return v.value=(o=e.totalActivity)!=null?o:0,{data:(m=e.list)==null?void 0:m.filter(R=>!g.receivedList.includes(R.id)),total:e.count}},defaultPageSize:20});X(()=>h().hasLogined,(e,n)=>{e!==n&&_()}),ee(()=>{_()}),te(()=>{S()});const _=async()=>{h().hasLogined&&i.loadData(!0)},S=async()=>{var e;_(),(e=p.value)==null||e.initRecordData()},k=e=>{a.value=e},A=()=>{c.value=!0},M=()=>{var n,o;const e=g.receivedList;(n=a.value)!=null&&n.id&&g.updateReceivedList([...e,(o=a.value)==null?void 0:o.id]),a.value=null,c.value=!1,S()};C("refreshData",S),C("receiveSuccess",k);const P=y(()=>{var e;return i.loading.value||j().isListLoading?"nested-loading":i.listError.value?"retry":(e=i.list.value)!=null&&e.length?null:"empty"}),u=y(()=>{const e=[...i.list.value];return(e==null?void 0:e.length)<L?e:[e[1],e[0],...e.slice(2)]}),T=e=>{ie(()=>{var n,o;e&&((n=u.value)==null?void 0:n.length)>=L&&((o=e==null?void 0:e.slideTo)==null||o.call(e,1,0))})},$=e=>{var n;r.value=e.realIndex,r.value===((n=u.value)==null?void 0:n.length)-1&&r.value<i.total.value-1&&i.loadData()},q=y(()=>W().getSwiperConfig(s.canReceiveStyle,!1));return()=>t(V,null,{default:()=>[t("div",{class:{[l["canreceive-top-box"]]:!0,[l["redpack-mode"]]:s.canReceiveStyle===w.RedPocket,[l["treasure-mode"]]:s.canReceiveStyle===w.Treasure,[l["image-loaded"]]:c.value}},[h().hasLogined&&t("div",{class:l["canreceive-header"]},[t("div",{class:l["canreceive-select"]},[t(J,{placement:"bottom-start",offset:[0,10]},null)]),t(ne,{listError:!!i.listError.value,loading:i.loading.value,totalActivity:v.value,onRetry:_},null)]),t(O,{empty:{text:I("lobby.event.luckyWheel.tabs.noData")},class:{[l["canreceive-placeholder"]]:!0},type:P.value,onRetry:S},{default:()=>{var e,n;return[!!((e=u.value)!=null&&e.length)&&t(K,ae({class:l["swiper-container"]},q.value,{onInit:T,onTransitionEnd:$}),{default:()=>{var o;return[(o=u.value)==null?void 0:o.map((m,R)=>t(Q,{class:l["swiper-slide"],key:m.id},{default:()=>{var b;return[t(Z,{key:m.id,slideItem:m,totolLength:(b=i.list.value)==null?void 0:b.length,swiperNowIdx:r.value,idx:R,canReceiveStyle:s.canReceiveStyle},null)]}}))]}}),!!((n=u.value)!=null&&n.length)&&t(re,{lastDataList:u.value,swiperNowIdx:r.value},null)]}})]),t(G,{ref:p,class:l["receive-records"],canReceiveStyle:s.canReceiveStyle},null),!!a.value&&t(H,{canReceiveStyle:s.canReceiveStyle,targetItem:a.value,onAnimatedEnd:M,onImageShowEnd:A},null)]})}});export{Ce as default};
//# sourceMappingURL=SwiperSliderIndex.Bx3hKR-I.js.map
