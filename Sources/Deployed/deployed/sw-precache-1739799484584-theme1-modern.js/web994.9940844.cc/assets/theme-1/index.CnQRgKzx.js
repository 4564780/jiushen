import{aX as Ve,a$ as j,N as q,aP as J,b0 as L,aS as F,aT as W,b1 as A,U as Y,b2 as Be,ar as ye,R as G,b3 as Te,b4 as ee,a as Oe,at as ke,b5 as Ye,b6 as ie,Y as re,b7 as Ne,Q as B,b8 as _e,T as te,b9 as $e,M as De,ba as pe,bb as se}from"./main.C8q1iJMV.js";import"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import{l as N,r as x,f as C,D as Fe,p as m,ad as je,F as Re,C as Ae,w as R,n as ue,q as Ce}from"../vendors/vendor-@vue.DNlpgob2.js";const xe=e=>e.find(n=>!n.disabled)||e[0];function Ue(e,n){const a=e[0];if(a){if(Array.isArray(a))return"multiple";if(n.children in a)return"cascade"}return"default"}function K(e,n){n=j(n,0,e.length);for(let a=n;a<e.length;a++)if(!e[a].disabled)return a;for(let a=n-1;a>=0;a--)if(!e[a].disabled)return a;return 0}const me=(e,n,a)=>n!==void 0&&!!e.find(c=>c[a.value]===n);function ne(e,n,a){const c=e.findIndex(d=>d[a.value]===n),l=K(e,c);return e[l]}function Ke(e,n,a){const c=[];let l={[n.children]:e},d=0;for(;l&&l[n.children];){const v=l[n.children],h=a.value[d];if(l=Ve(h)?ne(v,h,n):void 0,!l&&v.length){const s=xe(v)[n.value];l=ne(v,s,n)}d++,c.push(v)}return c}function fe(e){const{transform:n}=window.getComputedStyle(e),a=n.slice(7,n.length-1).split(", ")[5];return Number(a)}function Le(e){return Object.assign({text:"text",value:"value",children:"children"},e)}const Ge={value:W,fields:A(Object),options:L([]),readonly:Boolean,allowHtml:Boolean,optionHeight:A(Number),swipeDuration:A(W),visibleOptionNum:A(W)},ae={title:String,cancelButtonText:String,confirmButtonText:String},qe=["cancel","confirm","title","toolbar"],We=Object.keys(ae),oe=Object.assign({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:q("0.7rem"),showToolbar:J,swipeDuration:q(1e3),visibleOptionNum:q(6)},ae),ze=Object.assign({},oe,{columns:L([]),modelValue:L([]),toolbarPosition:F("top"),columnsFieldNames:Object}),de=200,z=300,Qe=15;let Q;const[Me,X]=Y("picker-column"),Pe=Symbol(Me),Xe=N({name:Me,props:Ge,emits:["change","clickOption","scrollInto"],setup(e,{emit:n,slots:a}){let c,l,d,v,h;const s=x(),b=x(),f=x(0),u=x(0),M=Be(),O=()=>e.options.length,I=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,k=t=>{let o=K(e.options,t);const r=-o*e.optionHeight,g=()=>{o>O()-1&&(o=K(e.options,t));const E=e.options[o][e.fields.value];E!==e.value&&n("change",E)};c&&r!==f.value?h=g:g(),f.value=r},T=()=>e.readonly||!e.options.length,_=t=>{c||T()||(h=null,u.value=de,k(t),n("clickOption",e.options[t]))},P=t=>j(Math.round(-t/e.optionHeight),0,O()-1),S=C(()=>P(f.value)),i=(t,o)=>{const r=Math.abs(t/o);t=f.value+r/.003*(t<0?-1:1);const g=P(t);u.value=+e.swipeDuration,k(g)},y=()=>{c=!1,u.value=0,h&&(h(),h=null)},D=t=>{if(!T()){if(M.start(t),c){const o=fe(b.value);f.value=Math.min(0,o-I())}u.value=0,l=f.value,d=Date.now(),v=l,h=null}},w=t=>{if(T())return;M.move(t),M.isVertical()&&(c=!0,ee(t,!0));const o=j(l+M.deltaY.value,-(O()*e.optionHeight),e.optionHeight),r=P(o);r!==S.value&&n("scrollInto",e.options[r]),f.value=o;const g=Date.now();g-d>z&&(d=g,v=o)},p=()=>{if(T())return;const t=f.value-v,o=Date.now()-d;if(o<z&&Math.abs(t)>Qe){i(t,o);return}const g=P(f.value);u.value=de,k(g),setTimeout(()=>{c=!1},0)},V=t=>{if(T())return;ee(t,!0);const o=fe(b.value);l=Math.min(0,o-I()),v=l,h=null;const{deltaY:r}=t;if(l===0&&r<0)return;const g=e.optionHeight*(r>0?-1:1);f.value=j(l+g,-(O()*e.optionHeight),e.optionHeight),Q&&clearTimeout(Q),Q=setTimeout(()=>{p(),d=0},z)},le=()=>{const t={height:"".concat(e.optionHeight,"px")},o=e.options.findIndex(r=>r.value===e.value);return e.options.map((r,g)=>{const E=r[e.fields.text],{disabled:ce}=r,He=r[e.fields.value],Ie={role:"button",style:t,tabindex:ce?-1:0,class:[X("item",{disabled:ce,prev2:Number(o-2)===g,prev:Number(o-1)===g,selected:He===e.value}),r.className],onClick:()=>_(g)},Se={[e.allowHtml?"innerHTML":"textContent"]:E};return m("li",Ie,[a.option?a.option(r,g):m("div",Se,null)])})};return ye(Pe),G({stopMomentum:y}),Fe(()=>{const t=c?Math.floor(-f.value/e.optionHeight):e.options.findIndex(g=>g[e.fields.value]===e.value),o=K(e.options,t),r=-o*e.optionHeight;c&&o<t&&y(),f.value=r}),Te("touchmove",w,{target:s}),()=>m("div",{ref:s,class:X(),onTouchstartPassive:D,onTouchend:p,onTouchcancel:p,onWheel:V},[m("ul",{ref:b,style:{transform:"translate3d(0, ".concat(f.value+I(),"px, 0)"),transitionDuration:"".concat(u.value,"ms"),transitionProperty:u.value?"all":"none"},class:X("wrapper"),onTransitionend:y},[le()])])}}),[Ze,U]=Y("picker-toolbar"),Je=N({name:Ze,props:ae,emits:["confirm","cancel"],setup(e,{emit:n,slots:a}){const{t:c}=Oe(),l=()=>{if(a.title)return a.title();if(e.title)return m("div",{class:[U("title")]},[e.title])},d=()=>n("cancel"),v=()=>n("confirm"),h=()=>{var f;const b=(f=e.cancelButtonText)!=null?f:c("lobby.common.tips.cancel");if(!(!a.cancel&&!b))return m("button",{type:"button",class:[U("cancel")],onClick:d},[a.cancel?a.cancel():b])},s=()=>{var f;const b=(f=e.confirmButtonText)!=null?f:c("lobby.common.tips.confirm");if(!(!a.confirm&&!b))return m("button",{type:"button",class:[U("confirm")],onClick:v},[a.confirm?a.confirm():b])};return()=>m("div",{class:U()},[a.toolbar?a.toolbar():[h(),l(),s()]])}}),et={titles:{type:Array,default:()=>["开始日期","结束日期"]},showToolTitle:J,toolTitleHeight:F("0.69rem"),toolBarHeight:F("1rem"),showToolbar:J,cancelButtonText:F("取消"),confirmButtonText:F("确认")},[tt,ve]=Y("picker-group"),he=N({name:tt,props:{buttons:{type:Array,default:()=>["取消","确认"]}},emits:["confirm","cancel","update:activeTab"],setup(e,{slots:n}){return()=>m("ul",{class:ve("buttons")},[e.buttons.map((a,c)=>m("li",null,[m("div",{class:ve("buttons-item",{left:c===0,right:c===1})},[c===0?n.left&&n.left():n.right&&n.right()])]))])}});function ge(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ae(e)}const[we,H]=Y("picker-group"),Ee=Symbol(we),yt=N({name:we,props:et,emits:["confirm","cancel"],setup(e,{emit:n,slots:a}){const{children:c,linkChildren:l}=ke(Ee),{t:d}=Oe();l();const v=()=>{n("confirm",c.map(s=>s.modelValue))},h=()=>n("cancel");return G({confirm:v,cancel:h}),()=>{var b,f;let s=(f=(b=a.default)==null?void 0:b.call(a))==null?void 0:f.filter(u=>u.type!==je).map(u=>u.type===Re?u.children:u);return s&&(s=Ye(s)),m("div",{class:H()},[e.showToolTitle?m(he,{buttons:e.titles,style:{height:ie(e.toolTitleHeight)}},{left:()=>m("span",{class:H("picker-title")},[d("lobby.promote.startTime")]),right:()=>m("span",{class:H("picker-title")},[d("lobby.promote.endTime")])}):null,m("div",{class:H("picker-content")},[m("div",{class:H("picker-content-item")},[s==null?void 0:s[0]]),m("div",{class:H("picker-content-item-line")},null),m("div",{class:H("picker-content-item")},[s==null?void 0:s[1]])]),e.showToolbar?m(he,{onConfirm:v,onCancel:h,style:{height:ie(e.toolBarHeight)}},{left:()=>{let u;return m(re,{class:H("cancel"),onClick:h,plain:!0,clearBackground:!0},ge(u=d("lobby.promote.cancel"))?u:{default:()=>[u]})},right:()=>{let u;return m(re,{onClick:v},ge(u=d("lobby.promote.confirm"))?u:{default:()=>[u]})}}):null])}}}),[nt,$]=Y("picker"),at=N({name:nt,props:ze,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:n,slots:a}){const c=x(),l=x(e.modelValue.slice(0)),{parent:d}=ye(Ee),{children:v,linkChildren:h}=ke(Pe);h();const s=C(()=>Le(e.columnsFieldNames)),b=C(()=>Ne(e.optionHeight)),f=C(()=>Ue(e.columns,s.value)),u=C(()=>{const{columns:t}=e;switch(f.value){case"multiple":return t;case"cascade":return Ke(t,s.value,l);default:return[t]}}),M=C(()=>u.value.some(t=>t.length)),O=C(()=>u.value.map((t,o)=>ne(t,l.value[o],s.value))),I=C(()=>u.value.map((t,o)=>t.findIndex(r=>r[s.value.value]===l.value[o]))),k=(t,o)=>{if(l.value[t]!==o){const r=l.value.slice(0);r[t]=o,l.value=r}},T=()=>({selectedValues:l.value.slice(0),selectedOptions:O.value,selectedIndexes:I.value}),_=(t,o)=>{k(o,t),f.value==="cascade"&&l.value.forEach((r,g)=>{const E=u.value[g];me(E,r,s.value)||k(g,E.length?E[0][s.value.value]:void 0)}),ue(()=>{n("change",Object.assign({columnIndex:o},T()))})},P=(t,o)=>{const r={columnIndex:o,currentOption:t};n("clickOption",Object.assign(T(),r)),n("scrollInto",r)},S=()=>{v.forEach(o=>o.stopMomentum());const t=T();return ue(()=>{n("confirm",t)}),t},i=()=>n("cancel",T()),y=()=>u.value.map((t,o)=>m(Xe,{value:l.value[o],fields:s.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:b.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:r=>_(r,o),onClickOption:r=>P(r,o),onScrollInto:r=>{n("scrollInto",{currentOption:r,columnIndex:o})}},{option:a.option})),D=t=>{if(M.value){const o={height:"".concat(b.value,"px")},r={backgroundSize:"100% ".concat((t-b.value)/2,"px")};return[m("div",{class:$("mask"),style:r},null),m("div",{class:[$e,$("frame")],style:o},null)]}},w=()=>{const t=b.value*+e.visibleOptionNum,o={height:"".concat(t,"px")};return m("div",{ref:c,class:$("columns"),style:o},[y(),D(t)])},p=()=>{if(e.showToolbar&&!d)return m(Je,Ce(te(e,We),{onConfirm:S,onCancel:i}),te(a,qe))};R(u,t=>{t.forEach((o,r)=>{o.length&&!me(o,l.value[r],s.value)&&k(r,xe(o)[s.value.value])})},{immediate:!0});let V;return R(()=>e.modelValue,t=>{!B(t,l.value)&&!B(t,V)&&(l.value=t.slice(0),V=t.slice(0))},{deep:!0}),R(l,t=>{B(t,e.modelValue)||(V=t.slice(0),n("update:modelValue",V))},{immediate:!0}),Te("touchmove",ee,{target:c}),G({confirm:S,getSelectedOptions:()=>O.value}),()=>{var t,o;return m("div",{class:$()},[e.toolbarPosition==="top"?p():null,e.loading?m(_e,{class:$("loading")},null):null,(t=a["columns-top"])==null?void 0:t.call(a),w(),(o=a["columns-bottom"])==null?void 0:o.call(a),e.toolbarPosition==="bottom"?p():null])}}}),ot=De(at),lt=Object.assign({},oe,{modelValue:L([]),filter:Function,formatter:{type:Function,default:(e,n)=>n}}),ct=Object.keys(oe);function it(e,n){if(e<0)return[];const a=Array(e);let c=-1;for(;++c<e;)a[c]=n(c);return a}const rt=(e,n)=>32-new Date(e,n-1,32).getDate(),Z=(e,n,a,c,l,d)=>{const v=it(n-e+1,h=>{const s=pe(e+h);return c(a,{text:s,value:s})});return l?l(a,v,d):v},st=(e,n)=>e.map((a,c)=>{const l=n[c];if(l.length){const d=+l[0].value,v=+l[l.length-1].value;return pe(j(+a,d,v))}return a}),be=new Date().getFullYear(),ut=Object.assign({},lt,{columnsType:{type:Array,default:()=>["year","month","day"]},minDate:{type:Date,default:()=>new Date(be-10,0,1),validator:se},maxDate:{type:Date,default:()=>new Date(be+10,11,31),validator:se}}),[mt]=Y("date-picker"),ft=N({name:mt,props:ut,emits:["confirm","cancel","change","update:modelValue"],setup(e,{emit:n,slots:a}){const c=x(e.modelValue),l=x(!1),d=x(),v=()=>{const i=e.minDate.getFullYear(),y=e.maxDate.getFullYear();return Z(i,y,"year",e.formatter,e.filter)},h=i=>i===e.minDate.getFullYear(),s=i=>i===e.maxDate.getFullYear(),b=i=>i===e.minDate.getMonth()+1,f=i=>i===e.maxDate.getMonth()+1,u=i=>{const{minDate:y,columnsType:D}=e,w=D.indexOf(i),p=l.value?e.modelValue[w]:c.value[w];if(p)return+p;switch(i){case"year":return y.getFullYear();case"month":return y.getMonth()+1;case"day":return y.getDate()}},M=()=>{const i=u("year"),y=h(i)?e.minDate.getMonth()+1:1,D=s(i)?e.maxDate.getMonth()+1:12;return Z(y,D,"month",e.formatter,e.filter)},O=()=>{const i=u("year"),y=u("month"),D=h(i)&&b(y)?e.minDate.getDate():1,w=s(i)&&f(y)?e.maxDate.getDate():rt(i,y);return Z(D,w,"day",e.formatter,e.filter)},I=()=>{var i;return(i=d.value)==null?void 0:i.confirm()},k=()=>c.value,T=C(()=>e.columnsType.map(i=>{switch(i){case"year":return v();case"month":return M();case"day":return O();default:return[]}}));R(c,i=>{B(i,e.modelValue)||n("update:modelValue",i)}),R(()=>e.modelValue,(i,y)=>{l.value=B(y,c.value),i=st(i,T.value),B(i,c.value)||(c.value=i),l.value=!1},{immediate:!0});const _=(...i)=>n("change",...i),P=(...i)=>n("cancel",...i),S=(...i)=>n("confirm",...i);return G({confirm:I,getSelectedDate:k}),()=>m(ot,Ce({ref:d,modelValue:c.value,"onUpdate:modelValue":i=>c.value=i,columns:T.value,onChange:_,onCancel:P,onConfirm:S},te(e,ct)),a)}}),Tt=De(ft);export{Tt as D,ot as P,yt as _,st as f,Z as g,ct as p,lt as s};
//# sourceMappingURL=index.CnQRgKzx.js.map
