import{a as $,bI as O,bJ as M,bq as ee,ac as qe,t as Ie,I as G,q as E,bK as Ue,bL as ue,bM as Re,bN as ne,bO as Ce,al as Ae,w as de,bP as te,bQ as Fe,bR as We,bS as Q,bT as ze,aB as U,bU as Ke,u as fe,bV as Z,E as f,n as ae,bW as Te,o as re,az as N,bX as le,bY as Ye,bZ as Ve,aE as Se,b_ as Le,b$ as He,bs as De,c0 as oe,aa as Je,c1 as Ze,b as Ee,m as Xe,D as Qe,c2 as Pe,Y as Me,c3 as L,af as et,c4 as tt,c5 as at,c6 as st,c7 as nt,c8 as he,c9 as ot,by as rt,a9 as it,a6 as Ne,bg as lt,a8 as ct,ca as K,bw as ie,p as ut,v as dt}from"./main.C8q1iJMV.js";import{T as vt,u as mt,s as Oe}from"../vendors/vendor-stable.LD58Pbb3.js";import{e as je,d as pt}from"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import{R as Be,E as ce}from"./ReceiveCountdownIndex.C4K-6t0P.js";import{l as P,r as H,f as T,p as e,t as F,w as q,v as V,E as ke,A as we,F as yt,C as bt,o as gt}from"../vendors/vendor-@vue.DNlpgob2.js";import{R as _t,D as ft,s as Tt,a as ht,j as kt,g as wt}from"./RuleInfoIndex.CqqOUmD5.js";import{t as b,E as k}from"./const.kNgtypBJ.js";import{L as xt}from"./index.JiQV5KHQ.js";import{u as It}from"./useBtnText.OX_7rlgO.js";import{K as Rt,m as Ct}from"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"./LazyLoader.cfovhYZu.js";const At="_item_1jilj_17",St="_image_1jilj_20",Lt="_handle_1jilj_30",Dt="_circle_1jilj_33",Et="_progressIndex_1jilj_42",Pt="_innerImage1_1jilj_48",Mt="_innerImage2_1jilj_49",Nt="_value_1jilj_56",Ot="_invalid_1jilj_71",jt="_activityBoxTip_1jilj_75",Bt="_myPopover_1jilj_85",Gt="_arrow_1jilj_85",I={item:At,image:St,handle:Lt,circle:Dt,progressIndex:Et,innerImage1:Pt,innerImage2:Mt,value:Nt,invalid:Ot,activityBoxTip:jt,myPopover:Bt,arrow:Gt},[$t]=E("pages-task-active-level-item"),qt=P({name:$t,props:{isLast:{type:Boolean,default:!1},isFirst:{type:Boolean,default:!1},activeLevelIndex:{type:Number,default:0},activeLevelItem:{type:Object,default:null}},setup(a){const{t:o}=$(),s=H(!1),c=O(),i=T(()=>{const{awardMinGold:t,awardMaxGold:u,status:g,audit:w,gold:C}=a.activeLevelItem,W=g===M.alreadyReceived,J=t===u?"<span>".concat(ee(t),"</span>"):"<span>".concat(ee(t),"</span>-<span>").concat(ee(u),"</span>");return W?o("lobby.modal.task.activityBoxReceiveTip",{x:w,reward:"<span>".concat(ee(C),"</span>")}):o("lobby.modal.task.activityBoxTip",{x:w,reward:J})}),d=T(()=>a.activeLevelItem.status===M.canReceive),m=T(()=>a.activeLevelItem.status===M.alreadyReceived),y=async t=>{if(!d.value||s.value)return;t.stopPropagation(),s.value=!0;const[u,g]=await je(Ue(a.activeLevelItem.id));if(u){await ue.checkRes({config:{err:u},checkOptions:{[Re.userRestrict]:!0}}),s.value=!1,c.freshTaskActiveLevel(),ne().updatePrize();return}Ce(g.gold),Ae.Receive(),de.success({message:()=>o("lobby.modal.task.receiveSussessTip")}),c.freshTaskActiveLevel(),ne().updatePrize(),s.value=!1},n=T(()=>"".concat("/lobby_asset/common/common/task/","img_rwbx_").concat(a.activeLevelIndex+1,"c.png")),r=T(()=>"".concat("/lobby_asset/common/common/task/","img_rwbx_").concat(a.activeLevelIndex+1,".png")),p=T(()=>{const{status:t}=a.activeLevelItem,u="/lobby_asset/common/common/task/";return t===M.canReceive?n.value:t===M.alreadyReceived?r.value:"".concat(u,"img_rwbx_0.png")}),l=()=>e("div",{class:{[I.image]:!0,[I.handle]:a.activeLevelItem.status===M.canReceive},onClick:y},[e(G,{src:p.value,class:I.innerImage1},null),!m.value&&e(G,{src:n.value,lazy:!1,class:I.innerImage2},null),d.value&&e(G,{src:r.value,lazy:!1,class:I.innerImage2},null),d.value&&e("span",{class:I.circle},null),e("span",{class:I.progressIndex},[a.activeLevelIndex+1])]);return()=>e("div",{class:I.item},[a.activeLevelItem.status===M.canReceive?l():e(qe,{overlayClass:I.myPopover,placement:a.isLast?"top-end":a.isFirst?"top-start":"top",destroyOnClose:!0,trigger:"click"},{default:()=>[e(Ie,{class:I.activityBoxTip,html:i.value},null)],reference:()=>l(),arrow:()=>e("div",{class:I.arrow},null)}),e("div",{class:{[I.value]:!0,[I.invalid]:a.activeLevelItem.status===M.canNotReceive}},[e(G,{class:I.icon,src:"/lobby_asset/common/web/common/comm_icon_shy.svg"},null),a.activeLevelItem.activity])])}}),se={"process-line-wrapper":"_process-line-wrapper_1394n_17","process-line":"_process-line_1394n_17","process-line-active":"_process-line-active_1394n_35"},[Ut]=E("pages-task-process-line"),Ft=P({name:Ut,setup(){const a=O(),{activeLevelConfig:o,activeLevelList:s}=F(a),c=T(()=>{const i=()=>{const r=s.value.findIndex(p=>p.status===M.canNotReceive);return r===-1?s.value.length:r},d=r=>{var w,C;const p=((w=o==null?void 0:o.value)==null?void 0:w.userActivity)||0,l=((C=s.value[r])==null?void 0:C.activity)||0,t=l===0?0:p-l,u=.03,g=1.05;return t>g?g:t>0?t<u?u:t:0},m=i(),y=s.value.length||1,n=d(m);return{currentProgress:m,totalProgress:y,currentWidth:n}});return()=>{const{currentProgress:i,totalProgress:d}=c.value,m=Array.from({length:d-1||0});return e("div",{class:se["process-line-wrapper"]},[m.map((y,n)=>e("div",{class:{[se["process-line"]]:!0,[se["process-line-active"]]:n+1<=i}},[e(G,{class:se.icon,src:"/lobby_asset/common/web/task/img_dqhydjt.svg"},null)]))])}}}),Wt="_caption_2oimp_29",zt="_value_2oimp_49",Kt="_icon_2oimp_54",Yt="_text_2oimp_58",Vt="_placeholder_2oimp_73",Ht="_resetTimeContent_2oimp_120",Jt="_resetTime_2oimp_120",Zt="_resetText_2oimp_137",R={"active-level-box":"_active-level-box_2oimp_17","active-level":"_active-level_2oimp_17",caption:Wt,value:zt,icon:Kt,text:Yt,"active-list":"_active-list_2oimp_62",placeholder:Vt,"activity-current-icon":"_activity-current-icon_2oimp_98",resetTimeContent:Ht,resetTime:Jt,resetText:Zt},[Xt]=E("pages-task-active-level"),Qt=P({name:Xt,setup(){const{t:a}=$(),o=O(),{activeLevelList:s,activeLevelConfig:c}=F(o),i=H(-1/0),d=()=>{o.freshTaskActiveLevel()};return q(()=>{var m;return(m=c.value)==null?void 0:m.loopEndTime},m=>{i.value=m||0},{immediate:!0}),()=>{var m,y,n;return((m=c.value)==null?void 0:m.status)===1?e("div",null,null):e("div",{class:R["active-level-box"]},[e("div",{class:[R["active-level"]]},[e("div",{class:R.caption},[e("span",{class:R.captionItem},[a("lobby.modal.task.activityRate")]),e("span",{class:[R.value,R.captionItem]},[e(G,{class:R.icon,src:"/lobby_asset/common/web/common/comm_icon_shy.svg"},null),e("span",{class:R.text},[(y=c.value)==null?void 0:y.userActivity])]),i.value>0?e("span",{class:[R.resetTimeContent,R.captionItem]},[e("span",{class:R.resetTime},[V("("),e(vt,{keypath:"lobby.event.cutOnce.resetcountdown",tag:"text",scope:"global"},{time:()=>e(Be,{onComplete:d,className:R.resetText,textFormatType:ce.None,duration:i.value},null)}),V(")")])]):""]),e("div",null,[e(Ft,null,null),e("div",{class:R["active-list"]},[(n=s.value)==null?void 0:n.map((r,p)=>{const l=p===s.value.length-1;return e(qt,{key:"".concat(r.id,"_").concat(p),activeLevelIndex:p,activeLevelItem:r,isLast:l,isFirst:p===0},null)})])])])])}}}),ea=()=>{const{t:a}=$(),o=H(!1),s=H(null),c=O(),i={[te.Tomorrow]:()=>a("lobby.modal.task.timeNotArrived.tomorrow"),[te.WeekWhole]:()=>a("lobby.modal.task.timeNotArrived.weekWhole"),[te.MonthWhole]:()=>a("lobby.modal.task.timeNotArrived.monthWhole")},d=r=>{const{receiveTimeType:p,receiveDuration:l,canReceiveTime:t,status:u,logCategory:g,prize:w}=r;return u===Fe.PendingCheck&&g===We.Max&&w?!1:t-Math.floor(Date.now()/1e3)-1>0?!0:!(l<=0||p===te.Immediately)},m=r=>![Q.PendingApprove].includes(r),y=async r=>{s.value=r;const{taskId:p,template:l}=O().curCategory;o.value=!0;const[t]=await je(ze({taskid:p,template:l,ruleid:r.ruleid,receiveLogId:r.receiveLogId}));if(o.value=!1,t){await ue.checkRes({config:{err:t},checkOptions:{[Re.userRestrict]:!0}})||(c.freshTaskActiveLevel(),U().freshDiscountRedDot(),ne().updatePrize(),c.freshActiveTabTasks());return}n(r)},n=r=>{c.freshTaskActiveLevel(),c.freshActiveTabTasks(),de.success(a("lobby.modal.task.receiveSussessTip")),Ce(r.prize),Ae.Receive(),ne().updatePrize(),U().freshDiscountRedDot()};return{isReceiveLoading:o,currTaskRule:s,reminderTextMapper:i,judgeIsAllowByTime:d,judgeIsAllowByRuleStatus:m,requestOneReceiveReward:y}},ta=()=>{const{t:a}=$(),o=Ke(),s=fe(),c=Ee(),i=(t,u)=>{if(!N().hasLogined){Z().openLoginRegister();return}c.push({name:t,query:u?{active:u}:{}})},d=t=>{if(!N().hasLogined){Z().openLoginRegister();return}c.push({name:t,query:{jumpFrom:f.TASK}})},m=t=>{let u=!1;try{const g=JSON.parse(t.cfg),w=(g==null?void 0:g.bindTypes)||[];w.length===1&&w.includes(1)&&(u=!0)}catch(g){}u?i(f.SECURITY):d(f.SETTING)},y=()=>{if(N().isDemoMode)return le({message:a("lobby.error.demoAccountTips")});if(!U().isShowInterest)return le({message:a("lobby.interest.notOpen")});i(f.INTEREST)},n=()=>{var u;o.validateConfigStatus()[Ye.PHONE]?s.open("verifyBindPhone",{verifyScene:Ve.DEPOSIT_GAME_SMS_VERIFY,desensitizedPhoneNumber:(u=N().userInfos)==null?void 0:u.mobile_phone,onSuccess:()=>{de.success(a("lobby.center.security.phone.bind.success")),Se.setCacheExpired([Le]),O().freshActiveTabTasks(),U().freshDiscountRedDot()}}):He()},r=t=>{if(!N().hasLogined){Z().openLoginRegister();return}let u=!1;try{u=JSON.parse(t.cfg).requireFirstPay}catch(w){}const g=De();if((g===oe.ANDROID_APP||g===oe.IOS_APP)&&u){Je.showDialog({title:()=>a("lobby.receiveModal.kindTips"),confirmButtonText:()=>a("lobby.modal.task.forward"),message:()=>a("lobby.modal.task.rechargeAtLeastOnce"),onConfirm:()=>{s.open("recharge")},showCloseButton:!0});return}Ze()},p=()=>{if(!N().hasLogined){Z().openLoginRegister();return}fe().open("downloadShortcutGuide")};return{forwardActions:T(()=>({[b.toRegister]:()=>{Z().openLoginRegister({register:!0})},[b.bindPhone]:()=>i(f.SECURITY,"0"),[b.bandEmail]:()=>i(f.SECURITY,"2"),[b.bindBankCard]:()=>ae(Te.ACCOUNT_MANAGEMENT),[b.bindWx]:()=>d(f.SETTING),[b.setBirthday]:()=>d(f.SETTING),[b.setNickname]:()=>d(f.SETTING),[b.bindWhatsApp]:()=>d(f.SETTING),[b.bindFacebook]:()=>d(f.SETTING),[b.bindTelegram]:()=>d(f.SETTING),[b.bindZalo]:()=>d(f.SETTING),[b.bindLine]:()=>d(f.SETTING),[b.bindTwitter]:()=>d(f.SETTING),[b.bindWithdraw]:()=>ae(),[b.firstWithdraw]:()=>ae(),[b.setWithdrawalPwd]:()=>i(f.SECURITY,"5"),[b.setEncrypted]:()=>i(f.SECURITY,"6"),[b.setHead]:()=>d(f.UPDATE_AVATOR),[b.setBgMusic]:()=>d(f.SETTING),[b.continueBetDay]:()=>i(f.GAME),[b.singleBetDay]:()=>i(f.GAME),[b.goGame2]:()=>i(f.GAME),[b.goGame3]:()=>i(f.GAME),[b.goGame4]:()=>i(f.GAME),[b.goGame5]:()=>i(f.GAME),[b.goGame6]:()=>i(f.GAME),[b.goGame7]:()=>i(f.GAME),[b.bindGoogle]:()=>i(f.SECURITY,"3"),[b.bindCrypto]:()=>ae(Te.ACCOUNT_MANAGEMENT),[b.reChargeDay]:()=>re(),[b.reChargeWeek]:()=>re(),[b.firstDeposit]:()=>re(),[b.firstYeb]:()=>y(),[b.smsVerification]:()=>n(),[b.addContact]:t=>m(t),[b.downloadAndLogin]:t=>r(t),[b.saveUrl]:()=>p()}))}},aa={"category-intro":"_category-intro_j8z8q_17"},[sa]=E("pages-task-category-introduce");var Ge=function(a){return a[a.firstIndex=0]="firstIndex",a[a.secondIndex=1]="secondIndex",a[a.thirdIndex=2]="thirdIndex",a[a.fourIndex=3]="fourIndex",a}(Ge||{});const na=P({name:sa,props:{taskTabData:{type:Object,default:()=>{}}},setup(a){const{t:o}=$(),{taskTabData:s}=F(a),c=T(()=>{const{language:n}=Xe(),{isDefaultRule:r,translateRuleText:p}=s.value||{};return r?n:p}),i=n=>{var t;const{siteInfos:r}=Qe(),l=pt().utcOffset((t=r==null?void 0:r.timeZone)!=null?t:"").utcOffset()/60;return e("div",null,[e("p",{class:"text-darken"},[n,o("lobby.modal.task.describe.time",c.value),V(" (UTC"),l>=0&&"+",l,V("):")]),e("p",null,[s.value.taskTime])])},d=n=>e("div",null,[e("p",{class:"text-darken"},[n,o("lobby.modal.task.describe.condition",c.value),V(":")]),e("p",null,[s.value.taskCondition])]),m=n=>e("div",null,[e("p",{class:"text-darken"},[n,o("lobby.modal.task.describe.content",c.value),V(":")]),e(Ie,{tag:"p",html:s.value.content},null)]),y=T(()=>{const n=[];return s.value.taskTime&&n.push(i),s.value.taskCondition&&n.push(d),s.value.content&&n.push(m),n});return()=>{var n;return e("section",{class:aa["category-intro"]},[(n=y.value)==null?void 0:n.map((r,p)=>r(o("lobby.event.".concat(Ge[p]),c.value)))])}}}),oa="_success_8b51n_31",ra="_processing_8b51n_35",ia="_forward_8b51n_39",la="_disabled_8b51n_43",x={"my-button":"_my-button_8b51n_17",success:oa,processing:ra,forward:ia,disabled:la},[ca]=E("pages-task-rule-button"),ua={[k.Discount]:x.success,[k.PendingReceive]:x.success,[k.Processing]:x.processing,[k.Goto]:x.forward,[k.HasSend]:x.disabled,[k.UnOpen]:x.disabled,[k.Expired]:x.disabled,[k.ServerCancel]:x.disabled,[k.Finish]:x.disabled,[k.PendingApprove]:x.success,[k.PendingApply]:x.disabled,[k.ServerReject]:x.disabled,[k.ReceiveAll]:x.success,[k.WaitingGet]:x.forward,[k.GrayPendingReceive]:x.disabled},da=P({name:ca,props:{btnKey:{type:Number,default:0},isLoading:{type:Boolean,default:!1},btnStatus:{type:Boolean,default:!1}},emits:["clickRule"],setup(a,{slots:o,emit:s}){const{isLoading:c,btnKey:i,btnStatus:d}=F(a),{textMapper:m}=It(),y=T(()=>![k.Goto,k.PendingReceive,k.PendingApprove,k.ReceiveAll,k.Discount,k.Processing].includes(i.value)),n=T(()=>ua[i.value]),r=t=>{if(y.value){t.stopPropagation();return}s("clickRule")},p=T(()=>{var t,u;return(u=(t=m.value)[i.value])==null?void 0:u.call(t)}),l=T(()=>{const t=p.value;return typeof t=="string"?Pe(t):t});return()=>e(Me,{onClick:r,class:{[x["my-button"]]:!0,[n.value]:!0},disabled:y.value||d.value,loading:c.value},{default:()=>{var t;return[e("span",null,[l.value]),(t=o==null?void 0:o.default)==null?void 0:t.call(o)]}})}}),va="_countdownText_p7cv1_48",Y={"card-right-box":"_card-right-box_p7cv1_17","card-right-box-inner":"_card-right-box-inner_p7cv1_24","box-body":"_box-body_p7cv1_31","box-count-down-wrapper":"_box-count-down-wrapper_p7cv1_35","box-foot":"_box-foot_p7cv1_39","box-footer":"_box-footer_p7cv1_42",countdownText:va},[ma]=E("pages-task-rule-right"),pa=P({name:ma,props:{taskRule:{type:Object,default:null}},setup(a){const{taskRule:o}=F(a),s=ke("handleClickRule"),c=ke("collectAction"),i=T(()=>{var l,t;return((l=o.value)==null?void 0:l.receiveDuration)>0||((t=o.value)==null?void 0:t.receiveDuration)<0}),d=T(()=>{var l;return((l=o.value)==null?void 0:l.receiveDuration)!=0?ce.suffixSecond:ce.None}),m=()=>{s==null||s(o.value)},y=T(()=>{var l,t,u,g;return((l=c==null?void 0:c.isReceiveLoading)==null?void 0:l.value)&&((u=(t=c==null?void 0:c.currTaskRule)==null?void 0:t.value)==null?void 0:u.ruleid)===((g=o.value)==null?void 0:g.ruleid)}),n=H(c==null?void 0:c.judgeIsAllowByTime(o.value)),r=l=>{if(!o.value||!i.value)return 0;const{canReceiveTime:t,periodTime:u,receiveDuration:g}=o.value,w=Math.floor(l/1e3),C=g>0?t-w-1:w-u;return Math.abs(g-C)>60?g:C},p=()=>{o.value.receiveDuration=0,n.value=!1};return()=>{var l;return e("div",{class:{[Y["card-right-box"]]:!0}},[e("div",{class:{[Y["card-right-box-inner"]]:!0}},[e("div",{class:Y["box-body"]},[e("div",{class:Y["box-body-right"]},[e(da,{btnKey:(l=o.value)==null?void 0:l.status,onClickRule:m,isLoading:y.value,btnStatus:n.value},{default:()=>i.value&&e("div",{class:Y["box-count-down-wrapper"]},[e(Be,{textFormatType:d.value,inheritTextColor:!0,duration:r(Date.now()),onComplete:p,className:Y.countdownText},null)])})])])])])}}}),S={"card-layout":"_card-layout_12otq_17","card-layout-mystery":"_card-layout-mystery_12otq_25","card-layout-mystery-fourth-task":"_card-layout-mystery-fourth-task_12otq_28","card-layout-inner":"_card-layout-inner_12otq_36","card-left":"_card-left_12otq_43","card-right":"_card-right_12otq_47","card-layout-mystery-inner":"_card-layout-mystery-inner_12otq_51","corner-day":"_corner-day_12otq_57","un-open":"_un-open_12otq_91","is-compact":"_is-compact_12otq_97","compact-division":"_compact-division_12otq_109"},[ya]=E("pages-task-list-item"),ba=P({name:ya,props:{template:{type:Number,default:1},taskRule:{type:Object,default:null},taskIndex:{type:Number,default:0},isCompleteMystery:{type:Boolean,default:!1}},setup(a){const{t:o}=$(),{taskRule:s,taskIndex:c,template:i,isCompleteMystery:d}=F(a),m=T(()=>c.value===3),y=T(()=>{var l;return((l=s.value)==null?void 0:l.status)===Q.UnOpen}),n=T(()=>y.value||i.value===L.taskMystery&&m.value&&!d.value),r=()=>{var l,t,u,g,w,C;return e("div",{class:{[S["card-layout-inner"]]:!0,[S["card-layout-mystery-inner"]]:i.value===L.taskMystery&&!m.value,"card-layout-inner":!0,"theme-box-shadow":!0}},[e("div",{class:{[S["card-left"]]:!0}},[e(_t,{template:i.value,ruleId:(l=s.value)==null?void 0:l.ruleid,ruleIcon:(t=s.value)==null?void 0:t.icon,nameExt:(u=s.value)==null?void 0:u.nameExt,amount:(g=s.value)==null?void 0:g.prize,activity:(w=s.value)==null?void 0:w.brisk,isShallowText:n.value,isHideBottom:n.value,btnKey:(C=s.value)==null?void 0:C.status},{desc:()=>{var W,z,J;return i.value===L.taskMystery&&m.value?e(ft,{minAmount:(W=s.value)==null?void 0:W.minThreeMysteriousAmount,maxAmount:(z=s.value)==null?void 0:z.maxThreeMysteriousAmount},null):(J=s.value)==null?void 0:J.name}})]),!n.value&&e("div",{class:{[S["card-right"]]:!0}},[e(pa,{taskRule:s.value},null)])])},p=()=>i.value!==L.taskMystery||m.value?null:e("div",{class:{[S["corner-day"]]:!0,[S["un-open"]]:y.value}},[e("span",null,[o("lobby.modal.task.dayCount",{X:c.value+1,x:c.value+1})])]);return()=>e(xt,{class:{[S["card-layout"]]:!0,[S["is-compact"]]:i.value===L.taskMystery,[S["card-layout-mystery"]]:i.value===L.taskMystery&&!m.value,[S["card-layout-mystery-fourth-task"]]:i.value===L.taskMystery&&m.value}},{default:()=>[e("div",{class:S["compact-division"]},null),p(),r()]})}}),X={"task-tab-wrapper":"_task-tab-wrapper_12orj_17","task-tab-item":"_task-tab-item_12orj_23","task-tab-name":"_task-tab-name_12orj_35","task-active-text-color":"_task-active-text-color_12orj_55"},[ga]=E("pages-task-tab-title"),_a=P({name:ga,props:{curTab:{type:Number,default:L.newBenefits},tabItem:{type:Object,default:null}},setup(a){const{curTab:o,tabItem:s}=F(a),c=T(()=>o.value===s.value.taskId),i=n=>{n=n!=null?n:c.value;const r=at.useMenuBg("normal"),{chooseBg:p}=st(),l=r.base||p.value,t=r.select||nt("common/btn_zc1_1.png","{layout}-{bg}-{skin}","web");return n?t:l},d=T(()=>i),m=T(()=>{var r;const n=(r=s.value)==null?void 0:r.taskName;return typeof n=="string"?Pe(n):n}),y=T(()=>{var p,l;const n=(p=U().discountRedDot)==null?void 0:p.taskRedDot,r=Rt(n,t=>{var u;return t.template===((u=s.value)==null?void 0:u.template)});return(l=r==null?void 0:r.unReceiveCount)!=null?l:0});return()=>e(et,{tag:"div",position:"top-right",content:y.value,class:X["task-tab-wrapper"]},{default:()=>[e(G,{tag:"div",class:X["task-tab-item"],src:d.value(c.value),replaceExtension:!1},{default:()=>[c.value&&e(tt,null,null),e("div",{class:{[X["task-tab-name"]]:!0,[X["task-tab-active"]]:o.value===s.value.taskId,[X["task-active-text-color"]]:c.value}},[m.value])]})]})}}),fa="_icon_lw1sk_54",Ta="_text_lw1sk_62",ha="_countdownDialog_lw1sk_105",D={"task-tabs":"_task-tabs_lw1sk_17","task-tabs-title":"_task-tabs-title_lw1sk_22","list-placeholder":"_list-placeholder_lw1sk_28","list-withdraw-box":"_list-withdraw-box_lw1sk_36","list-withdraw-tips":"_list-withdraw-tips_lw1sk_43",icon:fa,text:Ta,"task-list":"_task-list_lw1sk_66","task-withdraw-tip":"_task-withdraw-tip_lw1sk_71","task-extra-button":"_task-extra-button_lw1sk_74",countdownDialog:ha};function ka(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!bt(a)}const[wa]=E("pages-task-tabs"),xa=P({name:wa,setup(){const{t:a}=$(),o=O(),s=Ee(),c=mt(),{forwardActions:i}=ta(),d=H(),m=ea();we("collectAction",m);const{curTab:y,curCategory:n,taskCategories:r,taskTabData:p,taskTabDataMapper:l,isActiveTabTasksLoading:t,activeTabTasksError:u}=Oe(o);q(()=>c.query.curTask,v=>{var _,h;c.name===f.TASK&&(_=he)!=null&&_[Number(v)]&&o.updateCurTab((h=he)==null?void 0:h[Number(v)])},{immediate:!0}),q(y,v=>{var _;c.name===f.TASK&&s.replace({name:f.TASK,query:Ct({...c.query,curTask:(_=ot)==null?void 0:_[Number(v)]})})}),q(n,()=>o.getActiveTabTasks(n.value),{immediate:!0});const g=T(()=>{var h,A,j;const v=(j=(A=(h=l.value)==null?void 0:h[y.value])==null?void 0:A.rules)!=null?j:[],_=De();return _===oe.ANDROID_APP||_===oe.IOS_APP?v.filter(B=>Tt(B)&&ht(B)):v});q(p,(v,_)=>{var h,A;d.value&&JSON.stringify(v==null?void 0:v.rules)!==JSON.stringify(_==null?void 0:_.rules)&&rt((A=(h=d.value)==null?void 0:h.scroller)==null?void 0:A.value,{y:0})});const w=T(()=>{var v,_;return t.value?(v=l.value)!=null&&v[y.value]?"nested-loading":"loading":u.value?"retry":(_=g.value)!=null&&_.length?null:"empty"}),C=()=>{o.getActiveTabTasks(n.value)},W=v=>{if(N().isDemoMode)return le({message:a("lobby.error.demoAccountTips")});const _=i.value[wt(v)];_?_(v):console.error(v.ruleid)},z=async v=>{var h,A,j,B;m.isReceiveLoading.value||await ue.check({checkOptions:{[K.isDemoLogin]:!0,[K.task]:!0,[K.forbidReceive]:!0,[K.receiveType]:!0,[K.largeAmount]:!0,[K.pendingCheck]:!0},eventData:{receiveDeviceType:String((A=(h=p.value)==null?void 0:h.receiveDeviceType)!=null?A:""),taskCondition:(B=(j=p.value)==null?void 0:j.receiveCondition)!=null?B:"",receiveStatus:v.status,amount:v==null?void 0:v.prize,receiveCategory:v==null?void 0:v.logCategory}})||m.requestOneReceiveReward(v)};we("handleClickRule",v=>{var h;const _={[Q.Goto]:()=>W(v),[Q.PendingApprove]:()=>z(v),[Q.PendingReceive]:()=>z(v)};return(h=_[v.status])==null?void 0:h.call(_)});const ve=()=>{s.push({name:f.RECORDS})};q(()=>{var v;return(v=r.value)==null?void 0:v.length},v=>{v&&U().freshDiscountRedDot()});const $e=T(()=>y.value===L.taskMystery&&kt(g.value));return()=>{var v;return e(ct,{active:y.value,"onUpdate:active":_=>y.value=_,tabVShowMode:!1,contentScrollable:!0,contentScrollProps:{bindRoute:!0,onScroll:()=>{o.isPoverShow=!1},scrollbarTrigger:"none"},key:"taskTabs"+((v=r.value)==null?void 0:v.length),navPosition:"left",class:D["task-tabs"],titleNavClass:D["task-tabs-title"]},{default:()=>{var _;return[(_=r.value)==null?void 0:_.map(h=>{var B,me,pe,ye;const A=h.template,j=y.value===L.newBenefits&&A&&((me=(B=l.value)==null?void 0:B[A])==null?void 0:me.withdrawTip);return e(yt,null,[j&&e("div",{class:D["list-withdraw-box"]},[e("div",{class:D["list-withdraw-tips"]},[e(G,{class:D.icon,tag:"div",src:"/lobby_asset/common/web/common/comm_icon_tip2.png"},null),e("span",{class:D.text},[(ye=(pe=l.value)==null?void 0:pe[A])==null?void 0:ye.withdrawTip])])]),e(it,{name:h.taskId,key:h.taskId,title:()=>e(_a,{tabItem:h,curTab:y.value},null),content:()=>y.value!==h.taskId?null:e(Ne,{empty:{text:a("lobby.event.luckyWheel.tabs.noData")},type:w.value,class:[D["list-placeholder"]],onRetry:C},{default:()=>[e(lt,{ref:d,class:{[D["task-list"]]:!0,[D["task-withdraw-tip"]]:!j},finished:!0},{default:()=>{var be;return[(be=g==null?void 0:g.value)==null?void 0:be.map((ge,_e)=>e(ba,{key:"".concat(y.value,"_").concat(_e,"_").concat(ge.ruleid),taskRule:ge,taskIndex:_e,isCompleteMystery:$e.value,template:y.value},null)),e(na,{taskTabData:p.value},null)]}})]})},null)])})]},"nav-extra":()=>{var h;let _;return(h=r.value)!=null&&h.length?e("div",{class:D["task-extra-button"]},[e(Me,{size:"small",onClick:ve},ka(_=a("lobby.game.nav.receiveRecord"))?_:{default:()=>[_]})]):null}})}}}),xe={"task-placeholder":"_task-placeholder_at8br_17","task-container":"_task-container_at8br_21"},[Ia]=E("pages-task"),Ua=P({name:Ia,beforeRouteEnter(){const a=N(),o=O(),s=U();a.hasLogined&&o.isLoadedTaskCategories&&o.curTab===L.newBenefits&&(s.freshDiscountRedDot(),Se.setCacheExpired([Le]),o.freshActiveTabTasks())},setup(){const a=O(),o=N(),{isActiveLevelLoading:s,isTaskCategoriesLoading:c,activeLevelError:i,taskCategoriesError:d,taskCategories:m,isLoadedActiveLevel:y,isLoadedTaskCategories:n}=Oe(a),{t:r}=$(),p=T(()=>{var t;if(!y.value||!n.value){if(s.value||c.value)return"loading";if(i.value||d.value)return"retry"}return(t=m.value)!=null&&t.length?null:"empty"}),l=async()=>{await a.getTaskActiveLevel(),await a.getTaskCategories()};return q(()=>o.hasLogined,()=>{l()}),gt(()=>{ie.doReport({rule:ie.rules.CUSTOM_BURIED,eventName:ie.buriedEvents.EnterTask})}),ut(()=>{l()}),()=>e(dt,{useScroll:!1},{default:()=>[e(Ne,{class:[xe["task-placeholder"]],type:p.value,empty:{text:r("lobby.modal.notOpen")},onRetry:l},{default:()=>[e("div",{class:xe["task-container"]},[e(Qt,null,null),e(xa,null,null)])]})]})}});export{Ua as default};
//# sourceMappingURL=TaskIndex.z4m2pPmf.js.map
