import{E as v,c as D,d as F,e as h}from"./enum.CcXhH6KG.js";import{a as T,az as W,ci as j,cp as z,gG as Z,bg as J,bG as K,dM as Q,af as X,_ as w,I as tt,cs as et,q as N,E as R,w as at,bU as st,bY as P,b as k,s as nt,p as lt,a1 as ot,Y as it,B as rt,a8 as ct,a9 as ut,v as mt}from"./main.C8q1iJMV.js";import{u as E}from"./index.LCSohmSD.js";import{a as pt,u as O,s as dt,I as ft}from"../vendors/vendor-stable.LD58Pbb3.js";import{h as bt}from"../vendors/vendor-default.CjiYZF7Q.js";import{g as _t,a as B,s as U}from"./utils.IM8NOqLZ.js";import{R as gt}from"./Rating.DNfs8bTi.js";import{l as L,r as C,w as S,p as t,C as G,f as H,v as q,o as vt}from"../vendors/vendor-@vue.DNlpgob2.js";import{R as V}from"./RuleRichText.Cs829s5P.js";import{d as At}from"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";const yt="_order_1f1xm_17",Ct="_left_1f1xm_34",Rt="_name_1f1xm_41",It="_time_1f1xm_44",xt="_rating_1f1xm_48",St="_claimId_1f1xm_51",ht="_copy_1f1xm_54",Tt="_right_1f1xm_59",Nt="_amount_1f1xm_63",Et="_status_1f1xm_64",Lt="_rate_1f1xm_72",Mt="_realAmount_1f1xm_76",wt="_rightIcon_1f1xm_79",r={"order-list":"_order-list_1f1xm_17",order:yt,left:Ct,name:Rt,time:It,rating:xt,claimId:St,copy:ht,right:Tt,amount:Nt,status:Et,rate:Lt,realAmount:Mt,rightIcon:wt};function Ot(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!G(s)}const[Dt]=N("pages-order-list"),Pt=L({name:Dt,setup(){var A;const{t:s}=T(),e=E(),u=pt(),m=O(),{userInfos:p}=W(),d=j((A=p==null?void 0:p.currency)!=null?A:"CNY"),l=C({startTime:0,endTime:Date.now()}),{list:n,loading:b,listError:I,loadData:g,finished:o}=z(Z,{immediate:!0,payload:l,alias:{page:"page",pageSize:"size"},transformFn:c=>{var f,x;const a=c.data.data;return{data:(f=a==null?void 0:a.list)!=null?f:[],total:(x=a==null?void 0:a.total)!=null?x:0}}});S(()=>[e.tabsActive,m.query],()=>{e.tabsActive===v.CLAIM_ORDER&&(g(!0),e.getUnreadMsgCnt())},{deep:!0});const i=(c,a,f)=>{const x=bt(c).div(a),M=d==null?void 0:d.gameRate;M&&M!==1&&x.times(M);const Y="≈".concat(w(x.toString(),{code:f,toFixedType:"currency"}).toString()).concat(f);return parseFloat(c)&&parseFloat(a)?Y:""},_=c=>{u.push({name:R.CLAIM_ORDER_DETAIL,query:{id:c.claimId}})};return()=>{let c;return t(et,{class:r["order-list"]},{default:()=>[t(J,{loading:b.value,error:!!I.value,finished:o.value,onLoad:g},Ot(c=n.value.map(a=>t("div",{key:a.recordId,class:r.order,onClick:()=>_(a)},[t("div",{class:r.left},[t("p",{class:r.name},[_t(a.claimType)]),t("p",{class:r.time},[t("span",null,[K(a.createTime)]),!!a.score&&t(gt,{class:r.rating,modelValue:a.score,"onUpdate:modelValue":f=>a.score=f,readonly:!0},null)]),t("p",{class:r.claimId},[t("span",null,[s("lobby.center.claim.claimOrderList.claimID")]),t("span",null,[a.claimId]),t(Q,{class:r.copy,text:a.claimId},null)])]),t("div",{class:r.right},[t("div",null,[t("p",{class:r.amount},[t(X,{content:Number(a.unReadCount)>=99?"99+":a.unReadCount,offset:[0,-10]},{default:()=>{var f;return[(f=w(a.claimAmount).toFixed({decimalPlaces:2,tailZero:!0}).toString())!=null?f:"0.00"]}})]),a.withdrawRateStr&&t("p",{class:r.rate},[t("p",null,["".concat(s("lobby.finance.withdraw.rate")," ").concat(a.withdrawRateStr.replace(a.withdrawRate,w(a.withdrawRate,{code:a.claimCurrency,sign:!1,toFixedType:"rate"}).toString()))]),t("p",{class:r.realAmount},[i(a.claimAmount,a.withdrawRate,a.realCurrency)])]),t("p",{class:[r.status,...B(a.claimStatus).style]},[B(a.claimStatus).text])]),t(tt,{class:r.rightIcon,src:"/lobby_asset/common/web/common/comm_icon_fh.svg"},null)])])))?c:{default:()=>[c]})]})}}}),Bt=s=>{const{t:e}=T(),u=E(),m=k(),p=()=>{var c;if(!u.claimInfo)return;const{userStatus:o,totalDeposit:i,siteStatus:_}=u.claimInfo,{guaranteeRule:A}=dt(u);d()&&n(_,(c=A.value)==null?void 0:c.guaranteeType)&&b(o)&&I(i)&&g()&&m.push({name:R.APPLY_CLAIM})},d=()=>s.value?!0:(at.error({message:()=>e("lobby.center.claim.submitHint1")}),!1),l=o=>{nt({type:"error",className:"claim-dialog",title:e("lobby.modal.title.error"),message:o,showConfirmButton:!1,showCancelButton:!1,showCloseButton:!0})},n=(o,i)=>{if(o!==D.NORMAL){let _=e("lobby.center.claim.submitSite1");return o===D.CLAIMING&&i===F.COMPREHENSIVE_WARRANTY&&(_=e("lobby.center.claim.submitSite2")),l(_),!1}return!0},b=o=>{var i;if(o!==h.NORMAL){const A=(i={[h.CLAIMING]:e("lobby.center.claim.submitHint5"),[h.SUSPENDED]:e("lobby.center.claim.submitHint4"),[h.PERMANENTLY_BANNED]:e("lobby.center.claim.submitHint3")}[o])!=null?i:e("lobby.center.claim.submitHint3");return l(A),!1}return!0},I=o=>Number(o)?!0:(l(e("lobby.center.claim.submitHint2")),!1),g=()=>{const{validateConfigStatus:o}=st();return o()[P.WITHDRAWPASS]?!0:(m.push({name:R.SECURITY,query:{active:"".concat(P.WITHDRAWPASS)}}),!1)};return{application:p}},Ut="_preApplication_p8qvx_17",qt="_ruleContent_p8qvx_21",$t="_application_p8qvx_64",kt="_readAgreement_p8qvx_77",Gt="_claimRules_p8qvx_80",Ht="_btn_p8qvx_84",y={preApplication:Ut,ruleContent:qt,application:$t,readAgreement:kt,claimRules:Gt,btn:Ht},[Vt]=N("pages-pre-application"),Yt=L({name:Vt,setup(){const{t:s}=T(),e=E(),u=O(),m=C(!1),p=C(0),d=C(!1),l=C(),n=C([]),b=H(()=>p.value>0);lt(()=>{const i=[R.APPLY_CLAIM,R.CLAIM_ORDER_DETAIL],_=n.value[n.value.length-2];i.includes(_)||(p.value=60),n.value=[],g()});const I=()=>{l.value=setInterval(()=>{(p.value--<0||d.value)&&clearInterval(l.value)},1e3)},g=()=>{const i=e.tabsActive===v.CLAIM_APPLICATION;d.value=!i,i&&(I(),e.getClaimInfo(),e.getGuaranteeRule())};S(()=>e.tabsActive,()=>{g()}),S(()=>u.name,i=>{n.value.push(String(i))});const{application:o}=Bt(m);return()=>t("div",{class:y.preApplication},[t("div",{class:y.ruleContent},[t(V,null,null)]),t("div",{class:y.application},[t(ot,{class:y.readAgreement,modelValue:m.value,"onUpdate:modelValue":i=>m.value=i},{default:()=>[t(ft,{keypath:"lobby.center.claim.readAgreement",tag:"span",scope:"global"},{text:()=>t("span",{class:y.claimRules,onClick:()=>{m.value=!m.value,e.tabsActive=v.GUARANTEE_CLAIM_RULE}},[q("《"),s("lobby.center.claim.claimRules2"),q("》")])})]}),t(it,{class:y.btn,disabled:b.value,onClick:At(()=>{o()},500,{leading:!0,trailing:!1}),type:"primary"},{default:()=>[b.value?s("lobby.center.claim.readRulesBeforeApplying",{num:p.value}):s("lobby.center.claim.claimSubmission")]})])])}}),Ft="_ruleBox_1839l_17",Wt={ruleBox:Ft},[jt]=N("pages-rule"),zt=L({name:jt,setup(){return()=>t("div",{class:Wt.ruleBox},[t(V,null,null)])}});function $(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!G(s)}const[Zt]=N("pages-claim"),me=L({name:Zt,setup(){const{t:s}=T(),e=E(),u=O(),m=k(),p=[{label:()=>s("lobby.center.claim.claimApplication"),value:v.CLAIM_APPLICATION,component:t(Yt,null,null)},{label:()=>s("lobby.center.claim.claimOrder"),value:v.CLAIM_ORDER,component:t(Pt,null,null)},{label:()=>s("lobby.center.claim.guaranteeClaimRule"),value:v.GUARANTEE_CLAIM_RULE,component:t(zt,null,null)}],d=H(()=>{var l,n;return Number((n=(l=u.query)==null?void 0:l.active)!=null?n:e.tabsActive)});return vt(()=>{e.getGuaranteeRule(),e.getUnreadMsgCnt(),e.tabsActive=d.value}),S(()=>e.tabsActive,()=>{m.replace({query:{...u.query,active:e.tabsActive}})}),S(()=>u.query,()=>{u.name!==R.CLAIM||d.value===e.tabsActive||(e.tabsActive=d.value)},{immediate:!0}),()=>t(mt,null,{header:()=>{let l;return t(rt,null,$(l=s("lobby.center.claim.title"))?l:{default:()=>[l]})},default:()=>{let l;return t(ct,{class:U.claimTabs,lazyRender:!0,shrink:!0,animated:!0,active:e.tabsActive,"onUpdate:active":n=>e.tabsActive=n},$(l=p.map(n=>{var b;return t(ut,{titleClass:U.tabTitle,key:n.value,name:n.value,title:(b=n.label)==null?void 0:b.call(n),offset:[10,-6],badge:n.value===v.CLAIM_ORDER&&e.unreadMsgCount?Number(e.unreadMsgCount)>=99?"99+":e.unreadMsgCount:""},{default:()=>[n.component]})}))?l:{default:()=>[l]})}})}});export{me as default};
//# sourceMappingURL=ClaimIndex.bxYLu50R.js.map
