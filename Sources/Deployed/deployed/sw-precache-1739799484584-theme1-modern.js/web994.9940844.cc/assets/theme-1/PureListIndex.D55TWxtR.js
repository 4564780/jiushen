import{a as g,az as y,c2 as D,Y as L,q as I,d0 as R,d1 as S,fI as k,cp as M,ln as z,bu as E,dN as N,a6 as B,bg as A,v as G}from"./main.C8q1iJMV.js";import{L as O}from"./ListItemIndex.D0wv8G85.js";import{R as b,E as x}from"./ReceiveCountdownIndex.C4K-6t0P.js";import{u as j}from"./useReceiveOne.D6y37THV.js";import{M as F}from"./ModalContentIndex.Dj08dEyt.js";import{l as w,E as H,f as m,p as e,r as P,w as $,o as q,a as U,A as V}from"../vendors/vendor-@vue.DNlpgob2.js";import{R as W}from"./RecordInfoIndex.DfJ68Kg9.js";import"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import"../vendors/vendor-stable.LD58Pbb3.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"./index.JiQV5KHQ.js";import"./LazyLoader.cfovhYZu.js";import"./SourceTextIndex.B2mGCFWw.js";import"./index.C870Y1OX.js";import"./index.nTWlx4yZ.js";const Y="_collect_uxbhh_24",J="_shake_uxbhh_53",K="_rewardTimeTips_uxbhh_56",Q="_animated_uxbhh_63",l={"receive-btn-box":"_receive-btn-box_uxbhh_17",collect:Y,"collect-txt":"_collect-txt_uxbhh_33","modal-content-box":"_modal-content-box_uxbhh_44",shake:J,rewardTimeTips:K,animated:Q},[X]=I("pages-can-receive-btn"),Z=w({name:X,props:{receiveItem:{type:Object,default:null}},setup(r){const{t:c}=g(),d=y(),s=j(),u=H("refreshData"),v=m(()=>{var a;return((a=r.receiveItem)==null?void 0:a.receiveDuration)<0}),i=m(()=>{var a;return((a=r.receiveItem)==null?void 0:a.receiveDuration)>0}),f=()=>{k.showDialog({title:c("lobby.reward.base.templateTitle"),className:l["modal-content-box"],message:()=>e(F,{rewardData:r.receiveItem,isRecords:!1,hiddenStatus:!0},null),showConfirmButton:!1,showCloseButton:!0})},t=async()=>{var a;if((a=r.receiveItem)!=null&&a.canGo){const{activeType:n,template:_,activeId:T,ruleId:C}=r.receiveItem;await R(n,_,T,Number(C))?S(r.receiveItem):f();return}s.handleReceive(r.receiveItem,o)},o=()=>{u==null||u()},h=m(()=>{var n;const a=(n=r.receiveItem)!=null&&n.canGo?c("lobby.modal.task.forward"):c("lobby.modal.task.collect");return D(a)});return()=>{if(!d.hasLogined)return e("div",null,null);const{id:a,receiveDuration:n,canGo:_}=r.receiveItem;return e("div",{class:{[l["receive-btn-box"]]:!0,[l.shake]:s.shakeId.value===a}},[e(L,{type:_?"primary":"success",class:l.collect,disabled:i.value,onClick:t,size:"small"},{default:()=>[e("div",{class:l["collect-txt"]},[h.value]),e("div",null,[v.value&&e(b,{class:l.resetCountdown,textFormatType:x.None,duration:n,onComplete:o,inheritTextColor:!0},null),i.value&&e(b,{class:l.resetCountdown,textFormatType:x.None,duration:n,onComplete:o,inheritTextColor:!0},null)])]})])}}}),ee="_recordHeader_1pizl_17",te="_recordSelect_1pizl_23",oe="_placeholder_1pizl_35",ae="_recordMain_1pizl_40",ne="_loadingMore_1pizl_45",re="_guiding_1pizl_53",se="_icon2_1pizl_63",p={recordHeader:ee,recordSelect:te,placeholder:oe,recordMain:ae,loadingMore:ne,guiding:re,icon2:se},[ie]=I("pages-home-discount-can-receive-page"),Se=w({name:ie,setup(){const{t:r}=g(),c=P(0),d=y(),s=M(z,{immediate:!1,transformFn:t=>{var o;return c.value=(o=t.totalActivity)!=null?o:0,{data:t.list,total:t.count}},defaultPageSize:20}),u=m(()=>{var a;const t=[],o=[],h=[];return(a=s.list.value)==null||a.forEach(n=>{n.canGo?t.push(n):n.receiveDuration>0?h.push(n):o.push(n)}),[...o,...t,...h]});$(()=>d.hasLogined,(t,o)=>{t!==o&&i()});const v=async(t=!1)=>{d.hasLogined&&s.loadData(t)},i=()=>{v(!0)};q(()=>{i()}),U(()=>{i()}),V("refreshData",i);const f=m(()=>d.hasLogined?E().isListLoading?"nested-loading":null:"empty");return()=>e(G,null,{header:()=>d.hasLogined?e("div",{class:p.recordHeader},[e("div",{class:p.recordSelect},[e(N,{placement:"bottom-start",offset:[0,10]},null)]),e(W,{listError:!!s.listError.value,loading:s.loading.value,totalActivity:c.value,onRetry:i},null)]):e("div",null,null),default:()=>e(B,{class:p.placeholder,empty:{text:r("lobby.event.luckyWheel.tabs.noData")},type:f.value},{default:()=>[e(A,{finished:s.finished.value,error:!!s.listError.value,loading:s.loading.value,class:p.recordMain,onLoad:v,onRetry:i},{default:()=>{var t;return[(t=u.value)==null?void 0:t.map(o=>e(O,{listItem:o,key:o.id},{default:()=>[e(Z,{receiveItem:o},null)]}))]}})]})})}});export{Se as default};
//# sourceMappingURL=PureListIndex.D55TWxtR.js.map
