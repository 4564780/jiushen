import{a as V}from"./props.DdPRoj_x.js";import{a as T,bq as C,U as N,aE as R,br as z,bs as H,I as Q,bQ as U,iX as W,bG as X,cm as J,bL as Y,ca as I,lC as Z,bu as E,a6 as ee,t as j}from"./main.C8q1iJMV.js";import{s as te}from"../vendors/vendor-stable.LD58Pbb3.js";import{u as x}from"./index.BB5bZn2v.js";import{T as K}from"./index.SS2HDjZq.js";import{l as D,f as d,p as t,r as w,w as ae}from"../vendors/vendor-@vue.DNlpgob2.js";import{P as ne}from"./PublicIntroductionIndex.bUl03y0X.js";import{a as se}from"./activeReceiveOne.CY32GsDi.js";import{e as re}from"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"./Table.CBQduS50.js";var $=(e=>(e[e.Fixed=1]="Fixed",e[e.Charge=2]="Charge",e[e.Bet=3]="Bet",e))($||{}),f=(e=>(e[e.End=1]="End",e[e.Continue=2]="Continue",e[e.Random=3]="Random",e))(f||{}),S=(e=>(e[e.Fixed=1]="Fixed",e[e.Times=2]="Times",e))(S||{});const oe="_tableList_anljw_17",le="_text_anljw_17",L={tableList:oe,text:le},[ce]=N("event-item-modes-lucky-bet-components-limit-table"),ie=D({name:ce,setup(){const{t:e}=T(),r=d(()=>{const{eventItemData:o}=x();return o.activeData}),i=d(()=>{var o;return[{title:((o=r.value)==null?void 0:o.receiveType)===$.Charge?e("lobby.event.luckyBet.validCharge"):e("lobby.event.luckyBet.validBet"),key:"amount",customRender:l=>t("span",{class:L.text},["≥".concat(C(l))])},{title:e("lobby.event.luckyBet.dailyLimit"),key:"num",customRender:l=>t("span",{class:L.text},["".concat(l," "),e("lobby.event.luckyBet.times")])}]});return()=>{var o;return t(K,{class:L.tableList,columns:i.value,data:(o=r.value)==null?void 0:o.receiveList,uniqueKey:"limitTable"},null)}}}),ue="_tableList_122av_17",de="_text_122av_45",ve="_yellow_122av_48",k={tableList:ue,text:de,yellow:ve},[me]=N("event-item-modes-lucky-bet-components-rewards-table"),G=D({name:me,setup(){const{t:e}=T(),r=d(()=>{const{eventItemData:l}=x();return l.activeData}),i=w({[f.End]:e("lobby.event.luckyBet.orderEnd"),[f.Continue]:e("lobby.event.luckyBet.orderContinue"),[f.Random]:e("lobby.event.luckyBet.orderRandom")}),o=d(()=>{var l,v,y;return[{title:i.value[(l=r.value)==null?void 0:l.ruleType],dataIndex:"ruleValue",key:"ruleValue",customRender:(n,p)=>{var m;return((m=r.value)==null?void 0:m.ruleType)===f.Random?t("span",{class:k.text},[p.ruleNum,e("lobby.event.luckyBet.piece"),n]):t("span",{class:k.text},[n])}},...((v=r.value)==null?void 0:v.rewardType)===S.Fixed?[{title:e("lobby.event.luckyBet.fixedAmount"),key:"amount",customRender:n=>t("span",{class:k.yellow},["".concat(C(n))])}]:[{title:e("lobby.event.luckyBet.amountTimes"),dataIndex:"amountTimes",key:"amountTimes",customRender:n=>t("span",{class:k.text},[e("lobby.event.luckyBet.betNumTimes",{x:+n})])},((y=r.value)==null?void 0:y.amountLimitSwitch)===0?null:{title:e("lobby.event.luckyBet.amountLimit"),dataIndex:"amountLimit",key:"amountLimit",customRender:n=>t("span",{class:k.yellow},[+n>0?C(n):e("lobby.event.luckyBet.noLimit")])}].filter(Boolean)]});return()=>{var l;return t(K,{class:k.tableList,columns:o.value,data:(l=r.value)==null?void 0:l.rewardList,uniqueKey:"rewardsTable"},null)}}}),M="/active/luckyOrderList",be=async e=>{var i;const r=await R.request({url:M,method:"post",data:{activeId:e},headers:{deviceModel:z(),devicetype:H()}},{cache:{useCache:"fresh",time:60},oss:{enable:!1}});return(i=r==null?void 0:r.data)==null?void 0:i.data},ye="_recordsContainer_12g0s_17",pe="_recordItem_12g0s_31",ke="_top_12g0s_34",ge="_award_12g0s_39",Ie="_btn_12g0s_47",fe="_bottom_12g0s_54",g={recordsContainer:ye,recordItem:pe,top:ke,award:ge,btn:Ie,bottom:fe},[xe]=N("event-item-modes-lucky-bet-components-winning-records"),_e=D({name:xe,props:{eventId:Number},emits:["refresh"],setup(e,{emit:r}){const{t:i}=T(),o=w(!1),l=w(0),v=w([]),y=d(()=>{const{eventItemData:a}=x();return a.activeData}),n=async()=>{if(!e.eventId)return;const[,a]=await re(be(e.eventId));a&&(v.value=a)},p=async a=>{var s;const{eventItemData:c}=x();if(o.value||!c.id)return;const b={receiveDeviceType:c==null?void 0:c.receiveDeviceType,receiveStatus:a.receiveStatus,receiveCategory:a.logCategory,amount:+a.rewardAmount,taskCondition:c==null?void 0:c.taskCondition};await Y.check({eventData:b,checkOptions:{[I.forbidReceive]:!0,[I.receiveType]:!0,[I.task]:!0,[I.largeAmount]:!0,[I.pendingCheck]:!0}})||(o.value=!0,l.value=a.recordId,se({params:{receiveId:(s=a.recordId)==null?void 0:s.toString(),activeId:c.id},judgeResBefore:()=>{r("refresh"),o.value=!1,l.value=0},onSuccess:async()=>{await R.setCacheExpired(M),n(),await R.setCacheExpired(Z),E().getEventCategoriesAndEvents()}}))};ae(()=>e.eventId,()=>{n()},{immediate:!0});const m=a=>{var s,u;const c=(a.receiveStatus===U.CanReceive||a.receiveStatus===U.PendingCheck)&&Number((u=(s=y.value)==null?void 0:s.receiveAvailableNum)!=null?u:0)>0,b=W(a.receiveStatus);return t("div",{class:["lucky-bet-item",g.recordItem]},[t("div",{class:g.top},[t("p",null,[X(a.betTime)]),t("p",{class:g.award},[i("lobby.event.luckyBet.reward"),t("span",null,[C(a.rewardAmount)])]),t(J,{type:"success",class:g.btn,disabled:!c,loading:o.value&&a.recordId===l.value,text:b,onClick:()=>p(a)},null)]),t("div",{class:g.bottom},[t("p",null,[t("span",null,[i("lobby.event.luckyBet.orderNo")]),a.orderNo.split("").map((_,B)=>t("span",{key:_,class:a.matchKey[B]==="1"?"primary":""},[_]))])])])};return()=>{var c;const a=!!((c=v.value)!=null&&c.length);return t("div",{class:g.recordsContainer},[t("div",{class:"lucky-bet-item records-header"},[a?t("span",null,[i("lobby.event.luckyBet.awardOrders")]):[t(Q,{src:"/lobby_asset/common/web/common/img_hd_ts.svg"},null),t("span",null,[i("lobby.event.luckyBet.notAwarded")])]]),v.value.map(b=>m(b))])}}}),h={"lucky-bet":"_lucky-bet_1wuex_17"},[he]=N("event-item-modes-lucky-bet"),je=D({name:he,props:{...V,eventId:Number},setup(e){const{t:r}=T(),i=x(),{eventItemData:o,isItemLoading:l,itemErr:v}=te(i),y=d(()=>l.value?"nested-loading":v.value?"retry":null),n=d(()=>{var s;return(s=o.value)==null?void 0:s.activeData}),p=d(()=>{var s;return((s=n.value)==null?void 0:s.receiveType)===$.Fixed}),m=async()=>{e.eventId&&i.refreshEventItemDetail(e.eventId)},a=d(()=>{var A,F,P,O,q;const s=Number((A=n.value)==null?void 0:A.receiveTotalNum),u=Number((F=n.value)==null?void 0:F.receiveNum),_=s?r("lobby.event.redPocket.grabTip5",{x:'<span class="tip-black">'.concat((P=n.value)==null?void 0:P.receiveTotalNum,"</span>")})+(s&&u?"，":""):"",B=(u?r("lobby.event.luckyBet.todayLimit1",{y:'<span class="tip-black">'.concat((O=n.value)==null?void 0:O.receiveNum,"</span>")}):"")+(s||u?'<span class="tip-green">'.concat(r("lobby.event.luckyBet.todayLimit2",{z:(q=n.value)==null?void 0:q.receiveAvailableNum}),"</span>"):"");return{tips1:_,tips2:B}}),c=()=>t("div",{class:"lucky-bet-item lucky-bet-item-limit"},[t("h4",{class:"item-title"},[t(j,{tag:"span",class:h.limitTip,html:a.value.tips1},null),t(j,{tag:"span",class:h.limitTip,html:a.value.tips2},null)]),p.value?t(G,null,null):t(ie,null,null)]),b=()=>{var s;return t("div",{class:"lucky-bet-item"},[t(G,null,null),((s=n.value)==null?void 0:s.rewardType)!==S.Fixed&&t("div",{class:"item-tips"},[r("lobby.event.luckyBet.rewardDescription")])])};return()=>t(ee,{type:y.value,class:h["lucky-bet"],onRetry:m},{default:()=>{var s,u;return[t(_e,{eventId:e.eventId,onRefresh:m},null),((s=n.value)==null?void 0:s.receiveType)&&c(),((u=n.value)==null?void 0:u.receiveType)&&!p.value&&b(),t(ne,{class:h.introduction,eventData:o.value},null)]}})}});export{je as default};
//# sourceMappingURL=LuckyBetIndex.Da3yAnh4.js.map
