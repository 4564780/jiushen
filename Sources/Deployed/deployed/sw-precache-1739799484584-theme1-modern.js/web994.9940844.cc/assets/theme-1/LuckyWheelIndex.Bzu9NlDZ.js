import{a as f,I,bq as B,U as D,fI as le,aE as $,br as N,bs as E,b8 as F,a6 as H,cs as X,bG as Y,cp as ye,bg as be,az as se,t as oe,bV as pe,bL as he,ca as S,bX as ge,bN as _e,aN as fe,aO as ke}from"./main.C8q1iJMV.js";import{a as Ie}from"./props.DdPRoj_x.js";import{l as L,f as m,p as e,Y as we,r as b,D as J,w as C,F as Q,o as Te,q as De,C as Le}from"../vendors/vendor-@vue.DNlpgob2.js";import{d as ze,s as We}from"../vendors/vendor-stable.LD58Pbb3.js";import{u as w}from"./index.BB5bZn2v.js";import"../vendors/vendor-default.CjiYZF7Q.js";import{P as Re}from"./PublicIntroductionIndex.bUl03y0X.js";import{T as Se}from"./index.SS2HDjZq.js";import{a as xe}from"./activeReceiveOne.CY32GsDi.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"./Table.CBQduS50.js";var _=(t=>(t[t.SILVER=0]="SILVER",t[t.GOLD=1]="GOLD",t[t.DIAMOND=2]="DIAMOND",t))(_||{}),U=(t=>(t[t.Normal=1]="Normal",t))(U||{}),q=(t=>(t[t.TurntableTask=-1]="TurntableTask",t[t.Announcement=0]="Announcement",t[t.MyRecord=1]="MyRecord",t))(q||{});const Z={turntableType:{type:Number,require:!0,default:_.SILVER}},ce={eventId:{type:Number,require:!0},...Ie},Ce={...Z,...ce},$e={prize:{type:Number,require:!0,default:0},...Z},K={eventId:{type:Number,require:!0},...Z},Pe={"model-box":"_model-box_1oijf_17"},[Me]=D("event-item-modes-lucky-wheel-components-receive-sucess"),qe=L({name:Me,props:$e,setup(t){const{t:n}=f(),a=m(()=>{var r;return(r=P(t.turntableType))==null?void 0:r.winTitle}),s=m(()=>"/lobby_asset/common/web/animated/apng_zhuanpan_".concat(["blue","golden","purple"][t.turntableType],".png"));return()=>e("div",{class:Pe["model-box"]},[e("div",{class:"model-main"},[e(I,{class:"apng",canvasMode:{numPlays:1},src:s.value},null),e(I,{class:"bg-img-box",src:a.value,tag:"div"},{default:()=>[e("div",{class:"text-box"},[n("lobby.event.luckyWheel.toast.receiveSuccess")])]})]),e("p",{class:"model-foot"},[e("span",{class:"amount"},[B(t.prize)]),n("lobby.event.luckyWheel.toast.depositBalance")])])}}),Be="_active_1yc53_99",Ne="_silver_1yc53_106",Ee="_gold_1yc53_109",Oe="_diamond_1yc53_112",z={"event-lucky-wheel":"_event-lucky-wheel_1yc53_17","turntable-tabs":"_turntable-tabs_1yc53_62",active:Be,silver:Ne,gold:Ee,diamond:Oe,"sucess-dialog":"_sucess-dialog_1yc53_116"},P=t=>{var s;const{t:n}=f();return(s={[_.SILVER]:{title:n("lobby.event.luckyWheel.tabs.silver"),listIcon:"/lobby_asset/common/common/event/zphd_icon_silver.png",wheelBg:"/lobby_asset/common/common/event/zphd_bj_s1.png",wheelBtn:"/lobby_asset/common/common/event/zphd_ljcj_s1.png",wheelPointer:"/lobby_asset/common/common/event/zphd_zz_s1.png",winTitle:"/lobby_asset/common/common/event/zphd_cg_silver.png"},[_.GOLD]:{title:n("lobby.event.luckyWheel.tabs.gold"),listIcon:"/lobby_asset/common/common/event/zphd_icon_gold.png",wheelBg:"/lobby_asset/common/common/event/zphd_bj_s2.png",wheelBtn:"/lobby_asset/common/common/event/zphd_ljcj_s2.png",wheelPointer:"/lobby_asset/common/common/event/zphd_zz_s2.png",winTitle:"/lobby_asset/common/common/event/zphd_cg_golden.png"},[_.DIAMOND]:{title:n("lobby.event.luckyWheel.tabs.diamond"),listIcon:"/lobby_asset/common/common/event/zphd_icon_diamond.png",wheelBg:"/lobby_asset/common/common/event/zphd_bj_s3.png",wheelBtn:"/lobby_asset/common/common/event/zphd_ljcj_s3.png",wheelPointer:"/lobby_asset/common/common/event/zphd_zz_s3.png",winTitle:"/lobby_asset/common/common/event/zphd_cg_diamond.png"}}[t])!=null?s:null},Ve=(t,n,a)=>{le.showDialog({class:z["sucess-dialog"],overlayStyle:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1999},message:()=>we(qe,{prize:t,turntableType:n}),showCancelButton:!1,showConfirmButton:!1,showCloseButton:!0,onClose:()=>{a==null||a()}})},T=ze("eventLuckyWheel",()=>{const t=b(!1),n=b(!1);return{isLottery:n,isRefreshRecord:t,setIsLottery:(r=!1)=>{n.value=r},changeIsRefreshRecord:r=>{t.value=r}}}),re="/active/turntableTaskList",ue="/active/announcement",ie="/active/my_logs",je=async t=>{var a;const n=await $.request({url:"/active/luckyIntegralList",method:"post",data:{...t},headers:{deviceModel:N(),devicetype:E()}},{cache:{useCache:"fresh",time:60},oss:{enable:!1}});return(a=n==null?void 0:n.data)==null?void 0:a.data},Ae=async t=>{var a;const n=await $.request({url:re,method:"post",data:{activeId:t},headers:{deviceModel:N(),devicetype:E()}},{cache:{useCache:"fresh",time:60},oss:{enable:!1}});return(a=n==null?void 0:n.data)==null?void 0:a.data},Ge=async t=>{var a;const n=await $.request({url:ue,method:"post",data:{...t},headers:{deviceModel:N(),devicetype:E()}},{cache:{useCache:"fresh",time:60},oss:{enable:!1}});return((a=n==null?void 0:n.data)==null?void 0:a.data)||[]},Ue=async t=>{var a;const n=await $.request({url:ie,method:"post",data:{activeId:t,page:1},headers:{deviceModel:N(),devicetype:E()}},{cache:{useCache:"fresh",time:60},oss:{enable:!1}});return((a=n==null?void 0:n.data)==null?void 0:a.data)||[]},Fe="_announcement_wo97m_17",He={announcement:Fe},[Xe]=D("event-item-modes-lucky-wheel-components-announcement"),Ye=L({name:Xe,props:K,setup(t){const{t:n}=f(),a=b(!1),s=b([]),r=async()=>{t.eventId&&(a.value=!0,s.value=await Ge({activeId:t.eventId,rotaryType:t.turntableType}),T().changeIsRefreshRecord(!1),a.value=!1)};J(()=>{r()}),C(()=>T().isRefreshRecord,o=>{o&&r()});const d=o=>{const l=P(o.rotaryType);return e("div",{class:"record-item"},[e("div",{class:"record-info"},[e(I,{src:l.listIcon,useSkeleton:!0},null),e("div",{class:"record-desc"},[e("p",{class:"time"},[Y(o.dateTime,"mdhm")]),e("p",null,[n("lobby.event.luckyWheel.splicingGet",{user:o==null?void 0:o.nickname,zhuanpan:l.title})])])]),e("span",{class:"amount"},[B(o.prize)])])};return()=>e(X,{class:He.announcement},{default:()=>{var o,l;return[a.value?e("div",{class:"loading"},[e(F,null,null)]):e(Q,null,[(o=s.value)==null?void 0:o.map(i=>d(i)),((l=s.value)==null?void 0:l.length)===0&&e(H,{type:"empty",empty:{text:n("lobby.event.luckyWheel.tabs.noData")}},null)])]}})}}),Je={"bet-detail-content":"_bet-detail-content_74syr_17"},[Qe]=D("event-item-modes-lucky-wheel-components-base-info-components-bet-detail"),Ze=L({name:Qe,setup(){const{t}=f(),n=m(()=>{const{eventItemData:a}=w();return a.activeData});return()=>{var a,s,r,d,o;return e("div",{class:Je["bet-detail-content"]},[e("div",{class:"item"},[e("label",null,[t("lobby.event.luckyWheel.betDetails.betTotal"),":"]),e("span",{class:"value"},[(a=n.value)==null?void 0:a.validBet])]),e("div",{class:"item"},[e("label",null,[t("lobby.event.luckyWheel.betDetails.luckyPointsUsed"),":"]),e("span",{class:"value"},[(s=n.value)==null?void 0:s.usedIntegral])]),e("div",{class:"item"},[e("label",null,[t("lobby.event.luckyWheel.betDetails.expireIntegral"),":"]),e("span",{class:"value"},[(r=n.value)==null?void 0:r.expireIntegral])]),e("div",{class:"item"},[e("label",null,[t("lobby.event.luckyWheel.betDetails.luckyValueAvailable"),":"]),e("span",{class:"value"},[Math.floor((o=(d=n.value)==null?void 0:d.haveIntegral)!=null?o:0)])])])}}}),ae={"detail-list":"_detail-list_1qqdz_17","bet-detail-content":"_bet-detail-content_1qqdz_71"},[Ke]=D("event-item-modes-lucky-wheel-components-base-info-components-detail-list"),et=L({name:Ke,setup(){const{t}=f(),n=b(0),a=m(()=>w().eventItemData),s=ye(je,{immediate:!1,alias:{page:"page",pageSize:"size"},transformFn:l=>({data:l.data,total:l.total,taskCategory:l.taskCategory}),defaultPageSize:20}),r=async()=>{var l;if(s.payload.value={activeId:(l=a.value)==null?void 0:l.id},se().hasLogined){const i=await s.loadData();n.value=(i==null?void 0:i.taskCategory)||0}},d=()=>{var l,i;return e("div",{class:"head list-item"},[e("div",null,[t("lobby.event.luckyWheel.table.time")]),e("div",null,[!!((i=(l=s.list)==null?void 0:l.value)!=null&&i.length)&&e("span",null,[n.value===1?t("lobby.event.luckyWheel.table.dayTask"):t("lobby.event.luckyWheel.table.weekTask")])]),e("div",null,[t("lobby.event.luckyWheel.table.luckyValue")])])},o=l=>e("div",{class:"body list-item"},[e("div",null,[e("span",{class:"reward-time"},[Y(l.rewardTime)])]),e("div",null,[l.taskDesc]),e("div",{class:"lucky-text"},[l.luckyIntegral])]);return()=>{var i;const l=(i=a.value.activeData)!=null?i:{};return e(Q,null,[e("div",{class:ae["detail-list"]},[d(),e(X,{class:"list-main"},{default:()=>[e(be,{finished:s.finished.value,error:!!s.listError.value,loading:s.loading.value,onLoad:r,onRetry:r},{default:()=>{var k,h;return[(h=(k=s.list)==null?void 0:k.value)==null?void 0:h.map(W=>o(W))]}})]})]),e("div",{class:[ae["bet-detail-content"]]},[e("div",{class:"item"},[e("label",null,[t("lobby.event.luckyWheel.betDetails.luckyPointsUsed"),":"]),e("span",{class:"value"},[l==null?void 0:l.usedIntegral])]),e("div",{class:"item"},[e("label",null,[t("lobby.event.luckyWheel.betDetails.expireIntegral"),":"]),e("span",{class:"value"},[l==null?void 0:l.expireIntegral])]),e("div",{class:"item"},[e("label",null,[t("lobby.event.luckyWheel.betDetails.luckyValueAvailable"),":"]),e("span",{class:"value"},[l==null?void 0:l.haveIntegral])])])])}}}),A={"base-info-wrap":"_base-info-wrap_wkq00_17","base-info":"_base-info_wkq00_17","bet-detail":"_bet-detail_wkq00_59"},[tt]=D("event-item-modes-lucky-wheel-components-base-info"),nt=L({name:tt,setup(){const{t}=f(),n=m(()=>{const{eventItemData:s}=w();return s.activeData}),a=()=>{if(!se().hasLogined)return pe().openLoginRegister({login:!0}),!1;le.showDialog({class:A["bet-detail"],title:()=>t("lobby.event.luckyWheel.tabs.details"),message:()=>{var s;if((s=n.value)!=null&&s.isShowDetails)return e(et,null,null);if(n.value.rewardType===U.Normal)return e(Ze,null,null)},showConfirmButton:!1,showCloseButton:!0})};return()=>{var s,r,d,o,l;return e("div",{class:A["base-info-wrap"]},[e("div",{class:A["base-info"]},[e("div",{class:"info"},[e("div",null,[e("span",{class:"label"},[t("lobby.event.luckyWheel.tabs.currentLuckyValue")]),e("span",{class:"value"},[Math.floor((r=(s=n.value)==null?void 0:s.haveIntegral)!=null?r:0)])])]),e("p",{class:"btn",onClick:a},[t("lobby.event.luckyWheel.tabs.details")])]),((d=n.value)==null?void 0:d.rewardType)===U.Normal&&!!((o=n.value)!=null&&o.betForIntegral)&&e(oe,{class:"bet-tips",html:t("lobby.event.luckyWheel.effectiveBetTips",{x:"<span>".concat((l=n.value)==null?void 0:l.betForIntegral,"</span>"),n:"<span>1</span>"})},null)])}}}),at={"my-record":"_my-record_fupzb_17"},[lt]=D("event-item-modes-lucky-wheel-components-record"),st=L({name:lt,props:K,setup(t){const{t:n}=f(),a=b(!1),s=b([]),r=async()=>{t.eventId&&(a.value=!0,s.value=await Ue(t.eventId),T().changeIsRefreshRecord(!1),a.value=!1)};J(()=>{r()}),C(()=>T().isRefreshRecord,o=>{o&&r()});const d=o=>{const l=P(o.rotaryType);return e("div",{class:"record-item"},[e("div",{class:"record-info"},[e(I,{src:l.listIcon,useSkeleton:!0},null),e("div",{class:"record-desc"},[e("p",{class:"time"},[Y(o.dateTime,"mdhm")]),e("p",null,[l.title])])]),e("span",{class:"amount"},[B(o.prize)])])};return()=>e(X,{class:at["my-record"]},{default:()=>{var o,l;return[a.value?e("div",{class:"loading"},[e(F,null,null)]):e(Q,null,[(o=s.value)==null?void 0:o.map(i=>d(i)),((l=s.value)==null?void 0:l.length)===0&&e(H,{type:"empty",empty:{text:n("lobby.event.luckyWheel.tabs.noData")}},null)])]}})}}),ot="_task_163pu_17",ct="_loading_163pu_17",G={task:ot,loading:ct,"task-desc":"_task-desc_163pu_24","lucky-integral":"_lucky-integral_163pu_27"},[rt]=D("event-item-modes-lucky-wheel-components-task"),ut=L({name:rt,props:K,setup(t){const{t:n}=f(),a=b(!1),s=b({}),r=m(()=>w().eventItemData),d=async()=>{var i;const{isShowTask:l}=(i=r.value)==null?void 0:i.activeData;!l||!t.eventId||(a.value=!0,s.value=await Ae(t.eventId),T().changeIsRefreshRecord(!1),a.value=!1)};J(()=>{d()}),C(()=>T().isRefreshRecord,l=>{l&&d()});const o=m(()=>{var l;return[{title:((l=s.value)==null?void 0:l.taskCategory)===1?n("lobby.event.luckyWheel.table.dayTask"):n("lobby.event.luckyWheel.table.weekTask"),dataIndex:"taskDesc",key:"taskDesc",customRender:i=>e("span",{class:G["task-desc"]},[i])},{title:n("lobby.event.luckyWheel.table.canGetluckyValue"),dataIndex:"luckyIntegral",key:"luckyIntegral",customRender:i=>e("span",{class:G["lucky-integral"]},[i])}]});return()=>e("div",{class:G.task},[a.value?e("div",{class:"loading"},[e(F,null,null)]):e(Se,{class:"task-list",columns:o.value,data:s.value.data,uniqueKey:"luckyWheelTask"},null)])}}),it="_turntable_1i0ek_17",dt="_center_1i0ek_110",vt="_winning_1i0ek_133",x={turntable:it,"turntable-style8":"_turntable-style8_1i0ek_89","whell-item":"_whell-item_1i0ek_89","turntable-style10":"_turntable-style10_1i0ek_89","turntable-style12":"_turntable-style12_1i0ek_92",center:dt,winning:vt},[mt]=D("event-item-modes-lucky-wheel-components-turntable"),yt=L({name:mt,props:Ce,setup(t){const{t:n}=f(),a=5*10,s=b(0),r=b(!1),d=b(null),{isLottery:o,setIsLottery:l}=T(),i=m(()=>P(t.turntableType)),k=m(()=>{const{eventItemData:c}=w();return c.activeData}),h=m(()=>{var c,v,g;return(g=(v=(c=k.value)==null?void 0:c.turntableList)==null?void 0:v.find(R=>R.rotary_type===t.turntableType))!=null?g:null}),W=m(()=>{var c,v,g;return(g=(v=(c=h.value)==null?void 0:c.list)==null?void 0:v.length)!=null?g:0}),O=m(()=>s.value*36+"deg"),V=(c,v)=>e("div",{key:"".concat(c.icon,"-").concat(v),class:x["whell-item"],style:{transform:"rotate(".concat(v*36,"deg)")}},[e("div",{class:x.center},[e("p",null,[B(c.prize,2)])]),e(I,{src:c.icon},null)]),u=async()=>{var ee,te;if(o||!((ee=h.value)!=null&&ee.list))return;const{receiveDeviceType:c,taskCondition:v,id:g,startTime:R,endTime:de}=w().eventItemData;if(g&&!await he.check({eventData:{receiveDeviceType:c,taskCondition:v,loginRegisterDialogOptions:{login:!0},startTime:R,endTime:de},checkOptions:{[S.timeLimit]:!0,[S.logined]:!0,[S.forbidReceive]:!0,[S.receiveType]:!0,[S.task]:!0}})){if(((te=k.value)==null?void 0:te.haveIntegral)===0||!h.value||h.value.need_integral>k.value.haveIntegral){ge({message:n("lobby.event.luckyWheel.toast.notEnough")});return}l(!0),xe({params:{receiveId:t.turntableType.toString(),activeId:g},judgeResBefore:()=>{t.eventId&&w().refreshEventItemDetail(t.eventId)},showSuccessModal:!1,onSuccess:j=>{const ne=s.value,ve=ne+(10-ne%10),M=j==null?void 0:j.receiveData,me=11-((M==null?void 0:M.index)||1);s.value=ve+a+me,p(M)},onError:()=>{l()},showAudio:!1,updatePrize:!1})}},p=c=>{y(()=>{r.value=!0,y(async()=>{Ve(c.prize,t.turntableType,()=>{r.value=!1}),_e().updatePrize(),await $.setCacheExpired([re,ue,ie]),T().changeIsRefreshRecord(!0),l()})},5e3)},y=(c,v=1e3)=>{d.value&&clearTimeout(d.value),d.value=setTimeout(()=>{c==null||c()},v)};return()=>e("div",{class:[x.turntable,x["turntable-style".concat(W.value)]]},[e(I,{tag:"div",class:"wheel",src:i.value.wheelBg,style:{transform:"rotate(".concat(O.value,")")}},{default:()=>{var c,v;return[(v=(c=h.value)==null?void 0:c.list)==null?void 0:v.map((g,R)=>V(g,R))]}}),e(I,{class:"wheel-pointer",tag:"div",src:i.value.wheelPointer},{default:()=>[e(I,{src:"/lobby_asset/common/common/event/zphd_xzg_s2.png",class:r.value?x.winning:""},null)]}),e(I,{class:"whell-btn",tag:"div",src:i.value.wheelBtn,onClick:u},{default:()=>[e(oe,{class:"draw",html:n("lobby.event.luckyWheel.tabs.drawNow")},null)]})])}});function bt(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!Le(t)}const[pt]=D("event-item-modes-lucky-wheel"),$t=L({name:pt,props:ce,setup(t){const{t:n}=f(),a=b(),s=w(),{eventItemData:r,isItemLoading:d,itemErr:o}=We(s),l=m(()=>d.value?"nested-loading":o.value?"retry":null),i=m(()=>{var u;return(u=r.value)==null?void 0:u.activeData}),k=m(()=>{var p,y;const u=[{key:q.MyRecord,title:n("lobby.event.luckyWheel.tabs.myRecord"),component:e(st,{eventId:t.eventId},null)}];return(p=i.value)!=null&&p.isShowAnnouncement&&u.unshift({key:q.Announcement,title:n("lobby.event.luckyWheel.tabs.getAnnouncement"),component:e(Ye,{turntableType:a.value,eventId:t.eventId},null)}),(y=i.value)!=null&&y.isShowTask&&u.unshift({key:q.TurntableTask,title:n("lobby.event.luckyWheel.tabs.turntableTask"),component:e(ut,{eventId:t.eventId},null)}),u}),h=b(),W=u=>{T().isLottery||(a.value=u)};C(()=>r.value,u=>{var p,y,c;if(u.id&&a.value===void 0){const v=(y=(p=u.activeData)==null?void 0:p.turntableList)!=null?y:[];a.value=(c=v[0].rotary_type)!=null?c:_.SILVER}},{deep:!0}),Te(()=>{var u,p,y;if(a.value===void 0){const c=(p=(u=w().eventItemData.activeData)==null?void 0:u.turntableList)!=null?p:[];a.value=(y=c[0].rotary_type)!=null?y:_.SILVER}}),C(k,u=>{h.value=u[0].key},{deep:!0,immediate:!0});const O=u=>e("div",{key:u.rotary_type,class:{[z.active]:a.value===u.rotary_type,[z.diamond]:_.DIAMOND===u.rotary_type,[z.gold]:_.GOLD===u.rotary_type,[z.silver]:_.SILVER===u.rotary_type},onClick:()=>W(u.rotary_type)},[e("p",null,[P(u.rotary_type).title]),e("span",null,[n("lobby.event.luckyWheel.tabs.luckyValue"),u.need_integral])]),V=async()=>{t.eventId&&s.refreshEventItemDetail(t.eventId)};return()=>{let u;return e(H,{type:l.value,class:z["event-lucky-wheel"],onRetry:V},{default:()=>{var p,y;return[e("div",{class:"lucky-wheel-item turntable"},[e(nt,null,null),e(yt,De(t,{turntableType:a.value}),null),e("div",{class:z["turntable-tabs"]},[(y=(p=i.value)==null?void 0:p.turntableList)==null?void 0:y.map(c=>O(c))])]),e(fe,{shrink:!0,class:"lucky-wheel-item lucky-wheel-tabs",animated:!0,active:h.value},bt(u=k.value.map(c=>e(ke,{titleClass:z.tabTitle,name:c.key,title:c.title},{default:()=>[c.component]})))?u:{default:()=>[u]}),e(Re,{eventData:r.value},null)]}})}}});export{$t as default};
//# sourceMappingURL=LuckyWheelIndex.Bzu9NlDZ.js.map
