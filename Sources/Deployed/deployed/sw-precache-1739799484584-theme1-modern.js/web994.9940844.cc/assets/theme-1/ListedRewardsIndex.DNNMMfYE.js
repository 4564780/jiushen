import{eL as G,eH as p,ly as m,a as N,bQ as l,eI as O,iX as V,bq as k,jl as M,az as j,cd as X,U as $,cm as q,bG as z,bV as J,o as K,dD as Q,lA as Z,bX as ee,bL as te,ca as S,w as se,lB as W,I as ae,cf as L,a6 as re,u as ne,l7 as oe,E as le}from"./main.C8q1iJMV.js";import{a as ie,E as ce}from"./props.DdPRoj_x.js";import{w as ue,f as C,l as H,r as B,E as de,p as n,t as pe,A as ve,q as ye,C as ge}from"../vendors/vendor-@vue.DNlpgob2.js";import{b as me,u as fe}from"../vendors/vendor-stable.LD58Pbb3.js";import{B as be}from"./BottomReceiveIndex.D3vCadgd.js";import{P as Re}from"./PublicIntroductionIndex.bUl03y0X.js";import{R as Te,E as we}from"./ReceiveCountdownIndex.C4K-6t0P.js";import{a as he}from"./activeReceiveOne.CY32GsDi.js";import{R as De}from"./RuleListIndex.BcB_bKtQ.js";import"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"./index.SS2HDjZq.js";import"./Table.CBQduS50.js";const U={...ie,eventId:{type:Number,require:!0},forwardCallback:{type:Function,require:!1}},Y=Symbol("eventItemData"),Ie=e=>{const r=G();return ue(()=>e,a=>{!isNaN(Number(a.value))&&a.value&&r.getEventItemDetail(a.value)},{immediate:!0}),{...r}};var g=(e=>(e[e.Accumulative=0]="Accumulative",e[e.Single=1]="Single",e[e.FirstDeposit=2]="FirstDeposit",e))(g||{});const Se=e=>{const{t:r}=me();return{ruleListFirstTitle:C(()=>{const{activeData:v}=e.value,{ruleType:i}=v,o=e.value.cycleType;let f="";return f=new Map([[e.value.template!==p.Deposit,r("lobby.center.report.statistics.validBetTotal")],[e.value.template===p.Deposit&&o===m.Monthly&&i===g.Accumulative,r("lobby.event.listedRewards.perMonthTotalPay")],[e.value.template===p.Deposit&&o===m.Weekly&&i===g.Accumulative,r("lobby.event.listedRewards.weeklyTotalPay")],[e.value.template===p.Deposit&&o===m.Daily&&i===g.Accumulative,r("lobby.event.cumulativereCharge")],[e.value.template===p.Deposit&&o===m.Monthly&&i===g.Single,r("lobby.event.listedRewards.perMonthPay")],[e.value.template===p.Deposit&&o===m.Weekly&&i===g.Single,r("lobby.event.listedRewards.weeklyPay")],[e.value.template===p.Deposit&&o===m.Daily&&i===g.Single,r("lobby.event.listedRewards.ruleTabe.single")],[e.value.template===p.Deposit&&i===g.FirstDeposit,r("lobby.event.listedRewards.firstRecharge")]]).get(!0),f})}},Ce=({receiveStatus:e,reward:r},a)=>{const{t:v}=N(),i=r>0;return e===l.Processing&&!i?v("lobby.modal.task.forward"):e===l.PendingCheck&&a===O.ManualDistribution?v("lobby.modal.task.applied"):V(e)},ke=(e,r)=>[l.HasReceive,l.Expired,l.Distributed,l.Cancel,l.Rejected].indexOf(e)!==-1?!0:e===l.PendingCheck&&r===O.ManualDistribution,Pe=e=>{var v,i;const r=e.progress||"";let a;switch(e==null?void 0:e.signType){case M.Regular:a=k((v=e.reward)!=null?v:0);break;case M.Proportion:a=e.ratio+"%";break;case M.Interregional:r&&(a="".concat(k(r.split(",")[0])," - ").concat(k(r.split(",")[1])));break;default:a=k((i=e.reward)!=null?i:0);break}return a!=null?a:""},Ee="_list_1uyoy_17",Ae="_noReceive_1uyoy_20",xe="_item_1uyoy_30",P={list:Ee,noReceive:Ae,item:xe},[_e]=$("event-item-modes-listed-rewards-components-receive-list"),Me=H({name:_e,props:U,emits:["refresh"],setup(e,{emit:r}){const{t:a}=N(),v=j(),i=fe(),o=B(0),f=B(!1),c=de(Y,B({})),E=C(()=>({[m.Daily]:a("lobby.event.listedRewards.perDay"),[m.Weekly]:a("lobby.event.listedRewards.perWeek"),[m.Monthly]:a("lobby.event.listedRewards.perMonth")})),A=C(()=>{var t,s;return(s=X[((t=v.userInfos)==null?void 0:t.currency)||"CNY"])==null?void 0:s.PAY_JB}),D=()=>r("refresh"),x=t=>{if(t.receiveStatus===l.Processing)return _();if([l.CanReceive,l.PendingCheck,l.PendingApply].indexOf(t.receiveStatus)!==-1)return b(t)},_=()=>{var s;if((s=e.forwardCallback)==null||s.call(e),!j().hasLogined)return J().openLoginRegister({login:!0}),!1;const t=i.query.template;if(t===p.Deposit){K();return}t===p.Wager&&Q()},b=async t=>{var y,d;if(!c.value.id)return;const s=Z(t);if(t.receiveDuration&&s){ee({message:s});return}const u={receiveDeviceType:(y=c.value)==null?void 0:y.receiveDeviceType,receiveStatus:t==null?void 0:t.receiveStatus,receiveCategory:t==null?void 0:t.logCategory,amount:t==null?void 0:t.reward,taskCondition:c==null?void 0:c.value.taskCondition};await te.check({eventData:u,checkOptions:{[S.forbidReceive]:!0,[S.receiveType]:!0,[S.largeAmount]:!0,[S.pendingCheck]:!0,[S.task]:!0}})||(o.value=t.receiveId,f.value=!0,he({params:{receiveId:(d=t.receiveId)==null?void 0:d.toString(),activeId:c.value.id},showSuccessModal:!1,onSuccess:()=>{const R=t.receiveStatus===l.PendingApply;se.success({message:a(R?"lobby.event.invest.applySuccess":"lobby.event.invest.receiveSuccess")})},judgeResBefore:()=>{f.value=!1,o.value=0,D()},animateType:t.reward>=10?W.TYPE_2:W.TYPE_1}))},h=t=>{var u;const s="{reward}";if(new RegExp(s).test(t.text)){const y=new RegExp("(".concat(s,")"),"g"),R=((u=t.text)==null?void 0:u.split(y).filter(Boolean)).reduce((T,I)=>(s===I?(T.push(n(ae,{class:"icon-text",src:A.value},null)),T.push(n("span",{class:"reward"},[Pe(t)]))):T.push(n("span",null,[I])),T),[]);return n("div",{class:"caption"},[R.map(T=>T)])}return n("div",{class:"caption"},[t.text])},w=t=>{const{ruleType:s,cycleType:u}=c.value;return n("div",{class:P.item},[s!==g.FirstDeposit&&n("div",{class:["time",String(u)!=="1"?"week-or-month":""]},[E.value[String(u)]]),n("div",{class:"info"},[h(t),n("div",{class:"operator"},[n(q,{type:"success",disabled:ke(t.receiveStatus,c.value.giveType),text:Ce(t,c.value.giveType),loading:f.value&&t.receiveId===o.value,onClick:()=>x(t)},null)])]),n("div",{class:"time-box"},[n("div",{class:"success-time"},[!!t.competedTime&&z(t.competedTime,"ymd")]),n("div",{class:"reward-time"},[!!t.receiveDuration&&n(Te,{onComplete:D,className:P.resetText,textFormatType:we.Countdown,duration:t.receiveDuration},null)])])])};return()=>{const{activeData:t}=c.value,s=t==null?void 0:t.receiveList,u=(s==null?void 0:s.filter(d=>d.receiveStatus===l.CanReceive))||[],y=(s==null?void 0:s.filter(d=>d.receiveStatus!==l.CanReceive))||[];return n("div",{class:[P.list,"list-reward-list"]},[s!=null&&s.length?[...u,...y].map(d=>w(d)):n("div",{class:P.noReceive},[n("span",null,[a("lobby.event.listedRewards.noRewards")])])])}}}),Le="_modal_s20t1_21",F={"listed-rewards":"_listed-rewards_s20t1_17",modal:Le};function Be(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ge(e)}const[Fe]=$("event-item-modes-listed-rewards"),tt=H({name:Fe,props:U,emits:["marginTypeChange"],setup(e,{emit:r}){const{t:a}=N(),{eventId:v}=pe(e),{refreshEventItemDetail:i,eventItemData:o,isItemLoading:f,itemErr:c}=Ie(v),E=Se(o),A=C(()=>f.value?"nested-loading":c.value?"retry":null);ve(Y,o),r("marginTypeChange",ce.BOTTOM_BTN);const D=async()=>{e.eventId&&i(e.eventId)},x=()=>{ne().close("afterRechargeActivity"),oe.push({name:le.RECORDS})},_=C(()=>{var w,t,s,u,y,d;const b=(t=(w=o.value)==null?void 0:w.template)!=null?t:0,h=((s=o.value)==null?void 0:s.giveType)===O.ManualDistribution;if(b&&[p.Deposit,p.Wager].includes(b)){const R=(d=(y=(u=o.value)==null?void 0:u.activeData)==null?void 0:y.receiveList)!=null?d:[],T=R.some(I=>h?I.receiveStatus===l.PendingApply:I.receiveStatus===l.CanReceive);return(R==null?void 0:R.length)===0?!0:!T}return!1});return()=>{let b;const h=e.pageType===L.PayAfterModal;return n(re,{type:A.value,class:[F["listed-rewards"],e.pageType===L.Normal?F.receiveButton:"","list-rewards",e.pageType===L.PayAfterModal?F.modal:""]},{default:()=>{var w;return[n(Me,ye(e,{onRefresh:D}),null),((w=o.value.list)==null?void 0:w.length)&&n(De,{ruleListFirstTitle:E.ruleListFirstTitle.value,tableList:o.value.list},null),n(Re,{eventData:o.value},null),n(be,{pageType:e.pageType,isShowBack:!h,showReceiveAll:!0,onRefresh:D,eventItemData:o.value,collectAllDisabled:_.value},{default:()=>[h&&n(q,{type:"primary",onClick:x},Be(b=a("lobby.promote.pickUpRecord"))?b:{default:()=>[b]})]})]}})}}});export{tt as default};
//# sourceMappingURL=ListedRewardsIndex.DNNMMfYE.js.map
