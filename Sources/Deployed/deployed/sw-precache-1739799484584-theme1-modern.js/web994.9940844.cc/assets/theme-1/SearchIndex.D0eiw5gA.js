import{cR as I,d4 as G,bw as h,ad as O,ae as P,q as y,a as v,I as k,m as V,bN as z,a9 as J,cs as K,a6 as M,dq as W,a8 as Q,dH as X,p as Y,dI as B,B as Z,v as E,dJ as ee,d9 as te}from"./main.C8q1iJMV.js";import"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import{R as ae,S as se}from"../vendors/vendor-lodash.BYdGDldS.js";import{r as R,l as d,p as t,q as H,F as q,C as w,f as g,d as oe}from"../vendors/vendor-@vue.DNlpgob2.js";import{T as ne,a as re,S as le}from"./TabGameListIndex.DeTUws0J.js";import"../vendors/vendor-stable.LD58Pbb3.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";var m=(e=>(e[e.Normal=-1]="Normal",e[e.Hot=0]="Hot",e[e.Recent=100]="Recent",e[e.Collect=101]="Collect",e[e.SearchResult=99]="SearchResult",e))(m||{});function ce(e,a){const o=I();return{onClearItem:s=>{o.setSearchHistory(ae(o.searchHistory,s))},onClearAll:()=>{o.setSearchHistory([])},onBarClick:s=>{e.value=s,a()}}}function ie(){const e=I(),a=R(""),o=R(!1);return{searchKeywords:a,handleSearchGameListByKeywords:async n=>{var p;const s=await G.searchGameList(n);return o.value||e.setSearchHistory(se([n],e.searchHistory)),o.value=!1,h.doReport({rule:h.rules.SENSOR_BURIED,eventName:h.sensorEvents.ReturnSearchResults,payload:{key_word:n,result_number:(p=s==null?void 0:s.length)!=null?p:0}}),h.updateSerachStatus({key_word:n,result_number:s==null?void 0:s.length,gameList:s}),e.setAllGameList(s),s},setIsForbidUpdateHistory:n=>{o.value=n}}}const me={historyData:{required:!0,type:Array}},ue="_text_hnva7_29",S={"lobby-bar":"_lobby-bar_hnva7_17",text:ue,"icon-clear":"_icon-clear_hnva7_37"},[ye]=y("search-component-bar"),de=d({name:ye,emits:["click","clear"],setup(e,{slots:a,emit:o}){const r=()=>{o("click")},l=()=>{o("clear")};return()=>{var n;return t("div",{class:S["lobby-bar"]},[t("div",{class:S.text,onClick:r},[(n=a.default)==null?void 0:n.call(a)]),t(O,{onClick:l,class:S["icon-clear"],name:P},null)])}}}),be="_historyBox_64pb0_17",_e="_recentSearch_64pb0_20",ge="_history_64pb0_17",pe="_historyContent_64pb0_42",he="_bar_64pb0_56",u={historyBox:be,recentSearch:_e,history:ge,"del-history":"_del-history_64pb0_38",historyContent:pe,bar:he};function ve(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!w(e)}const[Le]=y("search-component-recent-history"),fe=d({name:Le,props:me,emits:["clearItem","clearAll","barClick"],setup(e,{emit:a,attrs:o}){const{t:r}=v();return()=>t(q,null,[e.historyData.length>0&&t("div",H({class:u.historyBox},o),[t("div",{class:u.recentSearch},[t("div",{class:u.history},[t(k,{src:"/lobby_asset/common/web/common/comm_icon_clock.svg"},null),t("span",null,[r("lobby.game.searchHistory")])]),t("div",{class:u["del-history"],onClick:()=>a("clearAll")},[t(k,{src:"/lobby_asset/common/web/common/comm_icon_del.svg"},null),t("span",null,[r("lobby.game.deleteAll")])])]),t("ul",{class:u.historyContent},[e.historyData.map((l,n)=>t("li",{key:n},[t(de,{class:u.bar,onClick:()=>a("barClick",l),onClear:()=>a("clearItem",l)},ve(l)?l:{default:()=>[l]})]))])])])}}),Se={modelValue:{required:!0,type:[Number,String]},gameList:{required:!0,type:Array},gameListLoadType:{type:String},retryLoading:{type:Boolean}},Ce=()=>{const{t:e}=v(),{isCN:a}=V();return{tabBtnList:g(()=>[{key:m.SearchResult,name:a?()=>e("lobby.game.searchResults"):()=>e("lobby.game.search"),img:"/lobby_asset/common/common/_sprite/icon_dtfl_2ss_1.png"},{key:m.Hot,name:a?()=>e("lobby.game.allHot"):()=>e("lobby.game.hot"),img:"/lobby_asset/common/common/_sprite/icon_dtfl_2rm_1.png"},{key:m.Recent,name:a?()=>e("lobby.game.recent"):()=>e("lobby.game.loadingRecent"),img:"/lobby_asset/common/common/_sprite/icon_dtfl_2zj_1.png"},{key:m.Collect,name:a?()=>e("lobby.game.collect"):()=>e("lobby.game.loadingCollect"),img:"/lobby_asset/common/common/_sprite/icon_dtfl_2sc_1.png"}])}},ke={gameList:{required:!0,type:Array},situation:{required:!0,type:[String,Number]},gameListLoadType:{type:String}},Ie={"game-list-design":"_game-list-design_kviur_17"},[xe]=y("game-list-design"),Be=d({name:xe,props:ke,setup(e){const a=g(()=>{const{isIconStyleSquare:o}=z();return o?ne:re});return()=>t(a.value,H(e,{class:Ie["game-list-design"]}),null)}}),Re={active:{type:Boolean},info:{type:Object,required:!0}},He="_title_qyhow_17",qe="_name_qyhow_27",we="_active_qyhow_31",C={title:He,name:qe,active:we},[je]=y("search-component-title"),Ae=d({name:je,props:Re,setup(e){return()=>{var a,o,r;return t("div",{class:C.title},[t(k,{src:(o=(a=e.info)==null?void 0:a.img)!=null?o:""},null),t("div",{class:{[C.name]:!0,[C.active]:e.active}},[(r=e.info)==null?void 0:r.name()])])}}}),b={"tabs-game-list":"_tabs-game-list_1hqlj_17","tabs-game-list-title":"_tabs-game-list-title_1hqlj_25","list-scroll-box":"_list-scroll-box_1hqlj_28","game-list-box":"_game-list-box_1hqlj_31","game-list":"_game-list_1hqlj_31"};function $e(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!w(e)}const[Ne]=y("tabs-game-list"),De=d({name:Ne,props:Se,emits:["update:active","retry"],setup(e,{emit:a}){const{t:o}=v(),{tabBtnList:r}=Ce(),l=g(()=>r.value.map(n=>n.name).join("-"));return()=>{let n;return t(Q,{key:l.value,active:e.modelValue,"onUpdate:active":s=>a("update:active",s),animated:!0,class:b["tabs-game-list"],titleNavClass:b["tabs-game-list-title"],contentScrollable:!0,shrink:!0},$e(n=r.value.map(s=>t(J,{key:s.key,name:s.key,title:()=>t(Ae,{active:s.key===e.modelValue,info:s},null)},{default:()=>t(K,{class:b["list-scroll-box"]},{default:()=>[t(M,{type:e.gameListLoadType,empty:{text:o("lobby.game.empty")},retry:{loading:e.retryLoading},onRetry:()=>a("retry")},{default:()=>[t("div",{class:b["game-list-box"]},[t(Be,{class:b["game-list"],gameList:e.gameList,situation:W.SearchPage},null)])]})]})})))?n:{default:()=>[n]})}}}),_={"pages-search":"_pages-search_abkic_17","search-main":"_search-main_abkic_22","search-bar":"_search-bar_abkic_29","recent-history":"_recent-history_abkic_30","tab-game-list":"_tab-game-list_abkic_33"},[Te]=y("pages-game-search"),Fe=d({name:Te,setup(){const{t:e}=v(),a=I(),{listData:o,activeTabKey:r,setActiveTabKey:l,retryLoading:n,retryFunc:s,getLocalGameListLoadType:p,setLoadingAndFetch:j}=X(),{searchKeywords:i,handleSearchGameListByKeywords:A,setIsForbidUpdateHistory:L}=ie(),f=async()=>{await ee(20);const c=i.value.trim();c&&(r.value!==m.SearchResult&&(r.value=m.SearchResult),j(()=>A(c)))},{onBarClick:$,onClearAll:N,onClearItem:D}=ce(i,f),x=g(()=>(r.value===m.SearchResult&&i.value?a.getFilteredGameList({type:"gameName",matches:i.value}):o.value).filter(U=>U.gameCategoryId!==te.ClubRoom)),T=c=>{l(c),i.value=""},F=g(()=>p(x.value));return Y(()=>{l(B.Hot),i.value=""}),oe(()=>{l(B.Hot),i.value=""}),()=>t(E,{class:_["pages-search"],useScroll:!1},{header:()=>t(Z,null,{default:()=>t(q,null,[e("lobby.game.search")])}),default:()=>t("div",{class:_["search-main"]},[t(le,{class:_["search-bar"],onSearch:()=>{L(!1),f()},onFocus:()=>{L(!1)},onBlur:f,value:i.value,"onUpdate:value":c=>i.value=c},null),t(fe,{class:_["recent-history"],onBarClick:$,onClearAll:()=>{N(),L(!0)},onClearItem:D,historyData:a.searchHistory},null),t(De,{class:_["tab-game-list"],modelValue:r.value,"onUpdate:active":T,gameList:x.value,retryLoading:n.value,onRetry:()=>{var c;return(c=s.value)==null?void 0:c.call(s)},gameListLoadType:F.value},null)])})}}),Xe=Fe;export{Xe as default};
//# sourceMappingURL=SearchIndex.D0eiw5gA.js.map
