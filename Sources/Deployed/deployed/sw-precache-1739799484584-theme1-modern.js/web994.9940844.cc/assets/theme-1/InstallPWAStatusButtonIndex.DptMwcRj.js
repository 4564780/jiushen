import{iD as N,iE as a,aK as A,iF as O,iw as i,iG as m,iH as S,e$ as y,a as B,ix as E,bq as W,af as h,Y as R,I as L,U as G}from"./main.C8q1iJMV.js";import{s as P}from"../vendors/vendor-stable.LD58Pbb3.js";import{r as g,f as w,o as x,l as C,p as r}from"../vendors/vendor-@vue.DNlpgob2.js";const aa=()=>{const e=N(),{installPrompt:t,isPWAInstalled:d}=P(e),o=g(a.NOT_INITIATE),s=w(()=>o.value!==a.NOT_SUPPORT),l=g(0);function c(u,T=1e4){o.value=u;const I=200,b=T/I,f=setInterval(()=>{l.value+=parseInt(String(100/b)),l.value>=100&&(u===a.PREPARING&&(t.value?i.pwaSupport(!0):(o.value=a.NOT_SUPPORT,i.pwaSupport(!1)),(d.value||t.value)&&(o.value=a.INITIATED)),u===a.DOWNLOADING&&(o.value=a.DOWNLOADED,e.setinstallPwaIsSuccess(!0)),l.value=0,clearInterval(f))},I)}function _(u=!1){if(O()){if(o.value===a.NOT_INITIATE){i.pwaLoadProgress(u),c(a.PREPARING,5e3);return}if(o.value===a.INITIATED){m(),i.pwaDownload(),S(()=>{c(a.DOWNLOADING,2e4)});return}o.value===a.DOWNLOADED&&y(window.location.href)}}const{isAndroidThirdBrowserOrApp:D,isPWASupportBrowser:v}=A(),p=()=>{t.value&&(o.value=a.NOT_INITIATE),d.value&&(o.value=a.DOWNLOADED),v||D||(o.value=a.NOT_SUPPORT,i.pwaSupport(!1))};return x(()=>{p()}),{downloadStatus:o,downloadPercentage:l,isPWASupported:s,tryToDownload:_,initPwaInstallView:p}},F={downloadStatus:{type:String,default:a.NOT_INITIATE},tryToDownload:{type:Function,default:()=>{}},downloadPercentage:{type:Number,default:0},showPointer:{type:Boolean,default:!0}},U="_wrapperProgressBar_2bpw4_17",M="_retryIcon_2bpw4_22",k="_badge_2bpw4_28",H="_pointer_2bpw4_42",V="_downloadItem_2bpw4_57",q="_downloading_2bpw4_73",K="_buttonText_2bpw4_78",Y="_progressBar_2bpw4_82",$="_downloaded_2bpw4_94",j="_appImg_2bpw4_105",n={wrapperProgressBar:U,retryIcon:M,badge:k,pointer:H,"pointer-move":"_pointer-move_2bpw4_1",downloadItem:V,downloading:q,buttonText:K,progressBar:Y,downloaded:$,appImg:j},[z]=G("install-pwa-status-button"),J=C({name:z,props:F,setup(e){const{t}=B(),{downloadRewardsAmount:d,isDownloadRewardsOn:o}=P(E()),s=w(()=>[a.PREPARING,a.DOWNLOADING].includes(e.downloadStatus)),l=w(()=>s.value||d.value===0||!o.value?"":W(d.value));return()=>r("div",{class:n.wrapperProgressBar},[r(h,{content:l.value,class:[n.badge],offset:[-1,-4]},{default:()=>[r(R,{type:"primary",class:[n.downloadItem,s.value?n.downloading:"",e.downloadStatus===a.DOWNLOADED?n.downloaded:""],onClick:()=>e.tryToDownload()},{default:()=>[r("span",{class:n.buttonText},[e.downloadStatus===a.NOT_INITIATE&&t("lobby.rightBar.p2aInit"),e.downloadStatus===a.PREPARING&&t("lobby.rightBar.p2aLoadingFile")+e.downloadPercentage+"%",e.downloadStatus===a.INITIATED&&t("lobby.rightBar.p2aLoadedFile"),e.downloadStatus===a.DOWNLOADING&&t("lobby.rightBar.installingSaveShortcutMessage")+e.downloadPercentage+"%",e.downloadStatus===a.DOWNLOADED&&t("lobby.rightBar.installedSaveShortcutMessage")]),s.value&&r("div",{class:n.progressBar,style:{width:e.downloadPercentage+"%"}},null)]}),!s.value&&e.showPointer&&r(L,{class:n.pointer,src:"/lobby_asset/common/web/home/pointer.png"},null)]})])}}),ea=J;export{ea as I,aa as u};
//# sourceMappingURL=InstallPWAStatusButtonIndex.DptMwcRj.js.map
