import{cf as Ye,a as z,bq as x,q as H,jd as L,bQ as b,iW as we,bG as ue,U as ie,D as Ue,ch as Fe,E as Je,b as Ze,iX as Ge,c2 as Xe,iZ as ge,je as $e,bL as Ie,u as he,ca as q,i_ as Ke,bX as xe,t as se,Y as Te,az as ke,a6 as Le,i$ as ye,cs as je,bg as Qe,j0 as _e,jf as Me,a9 as et,aN as tt,j1 as K,jg as nt,fI as at,bM as ot,jh as Re,I as P,cH as R,bV as st,ja as oe,aa as Se,ji as ee,c1 as lt,b$ as rt,jj as ct,n as ut,bW as it,Z as Ne,m as dt,j8 as me,j9 as Pe,j7 as vt}from"./main.C8q1iJMV.js";import{s as Y}from"../vendors/vendor-stable.LD58Pbb3.js";import{R as bt,E as ze}from"./ReceiveCountdownIndex.C4K-6t0P.js";import{P as _t}from"./index.Dc16CbDK.js";import{l as N,t as Oe,f as m,p as e,r as O,C as We,q as mt,w as Ce,o as pt,e as Ve,n as yt,y as Be,z as Ae}from"../vendors/vendor-@vue.DNlpgob2.js";import{d as re,e as wt}from"../vendors/vendor-default.CjiYZF7Q.js";import{a as gt}from"./activeReceiveOne.CY32GsDi.js";import{d as qe}from"../vendors/vendor-lodash.BYdGDldS.js";import{A as ft,S as ht,a as xt}from"../vendors/vendor-swiper.ZXc-sUCV.js";import{P as Tt}from"./PublicIntroductionIndex.bUl03y0X.js";import{a as St}from"./props.DdPRoj_x.js";import{B as Ct}from"../vendors/vendor-bignumber.BRr1dcww.js";import{T as It}from"./index.SS2HDjZq.js";import{c as kt}from"./ShareModule.E_rBOSqh.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"./Progress.BhMcUY2s.js";import"./Table.CBQduS50.js";import"./index.BQg7GMmP.js";const Ot={pageType:{type:Number,require:!1,default:Ye.Normal},activeId:{type:Number,require:!0}},Bt="_progressBox_1c13q_17",At="_progresBoxContent_1c13q_22",te={progressBox:Bt,progresBoxContent:At,"has-progress":"_has-progress_1c13q_26"},[Dt]=H("event-item-new-cut-once-progress"),Et=N({name:Dt,props:{currentAward:{type:Number,default:0},totalAward:{type:Number,default:0},canShowAward:{type:Boolean,default:!1}},setup(t){const{t:a}=z(),{currentAward:u,totalAward:r}=Oe(t),n=m(()=>{const o=+(u.value/r.value*100)||0;return o>0&&o<5?5:o>95&&o<100?95:o}),s=m(()=>(r.value*100-u.value*100)/100);return()=>e("div",{class:te.progressBox},[e("div",{class:{[te.progresBoxContent]:t.canShowAward}},[e("div",{class:{[te.text]:!0,[te["no-undone-amount"]]:s.value===r.value}},[e(_t,{class:te.progress,percent:n.value,text:t.canShowAward?a("lobby.event.newCutOnce.progressingpProgress1",{totalAward:x(r.value||0)}):a("lobby.event.newCutOnce.progressingpProgress2",{undoneAmount:x(s.value||0)})},null)])]),!t.canShowAward&&e("div",{class:te["has-progress"]},[a("lobby.event.newCutOnce.notStartProgress",{totalAward:x(r.value)})])])}}),$t="_receiveBottom_1p78j_17",Mt="_showAward_1p78j_32",Rt="_bigMargin_1p78j_39",Nt="_showProgress_1p78j_43",Pt="_countdown_1p78j_26",zt="_showRecord_1p78j_54",Lt="_expiredTips_1p78j_57",jt="_progress_1p78j_60",J={receiveBottom:$t,"refresh-countdown-box":"_refresh-countdown-box_1p78j_25","countdown-reset":"_countdown-reset_1p78j_26",showAward:Mt,bigMargin:Rt,showProgress:Nt,countdown:Pt,showRecord:zt,expiredTips:Lt,progress:jt},[Wt]=ie("event-item-modes-new-cut-once-receive-bottom"),fe=({type:t,timestamp:a=Fe().getServerTime()*1e3,endTime:u,startTime:r})=>{var i,_,l,v;const{siteInfos:n}=Ue(),s=re(a).utcOffset((i=n==null?void 0:n.timeZone)!=null?i:"");let o;switch(t){case"day":o=re(a).utcOffset((_=n==null?void 0:n.timeZone)!=null?_:"").endOf("day");break;case"week":o=re(a).utcOffset((l=n==null?void 0:n.timeZone)!=null?l:"").day(7).endOf("day");break;case"month":o=re(a).utcOffset((v=n==null?void 0:n.timeZone)!=null?v:"").endOf("month").endOf("day");break;default:throw new Error("Invalid type")}if(o&&o.valueOf()/1e3>u)o=re(u);else if(s&&s.valueOf()/1e3<r)return 0;return o.diff(s,"seconds")},Vt=N({name:Wt,setup(){const{t}=z(),a=Ze(),u=L(),{newCutOnceData:r,subTaskData:n}=Y(u),s=m(()=>{var d;return((d=n.value)==null?void 0:d.receiveStatus)||b.Processing}),o=()=>{a.push({name:Je.RECORDS})},i=m(()=>[b.CanReceive,b.Expired,b.HasReceive,b.Distributed,b.PendingCheck].includes(s.value)),_=m(()=>![b.CanReceive,b.Distributed,b.HasReceive,b.PendingCheck,b.PendingApply,b.Cancel,b.Expired].includes(s.value)),l=m(()=>{var d;return Date.now()/1e3<((d=r.value)==null?void 0:d.startTime)}),v=m(()=>{var d;return Date.now()/1e3>((d=r.value)==null?void 0:d.endTime)}),p=m(()=>{var g,h;const d=(h=(g=n.value)==null?void 0:g.receivePeriodTime)!=null?h:0;return[b.PendingCheck,b.CanReceive].includes(s.value)&&d>0}),f=m(()=>!(s.value===b.CanReceive||s.value===b.PendingCheck)),y=m(()=>{var B,I,A,j,U,G;const d=(I=(B=n.value)==null?void 0:B.receivePeriodTime)!=null?I:0;let g=0;const h=(A=r.value)==null?void 0:A.endTime,C=(j=r.value)==null?void 0:j.startTime;switch((G=(U=r.value)==null?void 0:U.activeData)==null?void 0:G.cycle_type){case we.Day:g=fe({type:"day",endTime:h,startTime:C});break;case we.Week:g=fe({type:"week",endTime:h,startTime:C});break;case we.Month:g=fe({type:"month",endTime:h,startTime:C});break}return f.value?g:Math.abs(new Date().getTime()/1e3-d)}),w=m(()=>!!y.value&&([b.PendingCheck,b.CanReceive,b.Processing].includes(s.value)||!l.value&&!v.value&&p.value)),c=m(()=>{const{currentAwardValue:d=0,canReceive:g}=n.value||{};return!!(d&&g)});return()=>{var d,g,h,C,B,I,A,j;return e("div",{class:{[J.receiveBottom]:!0,[J.showAward]:i.value,[J.showProgress]:_.value,[J.bigMargin]:i.value&&!w.value}},[w.value&&e("span",{class:J.countdown},[e(bt,{textFormatType:c.value?ze.Expired2:ze.Reset,duration:y.value,onComplete:u.refreshNewCutOnceData},null)]),!w.value&&[b.HasReceive,b.Distributed,b.Cancel].includes(s.value)&&e("span",{class:J.showRecord,onClick:o},[t("lobby.event.newCutOnce.gotoRecord")]),!w.value&&s.value===b.Expired&&e("span",{class:J.expiredTips},[t("lobby.event.expiredTip",[ue((g=(d=n.value)==null?void 0:d.receivePeriodTime)!=null?g:0)])]),_.value&&e(Et,{currentAward:(h=n.value)==null?void 0:h.currentAwardValue,totalAward:(I=(B=(C=r.value)==null?void 0:C.activeData)==null?void 0:B.award)!=null?I:0,canShowAward:((j=(A=r.value)==null?void 0:A.activeData)==null?void 0:j.chop_one_knife_id)===0,class:J.progress},null)])}}}),qt="_receiveTop_136hg_17",Ht="_flexBox_136hg_22",Yt="_text_136hg_27",Ut="_againBtn_136hg_48",Ft="_receiveBtn_136hg_54",Jt="_disabled_136hg_63",Zt="_expired_136hg_67",Gt="_forbidContent_136hg_72",ne={receiveTop:qt,flexBox:Ht,text:Yt,againBtn:Ut,receiveBtn:Ft,disabled:Jt,expired:Zt,forbidContent:Gt};function Xt(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!We(t)}const[Kt]=ie("event-item-modes-new-cut-once-top-content"),Qt=N({name:Kt,setup(){const{t}=z(),a=L(),{newCutOnceData:u,againLoading:r,activeData:n,subTaskData:s}=Y(a),o=O(!1),i=m(()=>{var y;return((y=s.value)==null?void 0:y.receiveStatus)||b.Processing}),_=m(()=>!(i.value===b.CanReceive||i.value===b.PendingCheck)),l=m(()=>{const y=i.value?Ge(i.value):t("lobby.event.cutOnce.receive");return Xe(y)}),v=m(()=>[b.CanReceive,b.Expired,b.HasReceive,b.Distributed,b.PendingCheck].includes(i.value)),p=m(()=>{var c,d,g,h,C,B,I,A,j,U,G,le,de,ve,be;if(v.value)return t("lobby.event.cutOnce.awardText",{x:x(n.value.award)});if((c=s.value)!=null&&c.currentAwardValue&&!((d=s.value)!=null&&d.canReceive))return((g=n.value)==null?void 0:g.isShowTotalAWard)===ge.Hide?t("lobby.event.newCutOnce.awardText2",["<span>".concat(x((h=s.value)==null?void 0:h.currentAwardValue),"</span>")]):t("lobby.event.newCutOnce.awardText1",["<span>".concat(x((C=s.value)==null?void 0:C.currentAwardValue),"</span>"),'<span class="max">'.concat(x(n.value.showMaxAWard),"</span>")]);if(((B=n.value)==null?void 0:B.isShowTotalAWard)===ge.Hide&&((I=n.value)==null?void 0:I.award_type)===$e.Hide)return t("lobby.event.cutOnce.awardText1",{x:x(n.value.award)});let y=(j=(A=n.value)==null?void 0:A.showMinAWard)!=null?j:0,w=(G=(U=n.value)==null?void 0:U.showMaxAWard)!=null?G:0;return((le=n.value)==null?void 0:le.isShowTotalAWard)===ge.Hide&&((de=n.value)==null?void 0:de.award_type)===$e.Show&&(y=(ve=n.value)==null?void 0:ve.rand_award_min,w=(be=n.value)==null?void 0:be.rand_award_max),t("lobby.event.cutOnce.bonus",{x:x(y),y:x(w)})}),f=qe(async()=>{var w,c,d,g,h,C,B,I,A;if(o.value||!s.value||i.value===b.Expired)return;if(o.value=!0,await Ie.check({eventData:{...u.value,amount:n.value.award,receiveStatus:(d=(c=(w=u.value)==null?void 0:w.activeData)==null?void 0:c.SubTaskData)==null?void 0:d.receiveStatus,receiveCategory:(C=(h=(g=u.value)==null?void 0:g.activeData)==null?void 0:h.SubTaskData)==null?void 0:C.logCategory,taskCallback:async()=>await he().close("newCutOnce")},checkOptions:{[q.forbidReceive]:!0,[q.receiveType]:!0,[q.task]:!0,[q.largeAmount]:!0,[q.pendingCheck]:!0}})){o.value=!1;return}const y=Ke(n.value);if((B=s.value)!=null&&B.receiveDuration&&y){xe({message:()=>y}),o.value=!1;return}await gt({params:{activeId:(I=u.value)==null?void 0:I.id,receiveId:String((A=s.value)==null?void 0:A.receiveId)},judgeResBefore:()=>{o.value=!1,a.refreshNewCutOnceData()}})},300);return()=>{var w;let y;return e("div",{class:ne.receiveTop},[e(se,{class:ne.text,html:p.value},null),(w=s.value)!=null&&w.isCanAgain?e(Te,{loading:r.value,size:"small",type:"primary",class:{[ne.againBtn]:!0},onClick:a.handleNewCutOnceAgain},Xt(y=t("lobby.event.newCutOnce.again"))?y:{default:()=>[y]}):e(Te,{class:{[ne.receiveBtn]:!0,[ne.disabled]:_.value,[ne.expired]:i.value===b.Expired},disabled:_.value||i.value===b.Expired,size:"small",type:"primary",onClick:f,loading:o.value},{default:()=>[l.value]})])}}}),en="_winning_10e4u_17",tn="_swipperBox_10e4u_21",nn="_swiperSlide_10e4u_24",an="_announceItem_10e4u_34",on="_name_10e4u_41",sn="_content_10e4u_47",ae={winning:en,swipperBox:tn,swiperSlide:nn,announceItem:an,name:on,content:sn},[ln]=H("event-item-new-cut-once-announce"),rn=N({name:ln,setup(){const{t}=z(),a=L(),u=m(()=>{var o,i,_;const n=(o=a.newCutOnceData)==null?void 0:o.startTime;if(n&&Date.now()/1e3<n)return[];const s=String(((i=ke().userInfos)==null?void 0:i.username)||"");return((_=a.newCutOnceAnnounce.find(l=>l.username===s&&a.activeId===l.activeId))==null?void 0:_.list)||[]}),r=O({autoplay:{delay:2e3,disableOnInteraction:!1,stopOnLastSlide:!0},direction:"vertical",loop:!1,roundLengths:!0,initialSlide:0,spaceBetween:0,slidesPerView:"auto",modules:[ft]});return()=>e(je,{class:ae.winning,scrollbarTrigger:"none"},{default:()=>{var n;return[e(Le,{type:(n=u.value)!=null&&n.length?null:"empty",empty:{text:t("lobby.event.luckyWheel.tabs.noData")}},{default:()=>[a.curTab===ye.Announce&&e(ht,mt({class:ae.swipperBox},r.value,{"data-touchmove-allowed":!0}),{default:()=>{var s;return[(s=u.value)==null?void 0:s.map(o=>e(xt,{class:ae.swiperSlide,key:o.nickname+o.prize+o.dateTime},{default:()=>{var i;return[e("div",{class:ae.announceItem},[e("span",{class:ae.name},[o.nickname]),e("div",{class:ae.content},[e(se,{html:t("lobby.event.cutOnce.announcement",{time:ue(o.dateTime,"ymd"),prize:x((i=o==null?void 0:o.prize)!=null?i:0)})},null)])])]}}))]}})]})]}})}}),cn="_list_1gtqe_17",un="_row_1gtqe_21",dn="_time_1gtqe_35",vn="_content_1gtqe_39",bn="_text_1gtqe_42",ce={list:cn,row:un,time:dn,content:vn,text:bn},[_n]=H("event-item-new-cut-once-records"),mn=N({name:_n,setup(){const{t}=z(),a=L(),u=({AmountType:r,Amount:n,Remark:s})=>{var i,_;const o={[_e.FirstAward]:()=>{var p;let l=[];s&&Me(s)&&(l=JSON.parse(s));const v=(p=l[1])!=null?p:0;return v?t("lobby.event.newCutOnce.firstAward",[l[0],"<span>".concat(x(v),"</span>")]):t("lobby.event.newCutOnce.firstAward1",[l[0]])},[_e.SecondAward]:()=>{let l=[];return s&&Me(s)&&(l=JSON.parse(s)),t("lobby.event.newCutOnce.secondAward",[l[0]])},[_e.FinishTask]:()=>t("lobby.event.newCutOnce.finishTask",["<span>".concat(x(n||0),"</span>")]),[_e.GetAward]:()=>t("lobby.event.newCutOnce.getAward",["<span>".concat(x(n||0),"</span>")])};return(_=(i=o[r])==null?void 0:i.call(o))!=null?_:""};return()=>e(Qe,{class:ce.list,emptyText:t("lobby.event.luckyWheel.tabs.noData")},{default:()=>{var r;return[(r=a.newCutOnceRecordList)==null?void 0:r.map(n=>e("div",{class:ce.row,key:n.userIdx+n.CreatedTime},[e("span",{class:ce.time},[ue(n.CreatedTime)]),e("span",{class:ce.content},[e(se,{class:ce.text,html:u(n)},null)])]))]}})}}),pn="_rule_gnwwt_17",yn={rule:pn},[wn]=H("event-item-new-cut-once-rule"),gn=N({name:wn,setup(){const t=L();return()=>e("div",{class:yn.rule},[e(Tt,{eventData:t.newCutOnceData},null)])}}),fn="_tabs_hj338_17",hn={tabs:fn};function xn(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!We(t)}const[Tn]=H("event-item-new-cut-once-tab-list"),Sn=N({name:Tn,setup(){const{t}=z(),a=L(),{newCutOnceData:u,curTab:r}=Y(a);Ce(r,s=>{a.updateCurTab(s)});const n=m(()=>{var s,o,i;return[{label:()=>t("lobby.event.cutOnce.rule"),value:ye.Rule,display:!0,component:()=>e(gn,null,null)},{label:()=>t("lobby.event.cutOnce.winningAnnouncement"),value:ye.Announce,display:(i=(o=(s=u.value)==null?void 0:s.activeData)==null?void 0:o.isShowAnnouncement)!=null?i:!1,component:()=>e(rn,null,null)},{label:()=>t("lobby.event.cutOnce.myRecord"),value:ye.Record,display:!0,component:()=>e(mn,null,null)}].filter(_=>_.display)});return()=>{let s;return e(tt,{shrink:!0,active:r.value,"onUpdate:active":o=>r.value=o,animated:!0,class:[hn.tabs]},xn(s=n.value.map(o=>e(et,{key:o.value,name:o.value,title:()=>{var i;return e("span",{style:{fontSize:".24rem"}},[(i=o.label)==null?void 0:i.call(o)])}},{default:o.component})))?s:{default:()=>[s]})}}}),Cn=()=>{const t=L(),a=O(!1),{activeData:u,turntableAwardList:r,activeId:n,rotateIdxs:s}=Y(t),o=O(void 0),i=O(0),_=360*5,l=O(!1),v=O(0),p=O(!1),f=O(!1),y=O(0),w=O(null),c=O(K.Default),d=O(null),g=O(null),h=O(null),C=O(!1),B=300,I=6,A=(k=!1)=>{a.value=k},j=(k,$)=>{let D;try{const M=new Uint32Array(1);window.crypto.getRandomValues(M),D=M[0]/4294967296}catch(M){D=Ct.random()}return D*($-k)+k},U=k=>{if(k.length===0){h.value&&(clearTimeout(h.value),f.value=!1),f.value=!0,h.value=setTimeout(()=>{G()},680);return}const $=k.shift();y.value=$,g.value=setTimeout(()=>{U(k)},B/I)},G=async()=>{await t.refreshNewCutOnceData(),p.value=!1,f.value=!1};Ce(p,k=>{var $,D;if(k){const M=[($=u.value)==null?void 0:$.award,v.value];for(;M.length<=I;){const W=j(v.value,(D=u.value)==null?void 0:D.award);M.find(Q=>Q===W)||M.push(W)}g.value&&clearTimeout(g.value);const F=M.sort((W,Q)=>Q-W);U(F)}});const le=k=>{var W,Q,Ee;const $=(W=r.value)==null?void 0:W.findIndex(He=>+He.index==+k),D=(Ee=(Q=r.value)==null?void 0:Q.length)!=null?Ee:0,M=D?360/D:0,F=$*M;return o.value=$,360-F},de=()=>{d.value&&clearTimeout(d.value)},ve=()=>{c.value=K.Spining,d.value=setTimeout(()=>{l.value=!0,c.value=K.Winning,p.value=!0,t.updateJinBiSpinning(!0),d.value=setTimeout(()=>{a.value=!1,c.value=K.Default},1e3)},5e3)},be=async k=>{de(),a.value=!0;const[$,D]=await wt(nt(n.value));if($){await Ie.checkRes({config:{err:$,userRestrictCallback:()=>at.closeDialog(k)},checkOptions:{[ot.userRestrict]:!0}}),t.refreshNewCutOnceData(),a.value=!1;return}const M=le(D.SubTaskData.index),F=Math.floor(i.value/_);l.value=!1,i.value=(F+1)*_+M,v.value=D.amount,w.value=D.SubTaskData.NextTaskListItemInfo,t.updateRotateIdxs(D.SubTaskData.index),ve()},De=()=>{var M;if(!n.value)return;let k=0;const $=(M=s.value)==null?void 0:M.find(F=>{var W;return String(F.username)===String((W=ke().userInfos)==null?void 0:W.username)&&n.value===F.activeId});s.value&&$&&(k=$.rotateDegIdx);const D=le(k);i.value=D,yt(()=>{C.value=!0})};return Ce(n,()=>{De()}),pt(()=>{De()}),Ve(()=>{d.value&&clearTimeout(d.value),g.value&&clearTimeout(g.value),h.value&&clearTimeout(h.value)}),{spinning:a,amountScale:f,showAmount:y,borderType:c,nextTaskListItemInfo:w,rotatePosition:i,winningIndex:o,amountAnimate:p,turntableBgTransition:C,setSpinning:A,runLottery:be}},In="_awardItem_yksu2_17",kn="_firstAward_yksu2_29",On="_center_yksu2_38",Bn="_text_yksu2_45",An="_icon_yksu2_58",Dn="_turntableStyle1_yksu2_65",En="_turntableStyle2_yksu2_69",$n="_turntableStyle3_yksu2_73",Mn="_turntableStyle4_yksu2_77",Rn="_turntableStyle5_yksu2_81",Nn="_turntableStyle6_yksu2_85",Pn="_turntablePointer_yksu2_93",zn="_winningAnimation_yksu2_104",Ln="_winning_yksu2_104",Z={awardItem:In,firstAward:kn,center:On,text:Bn,icon:An,turntableStyle1:Dn,turntableStyle2:En,turntableStyle3:$n,turntableStyle4:Mn,turntableStyle5:Rn,turntableStyle6:Nn,turntablePointer:Pn,winningAnimation:zn,winning:Ln},[jn]=H("event-item-new-cut-once-award-item"),Wn=N({name:jn,props:{awardItem:{type:Object,default:null},awardIndex:{type:Number,default:0},awardLen:{type:Number,default:0},winning:{type:Boolean,default:!1},winningIndex:{type:Number,default:0},pointerWidth:{type:Number,default:0},pointerHeight:{type:Number,default:0},styleType:{type:Number,default:1}},setup(t){const{t:a}=z(),{awardItem:u,awardIndex:r,awardLen:n,winning:s,winningIndex:o,pointerWidth:i,pointerHeight:_,styleType:l}=Oe(t),v=m(()=>{var f,y,w;let p="";return((f=u.value)==null?void 0:f.awardType)===Re.EAwardTypeConst?p=x((y=u.value)==null?void 0:y.awardValue):((w=u.value)==null?void 0:w.awardType)===Re.EAwardTypeRand?p="?":p=a("lobby.event.bet.unintendedPrize"),p});return()=>{var p,f;return e("div",{class:[Z.awardItem,Z["turntableStyle".concat(l.value)],"turntable-style".concat(n.value)],"data-key":r.value,style:{transform:"rotate(".concat(r.value*(360/n.value),"deg)")}},[e("div",{class:Z.firstAward},[e("div",{class:Z.center},[e("span",{class:[Z.text,"award-item-text"]},[v.value])]),((p=u.value)==null?void 0:p.awardIcon)&&e(P,{class:Z.icon,src:(f=u.value)==null?void 0:f.awardIcon},null)]),s.value&&o.value===r.value&&e(P,{class:{[Z.turntablePointer]:!0,[Z.winningAnimation]:s},style:{transform:"translateX(50%) translateY(-100%) rotate(180deg)"},src:"/lobby_asset/common/common/event/kyd_style_".concat(l.value,"_zp_x").concat(n.value,".png"),width:R(i.value),height:R(_.value),tag:"div"},null)])}}}),Vn="_turntableBtn_2lg0c_17",qn="_amountWrapper_2lg0c_26",Hn="_amountScale_2lg0c_32",Yn="_drawsWrapper_2lg0c_35",Un="_text1_2lg0c_43",Fn="_text2_2lg0c_46",Jn="_turntableStyle1_2lg0c_61",Zn="_turntableStyle2_2lg0c_68",Gn="_turntableStyle3_2lg0c_78",Xn="_turntableStyle4_2lg0c_85",Kn="_turntableStyle5_2lg0c_92",Qn="_turntableStyle6_2lg0c_99",X={turntableBtn:Vn,amountWrapper:qn,amountScale:Hn,drawsWrapper:Yn,text1:Un,text2:Fn,turntableStyle1:Jn,turntableStyle2:Zn,turntableStyle3:Gn,turntableStyle4:Xn,turntableStyle5:Kn,turntableStyle6:Qn},[ea]=ie("event-item-modes-new-cut-once-lottery"),ta=N({name:ea,props:{options:{type:Object,default:()=>{}},styleType:{type:Number,default:1},lottery:{type:Object,default:()=>{}}},setup(t){const{t:a}=z(),u=L(),{newCutOnceData:r,cutOnceTurnCount:n}=Y(u),s=m(()=>t.lottery.spinning.value||!n.value),o=m(()=>{var l;return Date.now()/1e3<((l=r.value)==null?void 0:l.startTime)}),i=m(()=>{var l;return Date.now()/1e3>((l=r.value)==null?void 0:l.endTime)}),_=qe(async()=>{if(!ke().hasLogined){await st().openLoginRegister({openType:"insert"}),he().close("newCutOnce");return}if(!(t.lottery.spinning.value||!n.value)){if(t.lottery.setSpinning(!0),await Ie.check({eventData:{...r.value,taskCallback:async()=>await he().close("newCutOnce")},checkOptions:{[q.isDemoLogin]:!0,[q.forbidReceive]:!0,[q.receiveType]:!0,[q.task]:!0}})){t.lottery.setSpinning();return}if(o.value){xe({message:a("lobby.event.discountCode.activityNotStarted")}),t.lottery.setSpinning();return}if(i.value){xe({message:a("lobby.event.discountCode.activityHasEnded")}),t.lottery.setSpinning();return}t.lottery.runLottery()}},300);return()=>e(P,{class:[X.turntableBtn,X["turntableStyle".concat(t.styleType)]],src:oe[t.styleType].btn,width:R(t.options.btnSize),height:R(t.options.btnSize),tag:"div",style:{cursor:s.value?"not-allowed":"pointer"}},{default:()=>{var l;return[t.lottery.amountAnimate.value?e("div",{class:{[X.amountWrapper]:!0,[X.amountScale]:t.lottery.amountScale.value}},[x(t.lottery.showAmount.value)]):e("div",{class:X.drawsWrapper,onClick:_},[e("span",{class:X.text1},[a("lobby.event.cutOnce.lottery")]),e(se,{class:X.text2,html:(l=a("lobby.event.cutOnce.drawsNumber"))==null?void 0:l.replace("<span></span>"," <span>".concat(n.value||0,"</span> "))},null)])]}})}}),na="_detailInfo_1y1p0_17",aa="_row_1y1p0_17",oa="_label_1y1p0_20",sa="_value_1y1p0_26",la="_isEfficientYes_1y1p0_31",ra="_isEfficientNo_1y1p0_34",E={detailInfo:na,row:aa,label:oa,value:sa,isEfficientYes:la,isEfficientNo:ra},[ca]=H("event-item-cut-once-detail-modal"),ua=N({name:ca,props:{nextTaskListItemInfo:{type:Object,default:null},record:{type:Object,default:null}},setup(t){const{t:a}=z(),u=m(()=>{const r=[];if(!t.nextTaskListItemInfo)return r;const{reChargeValue:n,daMaValue:s,promotionCount:o}=t.nextTaskListItemInfo;return+n!=0&&r.push(t.record?a("lobby.event.cutOnce.detailInfoText4",{x:x(t.record.rechargeCount||0)}):a("lobby.event.newCutOnce.nextTaskRechargeCountTip",[x(n||0)])),+s!=0&&r.push(t.record?a("lobby.event.cutOnce.detailInfoText7",{n:x(t.record.daMaCount||0)}):a("lobby.event.newCutOnce.nextTaskBetCountTip",[x(s||0)])),+o!=0&&r.length==0&&r.push(t.record?a("lobby.event.cutOnce.detailText4"):a("lobby.event.newCutOnce.nextTaskRechargeCountTip1")),r});return()=>{var r,n,s,o,i,_;return e("div",{class:E.detailInfo},[e("div",{class:E.row},[e("span",{class:E.label},[a("lobby.event.cutOnce.userAccount"),":"]),e("span",{class:E.value},[(r=t.record)==null?void 0:r.userName])]),e("div",{class:E.row},[e("span",{class:E.label},[a("lobby.event.cutOnce.createTime"),":"]),e("span",{class:E.value},[ue((n=t.record)==null?void 0:n.registerTime,"ymdhms")])]),e("div",{class:E.row},[e("span",{class:E.label},[a("lobby.event.promote.isItEffective"),":"]),e("span",{class:[E.value,(s=t.record)!=null&&s.isEfficient?E.isEfficientYes:E.isEfficientNo]},[(o=t.record)!=null&&o.isEfficient?a("lobby.event.promote.yes"):a("lobby.event.promote.no")])]),e("div",{class:E.row},[e("span",{class:E.label},[a("lobby.event.cutOnce.detailInfo"),":"]),e("span",{class:[E.value,(i=t.record)!=null&&i.isEfficient?E.isEfficientYes:""]},[(_=u.value)==null?void 0:_.map((l,v)=>[l,v<u.value.length-1?" , ":""])])])])}}}),ia="_detailModal_1mph5_17",da="_section_1mph5_21",va="_title_1mph5_27",ba="_text_1mph5_35",_a="_detailText_1mph5_40",ma="_wrap_1mph5_43",pa="_table_1mph5_47",ya="_lookoverText_1mph5_61",wa="_isEfficientYes_1mph5_67",ga="_isEfficientNo_1mph5_71",fa="_guiding_1mph5_86",ha="_isPutAway_1mph5_92",xa="_icon2_1mph5_99",S={detailModal:ia,section:da,title:va,text:ba,detailText:_a,wrap:ma,table:pa,"table-more":"_table-more_1mph5_57",lookoverText:ya,isEfficientYes:wa,isEfficientNo:ga,"detail-btn":"_detail-btn_1mph5_75",guiding:fa,isPutAway:ha,icon2:xa},[Ta]=H("event-item-cut-once-detail-modal"),Sa=N({name:Ta,props:{nextTaskListItemInfo:{type:Object,default:null}},setup(t){const{t:a}=z(),u=L(),{subTaskData:r}=Y(u),n=O(!1),s=l=>{Se.showDialog({title:()=>a("lobby.event.cutOnce.detail"),showCloseButton:!0,showConfirmButton:!1,message:()=>e(ua,{record:l,nextTaskListItemInfo:t.nextTaskListItemInfo},null)})},o=m(()=>[{title:a("lobby.event.cutOnce.userAccount"),dataIndex:"userName",key:"userName",align:"center",width:150,customRender:l=>e("span",{class:S.wrap},[l])},{title:a("lobby.event.cutOnce.createTime"),dataIndex:"registerTime",key:"registerTime",align:"center",width:150,customRender:l=>e("span",{class:S.wrap},[ue(Number(l),"ymdhms")])},{title:a("lobby.event.promote.isItEffective"),dataIndex:"isEfficient",key:"isEfficient",align:"center",customRender:l=>e("span",{class:l?S.isEfficientYes:S.isEfficientNo},[a(l?"lobby.event.promote.yes":"lobby.event.promote.no")])},{title:a("lobby.event.cutOnce.detail"),dataIndex:"detail",key:"detail",align:"center",customRender:(l,v)=>e("span",{class:S.lookoverText,onClick:()=>s(v)},[a("lobby.event.cutOnce.lookover")])}]),i=()=>{n.value=!n.value},_=()=>{var v;const l=(v=r.value)==null?void 0:v.Data;return e("section",{class:S.section},[e("h3",{class:S.title},["2、",a("lobby.event.cutOnce.detailTitle3")]),e(It,{class:[S.table,n.value?S["table-more"]:""],columns:o.value,uniqueKey:"useridx",data:l!=null?l:[],list:{emptyText:a("lobby.event.luckyWheel.tabs.noData")}},null),Be(e("div",{class:S["detail-btn"],onClick:i},[n.value?a("lobby.modal.pay.putAway"):a("lobby.event.cutOnce.more"),e("div",{class:{[S.guiding]:!0,[S.isPutAway]:n.value}},[e(P,{class:S.icon1,src:"/lobby_asset/common/web/common/img_scroll_jt.svg"},null),e(P,{class:S.icon2,src:"/lobby_asset/common/web/common/img_scroll_jt.svg"},null)])]),[[Ae,(l==null?void 0:l.length)>6]])])};return()=>{var l,v,p,f;return e("div",{class:S.detailModal},[e("section",{class:S.section},[e("h3",{class:S.title},["1、",a("lobby.event.cutOnce.detailTitle2")]),e("p",{class:S.text},[+((l=t.nextTaskListItemInfo)==null?void 0:l.reChargeValue)==0&&+((v=t.nextTaskListItemInfo)==null?void 0:v.daMaValue)==0?a("lobby.event.cutOnce.detailText4"):""]),e("p",{class:S.text},[+((p=t.nextTaskListItemInfo)==null?void 0:p.reChargeValue)!=0?a("lobby.event.newCutOnce.nextTaskRechargeCountTip",[x(t.nextTaskListItemInfo.reChargeValue||0)]):""]),e("p",{class:S.text},[+((f=t.nextTaskListItemInfo)==null?void 0:f.daMaValue)!=0?a("lobby.event.newCutOnce.nextTaskBetCountTip",[x(t.nextTaskListItemInfo.daMaValue||0)]):""])]),_()])}}}),Ca="_cardBox_1azla_17",Ia="_card_1azla_17",ka="_content_1azla_27",Oa="_top_1azla_17",Ba="_title_1azla_36",Aa="_text_1azla_43",Da="_shareBtn_1azla_49",Ea="_shareIcon_1azla_65",$a="_shareText_1azla_68",Ma="_bottom_1azla_81",Ra="_subText_1azla_88",Na="_refreshIcon_1azla_99",Pa="_promoteSharingModal_1azla_119",za="_promoteSharingModalContent_1azla_128",La="_subModal_1azla_140",ja="_section_1azla_143",Wa="_isEfficientYes_1azla_164",Va="_isEfficientNo_1azla_167",qa="_detailTable_1azla_170",Ha="_wrap_1azla_173",Ya="_lookoverText_1azla_176",Ua="_subInfoDedailModal_1azla_180",Fa="_detailInfo_1azla_180",Ja="_row_1azla_180",Za="_label_1azla_184",Ga="_value_1azla_190",Xa="_promoteShareBox_1azla_202",Ka="_promoteShareModalContent_1azla_215",Qa="_detailModal_1azla_227",eo="_promoteBox_1azla_231",T={cardBox:Ca,"top-bg":"_top-bg_1azla_17",card:Ia,content:ka,top:Oa,title:Ba,text:Aa,shareBtn:Da,shareIcon:Ea,shareText:$a,bottom:Ma,"bottom-text":"_bottom-text_1azla_85",subText:Ra,refreshIcon:Na,"bottom-bg":"_bottom-bg_1azla_112",promoteSharingModal:Pa,promoteSharingModalContent:za,subModal:La,section:ja,isEfficientYes:Wa,isEfficientNo:Va,detailTable:qa,wrap:Ha,lookoverText:Ya,subInfoDedailModal:Ua,detailInfo:Fa,row:Ja,label:Za,value:Ga,promoteShareBox:Xa,promoteShareModalContent:Ka,detailModal:Qa,promoteBox:eo},[to]=H("event-item-new-cut-once-tips-card"),no=N({name:to,props:{nextTaskListItemInfo:{type:Object,default:null}},setup(t){const{t:a}=z(),u=L(),{activeData:r,subTaskData:n}=Y(u),{nextTaskListItemInfo:s}=Oe(t),o=m(()=>{var c,d;return s.value||((d=(c=r.value)==null?void 0:c.SubTaskData)==null?void 0:d.NextTaskListItemInfo)}),i=m(()=>{var c,d;return((c=n.value)==null?void 0:c.receiveStatus)!==b.Processing||!!((d=n.value)!=null&&d.isCanAgain)}),_=m(()=>{var c;return((c=o.value)==null?void 0:c.conditionType)===ee.SubUser}),l=m(()=>{const c=o.value;return{subLogin:+(c==null?void 0:c.reChargeValue)==0&&+(c==null?void 0:c.daMaValue)==0,subDeposit:+(c==null?void 0:c.reChargeValue)!=0,subBet:+(c==null?void 0:c.daMaValue)!=0}}),v=()=>{Se.showDialog({width:R(690),className:T.detailModal,showCloseButton:!0,showConfirmButton:!1,message:()=>e(Sa,{nextTaskListItemInfo:o.value},null)})},p=()=>{u.refreshNewCutOnceData()},f=()=>{Se.showDialog({className:T.promoteShareBox,width:R(690),message:()=>e("div",{class:T.promoteShareModalContent},[e("h3",null,[a("lobby.event.cutOnce.detailTitle4")]),e(kt,{class:T.promoteBox},null)]),showConfirmButton:!1,showCloseButton:!0})},y=m(()=>{var d;return{[ee.SubUser]:{text:()=>{var g;return a("lobby.event.newCutOnce.cardTipsTitle",[((g=o.value)==null?void 0:g.promotionCount)||0,1])},callback:f},[ee.OnceLoginApp]:{text:()=>a("lobby.event.newCutOnce.downloadApp",{n:1}),callback:lt},[ee.OnceBindPhone]:{text:()=>a("lobby.event.newCutOnce.bindMobile",{n:1}),callback:rt},[ee.OnceBindEmail]:{text:()=>a("lobby.event.newCutOnce.bindMail",{n:1}),callback:ct},[ee.OnceBindWithdraw]:{text:()=>a("lobby.event.newCutOnce.bindWithdrawType",{n:1}),callback:()=>ut(it.ACCOUNT_MANAGEMENT)}}[(d=o.value)==null?void 0:d.conditionType]}),w=c=>{const{language:d}=dt();return["zh","zh_hk"].includes(d)?c:(c==null?void 0:c.charAt(c.length-1))!==","?c+" ,":(c==null?void 0:c.charAt(c.length-1))===","?c.slice(0,-1)+" ,":c};return()=>e("div",{class:T.cardBox},[e(P,{class:T["top-bg"],src:"/lobby_asset/common/common/event/kyd_common_qp_1.png",width:R(538)},null),e(P,{class:T.card,src:"/lobby_asset/common/common/event/kyd_common_qp_2.png",width:R(538),tag:"div"},{default:()=>{var c,d,g,h,C,B,I,A;return[e("div",{class:T.content},[e("div",{class:T.top},[e("div",{class:T.title},[e(se,{class:T.text,tag:"span",html:((d=(c=y.value)==null?void 0:c.text)==null?void 0:d.call(c))||""},null),!_.value&&e(Ne,{type:"icon",icon:"/lobby_asset/{layout}-{bg}-common/web/common/comm_icon_sx.svg",loading:u.isItemLoading,class:T.refreshIcon,onRetry:p},null)]),e(Te,{class:{[T.shareBtn]:!0,[T["share-btn-primary"]]:i.value},type:"primary",onClick:y.value.callback,disabled:i.value},{default:()=>[Be(e("span",{class:T.shareIcon},[e(P,{src:"/lobby_asset/common/web/promotion/icon_tg_share.svg"},null)]),[[Ae,_.value]]),_.value?a("lobby.event.newCutOnce.shareText"):a("lobby.event.newCutOnce.go")]})]),_.value&&e("div",{class:T.bottom},[e("div",{class:T["bottom-text"]},[e("span",{class:T.subText},[((g=l.value)==null?void 0:g.subLogin)&&w(a("lobby.event.newCutOnce.subLogin")),((h=l.value)==null?void 0:h.subDeposit)&&w(a("lobby.event.newCutOnce.subDeposit",{a:(C=o.value)==null?void 0:C.reChargeValue})),((B=l.value)==null?void 0:B.subBet)&&w(a("lobby.event.newCutOnce.subBet",{a:(I=o.value)==null?void 0:I.daMaValue}))]),e(se,{class:T.subText,tag:"span",html:a("lobby.event.newCutOnce.currentValid",{p:"<span>".concat((A=n.value)==null?void 0:A.subNumber,"</span>")}),onClick:v},null),e(Ne,{type:"icon",icon:"/lobby_asset/common/web/common/comm_icon_sx2.svg",loading:u.isItemLoading,class:T.refreshIcon,onRetry:p},null)])])])]}}),e(P,{class:T["bottom-bg"],src:"/lobby_asset/common/common/event/kyd_common_qp_2.png",width:R(538),tag:"div"},null)])}}),ao="_turntableBox_1bv56_17",oo="_isShowTipsCard_1bv56_28",so="_turntableBoxStyle4_1bv56_32",lo="_turntableBoxStyle3_1bv56_39",ro="_turntable_1bv56_17",co="_turntableBorder_1bv56_39",uo="_baseBottom_1bv56_56",io="_turntableBg_1bv56_63",vo="_turntableBgTransition_1bv56_69",bo="_tipsCard_1bv56_72",V={turntableBox:ao,isShowTipsCard:oo,turntableBoxStyle4:so,"turntable-style-4":"_turntable-style-4_1bv56_36","award-portfolio-list-10":"_award-portfolio-list-10_1bv56_36","turntable-pointer":"_turntable-pointer_1bv56_36",turntableBoxStyle3:lo,turntable:ro,turntableBorder:co,baseBottom:uo,turntableBg:io,turntableBgTransition:vo,tipsCard:bo},[_o]=ie("event-item-modes-new-cut-once-turntable"),mo=N({name:_o,props:St,setup(){const t=L(),{newCutOnceData:a,isShowTipsCard:u,turntableAwardList:r}=Y(t),n=Cn(),s=m(()=>{var v;const l=(v=a.value)==null?void 0:v.activeData;return Number(l==null?void 0:l.display_type)}),o=m(()=>{var l;return(l=r.value)==null?void 0:l.length}),i=m(()=>{let l=0,v=0;s.value&&(l=oe[s.value].bgSize,v=oe[s.value].btnSize);let p,f;try{p=me[o.value].width,f=me[o.value].height}catch(y){console.warn(y),p=me[Pe.equal0].width,f=me[Pe.equal0].height}return{bgSize:l,btnSize:v,pointerWidth:p,pointerHeight:f}}),_=m(()=>{if(!oe[s.value])return[];const{borderAnim1:l,borderAnim2:v,borderAnim3:p}=oe[s.value];return[{borderAnim:l,borderType:K.Default},{borderAnim:v,borderType:K.Spining},{borderAnim:p,borderType:K.Winning}]});return()=>{var f,y;const{bgSize:l,pointerWidth:v,pointerHeight:p}=i.value;return e("div",{class:[V.turntableBox,V["turntableBoxStyle".concat(s.value)],u.value?V.isShowTipsCard:"","turntableBoxStyle".concat(s.value)]},[!!o.value&&e("div",{class:[V.turntable,"turntable-style-".concat(s.value," award-portfolio-list-").concat(o.value)]},[(f=_.value)==null?void 0:f.map(w=>Be(e(P,{class:V.turntableBorder,lazy:!1,width:R(l),height:R(l),key:w.borderAnim,src:w.borderAnim},null),[[Ae,n.borderType.value===w.borderType]])),s.value===vt.Style4&&e(P,{class:V.baseBottom,src:oe[s.value].baseBottom,width:R(199),height:R(68)},null),e(P,{class:{[V.turntableBg]:!0,[V.turntableBgTransition]:n.turntableBgTransition.value},style:{transform:"rotate(".concat(n.rotatePosition.value,"deg)")},src:"/lobby_asset/common/common/event/kyd_style_".concat(s.value,"_zp_").concat(o.value,".png"),width:R(l),height:R(l),"data-rotate-index":((y=n.winningIndex)==null?void 0:y.value)||0,tag:"div"},{default:()=>{var w;return[(w=r.value)==null?void 0:w.map((c,d)=>e(Wn,{pointerWidth:v,pointerHeight:p,awardItem:c,awardIndex:d,styleType:s.value,awardLen:o.value},null))]}}),e(ta,{options:i.value,styleType:s.value,lottery:n},null),u.value&&e(no,{class:V.tipsCard,nextTaskListItemInfo:n.nextTaskListItemInfo.value},null)])])}}}),po="_turntableMain_dh5pa_23",yo="_receiveBox_dh5pa_28",pe={"new-cut-once-placeholder":"_new-cut-once-placeholder_dh5pa_17",turntableMain:po,receiveBox:yo,"spine-event-kyd":"_spine-event-kyd_dh5pa_52"},[wo]=ie("event-item-modes-new-cut-once"),Lo=N({name:wo,props:Ot,setup(t){const{t:a}=z(),u=L(),{eventItemData:r,isItemLoading:n,itemErr:s}=Y(u),o=m(()=>n.value&&!r.value?"loading":s.value?"retry":null),i=async()=>{t.activeId&&u.refreshEventItemDetail(t.activeId)};return Ve(()=>{u.resetEventItemData(),u.resetNewCutOnceData()}),()=>e(Le,{class:[pe["new-cut-once-placeholder"]],type:o.value,empty:{text:a("lobby.event.luckyWheel.tabs.noData")},onRetry:i},{default:()=>[e("div",{class:pe.turntableMain},[e("div",{class:pe.receiveBox},[e(Qt,null,null),e(Vt,null,null)]),e(je,null,{default:()=>[e(mo,null,null),e(Sn,null,null)]}),u.jinBiSpinning&&e(P,{class:pe["spine-event-kyd"],src:"/lobby_asset/common/web/animated/apng_event_kyd_spine_event_kyd_JinBiFei.png",ref:"jinBiFeiRef",canvasMode:{numPlays:1,onEnd:()=>{u.updateJinBiSpinning(!1)}}},null)])]})}});export{Lo as default};
//# sourceMappingURL=NewCutOnceIndex.Dn2e_h09.js.map
