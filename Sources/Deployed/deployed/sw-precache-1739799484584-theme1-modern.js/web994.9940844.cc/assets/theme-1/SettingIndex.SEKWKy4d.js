import{az as M,a as E,af as S,cH as b,I as i,cN as De,dM as Fe,eM as ae,E as Te,b as Ie,fd as Ae,aC as ne,cj as Oe,m as Ue,D as Ee,cl as U,a4 as _,ac as Ne,fe as Pe,a0 as w,ff as Le,fg as We,cm as X,W as Re,w as Y,fh as Ve,s as je,aE as Ye,B as He,v as Me,q as qe}from"./main.C8q1iJMV.js";import{u as oe}from"./useSettingForm.C_htFHpH.js";import{D as $e,d as H,e as Ge}from"../vendors/vendor-default.CjiYZF7Q.js";import{s as ze,o as Ke}from"../vendors/vendor-stable.LD58Pbb3.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import{D as Ze}from"./index.CnQRgKzx.js";import{V as Je}from"./VipBadgeIndex.BtyzvgLV.js";import{l as q,p as e,v as se,r as x,f as Qe,o as re,w as Xe,F as B,C as et}from"../vendors/vendor-@vue.DNlpgob2.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";const tt="_avatarArea_rtbp2_17",at="_label_rtbp2_24",nt="_avatar_rtbp2_17",ot="_vipWrap_rtbp2_49",st="_settingVipBadge_rtbp2_56",rt="_actionArea_rtbp2_82",lt="_action_rtbp2_82",it="_wrapItem_rtbp2_93",ct="_username_rtbp2_98",ut="_platformbox_rtbp2_102",pt="_platfromid_rtbp2_105",dt="_copyIcon_rtbp2_108",mt="_webCopyIcon_rtbp2_118",p={avatarArea:tt,label:at,avatar:nt,vipWrap:ot,settingVipBadge:st,actionArea:rt,action:lt,wrapItem:it,username:ct,platformbox:ut,platfromid:pt,copyIcon:dt,webCopyIcon:mt},[bt]=ae("topUserInfo"),ee=110,_t=q({name:bt,props:{reward:{type:String,default:""}},setup(c){const{userInfos:n}=M(),g=Ie(),d=()=>{g.push({name:Te.UPDATE_AVATOR})};return()=>{var k,C;const{t:f}=E();return e("div",{class:p.avatarArea},[(n==null?void 0:n.portrait_id)&&e("div",{class:p.avatar,onClick:d},[e(S,{content:c.reward,offset:[0,b(-3)]},{default:()=>{var D;return[e(i,{src:(D=n==null?void 0:n.portrait_id)!=null?D:"",style:{width:b(ee),height:b(ee)},useSkeleton:!0},null)]}}),(n==null?void 0:n.vip_status)===De.OPEN&&e("div",{class:p.vipWrap},[e(Je,{class:p.settingVipBadge},null)])]),e("div",{class:p.actionArea},[e("div",{class:p.action,onClick:d},[f("lobby.center.setting.setting")]),e("div",{class:p.platformbox},[se("ID:"),e("span",{class:p.platfromid},[(k=n==null?void 0:n.username)!=null?k:""]),e(Fe,{class:p.copyIcon,text:(C=n==null?void 0:n.username)==null?void 0:C.toString()},null)])])])}}}),gt="_popover_1erix_17",ft="_settingH5Form_1erix_21",vt="_baseWrapper_1erix_29",yt="_input_1erix_49",ht="_selectImage_1erix_53",wt="_disabled_1erix_57",xt="_rotated_1erix_72",St="_badgeBox_1erix_75",Bt="_bindBtn_1erix_81",kt="_birthdayFakeShow_1erix_85",Ct="_birthdayIcon_1erix_96",Dt="_placeholder_1erix_107",Ft="_title_1erix_114",Tt="_btnArea_1erix_119",It="_btn_1erix_119",At="_btn2_1erix_140",Ot="_ageLimitTip_1erix_153",Ut="_backContent_1erix_164",a={popover:gt,settingH5Form:ft,baseWrapper:vt,"defult-container":"_defult-container_1erix_43","defult-info":"_defult-info_1erix_43",input:yt,selectImage:ht,disabled:wt,"sort-icon":"_sort-icon_1erix_68",rotated:xt,badgeBox:St,bindBtn:Bt,birthdayFakeShow:kt,birthdayIcon:Ct,placeholder:Dt,title:Ft,btnArea:Tt,btn:It,btn2:At,ageLimitTip:Ot,backContent:Ut,"popup-date-picker":"_popup-date-picker_1erix_171"};function te(c){return typeof c=="function"||Object.prototype.toString.call(c)==="[object Object]"&&!et(c)}const[Et]=ae("pages-setting-coomponents-settingForm"),Nt=q({name:Et,setup(){var Z,J,Q;const c=x(),{form:n,sourceForm:g,isSetBirthday:d,fields:f,isOpePhone:k,isOpenEmail:C,isOpenRegisterTime:D,checkBirthday:le,updateForm:N,handleGoToPhone:ie,handleGoToEmail:ce,focusForm:ue,changeForm:pe,cipFormText:de,isShowCompelte:me,isShowClear:$,clearChangeForm:G,inputValidator:be,back:_e,getDirtyFormValues:ge}=oe(),{getShowName:fe,getOptionsActions:ve,getSelectedItem:z}=Ae(),F=ne(),{userInfos:u}=M(),{rewards:v,showBadge:y}=Oe(),{vipInfos:T}=ze(F),{t:l}=E(),{isCN:P}=Ue(),{validate:ye}=$e(),h=x(!1),L=x([2e3,1,1]),I=x(!1),he=()=>n.value.birthday===""?e("span",{class:a.placeholder},[l("lobby.center.setting.birthdayInputPlaceholder")]):e("span",null,[H(n.value.birthday).format(l("lobby.center.setting.timeFormat"))]),we=({selectedValues:o=[]})=>{const s=[...o];P||s.reverse();const t=s.join("-");le(t)&&(n.value.birthday=t,h.value=!1)},K=Qe(()=>{const o=T.value||{},s=g.value||{};return!!(f.some(({name:t})=>o[t]!==s[t])||n.value.account&&n.value.account!==fe.value()||n.value.birthday&&n.value.birthday!==(o==null?void 0:o.birthday))}),xe=(o,s)=>{var m;const t=ge(s||{},f.map(j=>j.name));o.birthday!==(s==null?void 0:s.birthday)&&o.birthday&&(t.birthday=H(o.birthday).format("YYYY-MM-DD"));const r=(m=ve.value().find(j=>j.text===o.account))==null?void 0:m.key;return t.mineDisplayOptions=r,t.registerTime=s==null?void 0:s.registerTime,t},Se=async(o,s)=>{await Ye.setCacheExpired("/user/vip");const t=["registerTime","time"],r={...s};Object.keys(o).forEach(m=>{!t.includes(m)&&o[m]&&(r[m]=o[m])}),M().updateUserInfos({mineDisplayOptions:o.mineDisplayOptions}),F.setUserVipInfosForm(r),N()},Be=async()=>{if(!K.value){Y({type:"warn",message:l("lobby.center.setting.noChangeToast")});return}const o=await ye();if(!(o!=null&&o.valid))return;const s=xe(n.value,T.value),[t,r]=await Ge(Ve(s));if(t){console.error("update user info error:",t);return}if(await Se(s,T.value),(r==null?void 0:r.data.code)===1305){Y({type:"warn",message:l("lobby.center.setting.birthdayError")}),await F.getVipInfos(),N();return}Y({type:"success",message:l("lobby.center.setting.success")})};re(async()=>{await F.getVipInfos(),P||(L.value=[1,1,2e3]),N()}),Ke((o,s,t)=>{const{t:r}=E();if(!K.value){t();return}je({type:"warning",title:r("lobby.center.setting.goBackConfirm"),messageAlign:"center",message:()=>e("div",{class:a.backContent},[r("lobby.center.setting.remark")]),onConfirm(){t()},onCancel(){t(!1)},showCancelButton:!0,cancelButtonText:r("lobby.center.setting.cancel"),confirmButtonText:r("lobby.common.tips.confirm")})});const{homeLayoutInfos:W}=Ee(),A=((Z=W==null?void 0:W.commonConfig)==null?void 0:Z.ageLimit)||"18",O=new Date,R=new Date;R.setFullYear(O.getFullYear()-parseInt(A)),R.setDate(O.getDate()-1),O.setFullYear(new Date().getFullYear()-A);const ke=H(O).format(l("lobby.center.setting.timeFormat"));Xe(()=>[u==null?void 0:u.mineDisplayOptions],()=>{var o,s;V.value=(s=(o=z.value)==null?void 0:o.icon)!=null?s:""});const V=x((Q=(J=z.value)==null?void 0:J.icon)!=null?Q:""),Ce=o=>{I.value=!1,n.value.mineDisplayOptions=o.key,V.value=o.icon};return()=>{let o,s;return e(B,null,[e("form",{ref:c,class:a.settingH5Form},[e("div",{class:[a.baseWrapper,"theme-box-shadow"]},[e(_t,{reward:y(v.value[U.SetAvatar])},null),e(B,null,[e("div",{class:a["defult-container"]},[e("span",{class:a["defult-info"]},[l("lobby.mine.selectName.default")])]),e(_,{name:"mineDisplayOptions",class:a.settingForm},{default:()=>[e(Ne,{class:a.popover,show:I.value,"onUpdate:show":t=>I.value=t,offset:[0,0],showArrow:!1},{default:()=>e(Pe,{showDefaultInfo:!1,value:n.value.account,"onUpdate:value":t=>n.value.account=t,onChange:Ce,class:a.selectOptions,shouldUpdateName:!1},null),reference:()=>e(w,{class:[a.input,a.inputSpec],value:n.value.account,"onUpdate:value":t=>n.value.account=t},{prefix:()=>e(B,null,[n.value.mineDisplayOptions===Le.ID?e("span",null,[se("ID")]):e(i,{class:a.selectImage,src:V.value,useSkeleton:!0},null)]),suffix:()=>e(i,{src:"/lobby_asset/common/web/common/comm_icon_fh.svg",class:[a["sort-icon"],{[a.rotated]:I.value}],useSkeleton:!0},null)})})]})]),k.value&&e(_,{name:"phone"},{default:()=>[e(S,{class:[a.badgeBox,"hasBtn"],content:y(v.value[U.BindPhone]),offset:[0,b(-5)]},{default:()=>[e(w,{class:[a.input,a.inputSpec,a.noBorder,a.disabled],disabled:!0,value:n.value.phone,"onUpdate:value":t=>n.value.phone=t,placeholder:l("lobby.center.setting.phonePlaceholder")},{prefix:()=>e(i,{src:"/lobby_asset/common/web/common/input_icon_sj.svg",useSkeleton:!0},null),suffix:()=>u!=null&&u.mobile_phone?null:e("a",{class:a.bindBtn,onClick:()=>ie()},[l("lobby.center.setting.goBind")])})]})]}),C.value&&e(_,{name:"email"},{default:()=>[e(S,{class:[a.badgeBox,"hasBtn"],content:y(v.value[U.BindEmail]),offset:[0,b(-5)]},{default:()=>[e(w,{class:[a.input,a.inputSpec,a.disabled],disabled:!0,value:n.value.email,"onUpdate:value":t=>n.value.email=t,placeholder:l("lobby.center.security.email.auth.placeholder")},{prefix:()=>e(i,{width:"0.3rem",src:"/lobby_asset/common/common/login/login_icon_yx02.png",useSkeleton:!0},null),suffix:()=>u!=null&&u.email?null:e("a",{class:a.bindBtn,onClick:()=>ce()},[l("lobby.center.setting.goBind")])})]})]}),f.filter(t=>!t.isHidden).map(t=>e(_,{key:t.name,name:t.name,validateTrigger:["onBlur","onChange"],rules:[r=>be(t.name,r)]},{default:()=>[e(S,{class:a.badgeBox,content:y(v.value[t.rewardType]),offset:[0,b(-5)]},{default:()=>[e(w,{class:[a.input,a.inputSpec],value:n.value[t.name],"onUpdate:value":r=>n.value[t.name]=r,placeholder:t.placeholder,onFocus:()=>ue(t.name),onChange:()=>pe(t.name),onBlur:()=>de(t.name)},{prefix:()=>e(i,{src:t.prefix,useSkeleton:!0,svgGo:!1},null),suffix:()=>{if(me(t.name)&&!$(t.name))return e(i,{src:"/lobby_asset/common/app/common/comm_icon_verified.png",useSkeleton:!0},null);if($(t.name))return e(i,{src:"/lobby_asset/common/web/common/comm_icon_qc.svg",useSkeleton:!0,onMousedown:()=>G(t.name),onTouchend:()=>G(t.name)},null)}})]})]})),e("p",{class:a.title},[l("lobby.center.setting.enterbirthday")]),e("div",{class:a.pickerWrap},[e(_,{name:"birthday"},{default:()=>[e(S,{class:a.badgeBox,content:y(v.value[U.SetBirthDay]),offset:[0,b(-5)]},{default:()=>[e("div",{class:[a.birthdayFakeShow,d.value?a.disabled:""],onClick:()=>{d.value||(h.value=!0)}},[e("p",null,[he()]),!d.value&&e(i,{src:"/lobby_asset/common/web/common/comm_icon_fh.svg",class:a.birthdayIcon,useSkeleton:!0},null)]),!d.value&&A!=We.AgeNone&&e("div",{class:a.ageLimitTip},[l("lobby.center.setting.ageLimitTip",{age:A,date:ke})])]})]})]),D.value&&e(B,null,[e("p",{class:a.title},[l("lobby.center.setting.registerDate")]),e(_,{name:"registerTime"},{default:()=>{var t;return[e(w,{class:[a.input,a.inputSpec,(t=T.value)!=null&&t.registerTime?a.disabled:""],disabled:!0,value:n.value.registerTime,"onUpdate:value":r=>n.value.registerTime=r},{prefix:()=>e(i,{src:"/lobby_asset/common/web/profile/icon_wd_zcrq.svg",useSkeleton:!0},null)})]}})])]),e("div",{class:[a.btnArea]},[e(X,{class:[a.btn2],onClick:()=>_e()},te(o=l("lobby.common.tips.return"))?o:{default:()=>[o]}),e(X,{class:[a.btn],type:"primary",onClick:()=>Be()},te(s=l("lobby.center.setting.save"))?s:{default:()=>[s]})])]),e(Re,{className:"borderRadius",class:a["popup-date-picker"],show:h.value,"onUpdate:show":t=>h.value=t,position:"bottom"},{default:()=>[e(Ze,{minDate:new Date(1940,0,1),maxDate:R,modelValue:L.value,"onUpdate:modelValue":t=>L.value=t,onConfirm:we,onCancel:()=>h.value=!1,title:l("lobby.center.setting.selectDate"),columnsType:P?["year","month","day"]:["day","month","year"]},null)]})])}}}),Pt="_main_1q7pc_17",Lt={main:Pt},[Wt]=qe("pages-setting"),Qt=q({name:Wt,setup(){const c=ne();return re(async()=>{await c.getVipLevelList()}),()=>{const{t:n}=E(),{back:g}=oe();return e(Me,null,{header:()=>e(He,{onBack:()=>g()},{default:()=>e(B,null,[n("lobby.header.menus.settings")])}),default:()=>e("div",{class:Lt.main},[e(Nt,null,null)])})}}});export{Qt as default};
//# sourceMappingURL=SettingIndex.SEKWKy4d.js.map
