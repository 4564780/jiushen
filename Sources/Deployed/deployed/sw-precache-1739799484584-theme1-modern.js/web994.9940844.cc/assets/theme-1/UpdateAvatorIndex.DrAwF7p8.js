import{a as W,az as N,B as L,I as f,Y as w,v as C,q as x,fk as h,w as A,fl as k,a5 as O,eD as B}from"./main.C8q1iJMV.js";import{u as P}from"./useSettingForm.C_htFHpH.js";import{S}from"./SubscriptCompIndex.CMEe5GR0.js";import{e as I}from"../vendors/vendor-default.CjiYZF7Q.js";import{l as U,r as i,f as z,o as D,a as T,w as G,p as a,C as V}from"../vendors/vendor-@vue.DNlpgob2.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import"../vendors/vendor-stable.LD58Pbb3.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";var l=(t=>(t[t.MAN=1]="MAN",t[t.WOMAN=2]="WOMAN",t))(l||{});const q="_avatarListWrapper_aujef_17",F="_avatarContetWrap_aujef_22",H="_radioArea_aujef_32",Y="_radio_aujef_32",Z="_scale_aujef_62",J="_active_aujef_72",K="_noActiveWoMan_aujef_77",Q="_noActiveMan_aujef_80",R="_scroll_aujef_83",X="_commonPage_aujef_90",$="_avatarList_aujef_17",E="_avatar_aujef_17",aa="_empty_aujef_123",ea="_save_aujef_136",ta="_btn_aujef_147",r={avatarListWrapper:q,avatarContetWrap:F,radioArea:H,radio:Y,scale:Z,active:J,noActiveWoMan:K,noActiveMan:Q,scroll:R,commonPage:X,avatarList:$,avatar:E,empty:aa,save:ea,btn:ta};function ra(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!V(t)}const[sa]=x("updateAavtor"),b=100,Aa=U({name:sa,setup(){const{t}=W(),s=i(l.MAN),n=i(""),u=i([]),v=i([]),_=i(!0),{userInfos:o,updateUserInfos:g}=N(),{back:d}=P(),p=z(()=>{var c;const e=(c=u.value.filter(j=>j.url===n.value)[0])==null?void 0:c.sex;return e||(o==null?void 0:o.age)}),m=async()=>{try{_.value=!0;const e=await h();u.value=e!=null?e:[],u.value.length>0&&(n.value=(o==null?void 0:o.portrait_id)||u.value[0].url,s.value=p.value,v.value=u.value.filter(c=>c.sex===s.value))}finally{_.value=!1}};D(()=>{m()}),T(()=>{m()}),G(()=>s.value,e=>{v.value=u.value.filter(c=>c.sex===e)});const y=async()=>{if(n.value===(o==null?void 0:o.portrait_id)){A({type:"warn",message:t("lobby.center.setting.noChangeToast")}),d();return}const[e]=await I(k({url:n.value,sex:s.value===p.value?s.value:p.value}));if(e){console.error("update avatar error:",e);return}o&&g({portrait_id:n.value,age:p.value}),A.success(t("lobby.center.setting.success")),setTimeout(()=>{d()},500)},M=()=>_.value?a(O,{class:r.commonPage},null):v.value.length?a("ul",{class:r.avatarList},[v.value.map(e=>a("li",{class:{[r.avatar]:!0,[r.active]:n.value===e.url},onClick:()=>n.value=e.url,key:e.url},[a(f,{isApng:!0,src:e.url,width:b+"",height:b+"",useSkeleton:!0},null),n.value===e.url&&a(S,null,null)]))]):a(B,{text:t("lobby.modal.noData")},null);return()=>a(C,null,{header:()=>a(L,{onBack:()=>d()},{default:()=>t("lobby.center.setting.updateAvatar")}),default:()=>{let e;return a("div",{class:r.avatarListWrapper},[a("div",{class:r.avatarContetWrap},[a("div",{class:r.radioArea},[a("div",{class:{[r.radio]:!0,[r.active]:s.value===l.MAN,[r.noActiveMan]:s.value!==l.MAN},onClick:()=>s.value=l.MAN},[a("span",{class:r.scale},[a(f,{src:"/lobby_asset/common/web/profile/img_szxb1.svg"},null)]),a("span",null,[t("lobby.center.setting.man")])]),a("div",{class:{[r.radio]:!0,[r.active]:s.value===l.WOMAN,[r.noActiveWoMan]:s.value!==l.WOMAN},onClick:()=>s.value=l.WOMAN},[a("span",null,[a(f,{src:"/lobby_asset/common/web/profile/img_szxb2.svg"},null)]),a("span",null,[t("lobby.center.setting.woman")])])]),a("div",{class:r.scroll},[M()])]),a("div",{class:r.save},[a(w,{type:"primary",class:r.btn,onClick:()=>y()},ra(e=t("lobby.center.setting.save"))?e:{default:()=>[e]})])])}})}});export{Aa as default};
//# sourceMappingURL=UpdateAvatorIndex.DrAwF7p8.js.map
