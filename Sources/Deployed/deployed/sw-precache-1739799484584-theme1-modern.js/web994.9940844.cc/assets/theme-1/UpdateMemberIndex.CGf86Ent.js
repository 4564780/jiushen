import{a as V,kw as D,a0 as q,kz as N,kA as Q,gZ as M,ha as F,aX as G,a4 as b,ky as O,hC as E,h4 as g,kB as z,a3 as P,h7 as X,h1 as c,ks as Z,ku as j,kt as f,h2 as x,w as H}from"./main.C8q1iJMV.js";import{M as J}from"./tabs.C8gMd3cQ.js";import{a as K,b as W}from"./member.0SA-nvjg.js";import{I as Y}from"./InfoListIndex.sqsON9bW.js";import{h as _}from"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-swiper.ZXc-sUCV.js";import{l as R,f as $,p as t,F as B,v as S,r as v}from"../vendors/vendor-@vue.DNlpgob2.js";import{M as ee}from"./ModalIndex.BOL5WFtp.js";import{R as ae}from"./RemarkIndex.DpHXqo9x.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-stable.LD58Pbb3.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";const le=R({props:{max:[String,Number],modelValue:[String,Number],placeholder:String,label:String,required:Boolean,showRequired:{type:Boolean,default:!0},name:{type:String,default:"loanQuota"}},setup(e,{emit:d}){const{t:i}=V(),m=D("isAllowLoan"),s=$({get:()=>e.modelValue,set:o=>d("update:modelValue",o)});return()=>m.value?t(b,{name:e.name,showRequired:e.showRequired,required:e.required,label:()=>{var o;return t(B,null,[(o=e.label)!=null?o:i("lobby.club.loanLimit"),e.max&&t("span",{class:M("text-neutral2")},[" ",S("("),i("lobby.club.max"),F(e.max||0),S(")")])])},rules:o=>e.required&&(!G(o)||o==="")?i("lobby.club.placeholder.loanLimit"):!0},{default:()=>{var o;return[t(q,{value:s.value,"onUpdate:value":a=>s.value=a,onBlur:()=>{var r;let a=s.value;a&&e.max&&_(a).isGreaterThan((r=e.max)!=null?r:0)&&(a=e.max),s.value=N(Q(a))},placeholder:(o=e.placeholder)!=null?o:i("lobby.club.placeholder.loanLimit"),type:"number"},null)]}}):null}}),he=R({setup(){const{t:e}=V(),d=v(),i=O(),{visible:m,openOptions:s}=E("updateClubMember"),o=v(),a=v({userId:0,isBanVerify:!0,isBanScore:!0,remark:""}),{data:r,isLoading:I,execute:k}=g(K),{error:w,isLoading:L,execute:A}=g(W),T=async()=>{var n;const l=(n=s.value)==null?void 0:n.id;l&&(await k(l),r.value&&(a.value=r.value,a.value.remark=""))},C=()=>{var n;if(!a.value||!r.value||!((n=s.value)!=null&&n.id))return;const l=a.value;return A({...a.value,editType:0,userId:s.value.id,loanQuota:Number(l.loanQuota)||0,isBanVerify:l.memberRole===f.Member?!1:l.isBanVerify,isBanScore:l.memberRole===f.Member?!1:l.isBanScore})},U=async()=>{var l;(l=s.value)!=null&&l.id&&(await C(),w.value||(H({type:"success",message:e("lobby.club.actionSucessTips.base")}),i.needReloadTabMap[J.Tab.Member]=!0,m.value=!1))};return()=>t(ee,{ref:o,show:m.value,"onUpdate:show":l=>m.value=l,onOpen:T,loading:I.value||L.value,title:e("lobby.club.edit"),buttons:[{text:e("lobby.club.cancel"),plain:!0},{text:e("lobby.club.confirm"),closeModalOnClick:!1,onClick:()=>{var l;return(l=d.value)==null?void 0:l.submit()}}]},{default:()=>{var l,n,p;return[t(Y,{list:[{label:e("lobby.club.memberID"),value:(l=r.value)==null?void 0:l.userId},{label:e("lobby.club.memberAccount"),value:(n=r.value)==null?void 0:n.userAcc},{label:e("lobby.club.realName"),value:z((p=r.value)==null?void 0:p.realName)}]},null),t(P,{class:[X("form"),M("mt-20")],onSubmit:U,ref:d,layout:"vertical"},{default:()=>{var y,h;return[t(le,{max:(y=r.value)==null?void 0:y.memberMaxLoan,modelValue:a.value.loanQuota,"onUpdate:modelValue":u=>a.value.loanQuota=u},null),t(b,{name:"userStatus",label:e("lobby.club.accountStatus")},{default:()=>[t(c,{modelValue:a.value.memberStatus,"onUpdate:modelValue":u=>a.value.memberStatus=u,list:Z().list},null)]}),t(b,{name:"memberRole",label:e("lobby.club.memberRole")},{default:()=>[t(c,{modelValue:a.value.memberRole,"onUpdate:modelValue":u=>a.value.memberRole=u,list:j({useAll:!1,listLevel:f.AssistantManager}).list,onChange:()=>{var u;(u=o.value)==null||u.scrollTo(0)}},null)]}),((h=a.value)==null?void 0:h.memberRole)!==f.Member&&t(B,null,[t(b,{name:"isBanVerify",label:e("lobby.club.isAllowAuditRegist")},{default:()=>[t(c,{modelValue:a.value.isBanVerify,"onUpdate:modelValue":u=>a.value.isBanVerify=u,list:x().list},null)]}),t(b,{name:"isBanScore",label:e("lobby.club.isAllowAddScore")},{default:()=>[t(c,{modelValue:a.value.isBanScore,"onUpdate:modelValue":u=>a.value.isBanScore=u,list:x().list},null)]})]),t(ae,{modelValue:a.value.remark,"onUpdate:modelValue":u=>a.value.remark=u,placeholder:e("lobby.club.placeholder.reason")},null)]}})]}})}});export{he as default};
//# sourceMappingURL=UpdateMemberIndex.CGf86Ent.js.map
