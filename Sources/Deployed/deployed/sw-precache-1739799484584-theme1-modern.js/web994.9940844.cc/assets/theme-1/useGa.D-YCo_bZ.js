import{bU as p,gl as P,g2 as m,gm as y,bY as e,gn as v,gq as h,a as R,az as G,r as w,g5 as O,w as V,cX as H,gE as N}from"./main.C8q1iJMV.js";import{k as M,l as b,m as D}from"./Setting.CRobMkOU.js";import{f as l,h as E,r as L}from"../vendors/vendor-@vue.DNlpgob2.js";import{z as S,U as g}from"../vendors/vendor-lodash.BYdGDldS.js";function A(){const{validateConfigStatus:r}=p(),{refActive:t}=P(),i=m();return l(()=>{const o=r();return{bind:i.state.type===y.Bind,edit:i.state.type===y.Edit,verify:i.state.type===y.Verify,activePhone:t.value===e.PHONE,activeEmail:t.value===e.EMAIL,activeGa:t.value===e.GA,activeLoginpass:t.value===e.LOGINPASS,activeWithdrawpass:t.value===e.WITHDRAWPASS,activeQuestion:t.value===e.QUESTION,activeThirdParty:t.value===e.THIRDPARTY,verifyPhone:i.state.verify===e.PHONE,verifyEmail:i.state.verify===e.EMAIL,verifyGa:i.state.verify===e.GA,verifyLoginpass:i.state.verify===e.LOGINPASS,verifyWithdrawpass:i.state.verify===e.WITHDRAWPASS,verifyQuestion:i.state.verify===e.QUESTION,verifyThirdParty:i.state.verify===e.THIRDPARTY,isBinded:{phone:o[e.PHONE],email:o[e.EMAIL],ga:o[e.GA],loginPass:o[e.LOGINPASS],withdrawPass:o[e.WITHDRAWPASS],question:o[e.QUESTION],thirdParty:o[e.THIRDPARTY]}}})}function U(){const{refActive:r}=P(),t=E({onVerify:void 0,onModify:void 0}),{securityConfig:i,firstSettingWithdrawPassword:o}=p(),c=A(),n=l(()=>{const{THIRDPARTY:s}=e;if(v(r.value,s))return!0;const a=o(r.value);return a?a.length:u.value.length>=1}),u=l(()=>{const{THIRDPARTY:s}=e;if(!h(r.value))return[];if(v(r.value,s))return[];const a=o(r.value);return a||i()});return{verifys:u,needVerify:n,submit:()=>{var s,a,d;c.value.bind||c.value.edit?n.value?(s=t.onVerify)==null||s.call(t):(a=t.onModify)==null||a.call(t):(d=t.onModify)==null||d.call(t)},onVerify:s=>{t.onVerify=s},onModify:s=>{t.onModify=s}}}function F(){const{t:r}=R(),t=G(),i=m(),o=E({googleCode:""}),{needVerify:c}=U(),n=A(),u=L(""),f=async()=>{if(!n.value.isBinded.ga){o.googleCode=i.fields().googleCode;try{await M({data:{code:o.googleCode}})}catch(s){return Promise.reject(s)}}};return{apiVerify:f,apiModify:async()=>{const s=i.fields();c.value||await f(),c.value||(o.googleCode=s.googleCode,s.googleCode=void 0);try{await(n.value.isBinded.ga?()=>b({data:{switch:0,secondVerify:S(s,g)}}):()=>D({data:{code:o.googleCode,secondVerify:S(s,g)}}))(),u.value=n.value.isBinded.ga?r("lobby.center.security.ga.update.closeSuccess"):r("lobby.center.security.ga.update.openSuccess")}catch(a){const{SECURITY_CONFIG_EXPIRED:d}=H,{code:T}=w(a);return[d].includes(T)?(O("CONFIG_CHANGE_ERR").emit(),Promise.reject()):Promise.reject(a)}},setFieldValue:async()=>{const{CLOSE:s,OPEN:a}=N;u.value&&await V.successSync({message:u.value}),t.updateUserInfos({is_open_google_auth:n.value.isBinded.ga?s:a})}}}export{A as a,F as b,U as u};
//# sourceMappingURL=useGa.D-YCo_bZ.js.map
