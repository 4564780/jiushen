import{a as m,kk as L,kn as w,bL as l,bQ as f,bR as h,u as A,ca as v,ko as P,bM as E,w as S,kp as N,bO as V,al as x,bN as B,aB as G,c_ as o}from"./main.C8q1iJMV.js";import{R as _,V as z}from"./ModalContentIndex.Dj08dEyt.js";import{e as k}from"../vendors/vendor-default.CjiYZF7Q.js";import{r as R}from"../vendors/vendor-@vue.DNlpgob2.js";const Y=()=>{const{t:u}=m(),d=R(null),g=R(null),a=R(!1),y=s=>{d.value=s,setTimeout(()=>{d.value=null},500)},C=async(s,e)=>{var b;if(a.value)return;const{id:c,receiveDuration:i,oldRewardId:n,logsCategory:t,reward:r}=s;if((b=L().receivedList)!=null&&b.includes(c))return;if(i>0)return y(c);if(t===w.Large){l.check({eventData:{receiveStatus:f.PendingCheck,receiveCategory:h.Max,amount:r,taskCallback:async()=>{A().close("canReceive")}},checkOptions:{[v.largeAmount]:!0}});return}if(a.value=!0,await l.check({checkOptions:{[v.task]:!0,[v.forbidReceive]:!0,[v.receiveType]:!0},eventData:{receiveDeviceType:s==null?void 0:s.receiveDeviceType,taskCondition:s==null?void 0:s.receiveCondition}})){a.value=!1;return}g.value=c,n>0?M(n,e):O(s,e)},T=s=>{const{activeType:e,activeId:c,ruleId:i,template:n,id:t}=s;switch(e){case o.Events:return{activeId:c,receiveId:"".concat(t)};case o.Task:return{template:n,ruleid:+i,taskid:c,receiveLogId:t};case o.Rebate:return{receiveId:t};case o.Vip:return{types:z.get(n),logId:t};case o.RechargeFund:return t;default:return}},M=async(s,e)=>{const[c]=await k(P({id:s}));if(a.value=!1,c){await l.checkRes({config:{err:c,backupErrMsg:u("lobby.reward.base.receivedError")},checkOptions:{[E.userRestrict]:!0}}),e==null||e(!1);return}S.success(u("lobby.event.invest.receiveSuccess")),e==null||e(!0)},O=async(s,e)=>{a.value=!0;const{activeType:c,logsCategory:i,reward:n}=s,t=i===w.Manual?N:_.get(c),r=T(s),[p]=r?await k(t(r)):await k(t());if(a.value=!1,p){await l.checkRes({config:{err:p,backupErrMsg:u("lobby.reward.base.receivedError")},checkOptions:{[E.userRestrict]:!0}}),e==null||e(!1);return}S.success(u("lobby.event.invest.receiveSuccess")),V(n),x.Receive(),B().updatePrize(),G().freshDiscountRedDot(),e==null||e(!0)};return{shakeId:d,receiveId:g,isReceiveLoading:a,handleBtnShake:y,handleReceive:C}};export{Y as u};
//# sourceMappingURL=useReceiveOne.D6y37THV.js.map
