import{a as A,Y as U,q as C,d1 as q,kk as W,t as z,a6 as $,aE as F,kl as K,cZ as S,bu as H,hC as V,aB as Z}from"./main.C8q1iJMV.js";import{E as J}from"./PersistCheckboxIndex.oRsUV5rG.js";import{D as Q}from"./DialogLayoutIndex.BLsFiggH.js";import{E as B}from"./const.kNgtypBJ.js";import{R as L,E as P}from"./ReceiveCountdownIndex.C4K-6t0P.js";import{u as X}from"./useBtnText.OX_7rlgO.js";import{u as ee}from"./useReceiveOne.D6y37THV.js";import{l as k,E as te,f as m,p as e,A as M,r as g,q as ae,n as ne}from"../vendors/vendor-@vue.DNlpgob2.js";import{L as N}from"./ListItemIndex.D0wv8G85.js";import{M as Y,u as oe,S as le,R as se,a as re}from"./SlideItemIndex.1G2Tn6E0.js";import{S as ie,a as ce}from"../vendors/vendor-swiper.ZXc-sUCV.js";import"../vendors/vendor-default.CjiYZF7Q.js";import"../vendors/vendor-bignumber.BRr1dcww.js";import"../vendors/vendor-lodash.BYdGDldS.js";import"../vendors/vendor-stable.LD58Pbb3.js";import"../vendors/vendor-@intlify.BmUtFfVu.js";import"../vendors/vendor-@sentry.EjpkRnd3.js";import"../vendors/vendor-dom-to-image.C12bjAh8.js";import"./ModalContentIndex.Dj08dEyt.js";import"./index.C870Y1OX.js";import"./index.nTWlx4yZ.js";import"./index.JiQV5KHQ.js";import"./LazyLoader.cfovhYZu.js";import"./SourceTextIndex.B2mGCFWw.js";import"./ListItemIndex.Bcx-5lrU.js";var b=(t=>(t[t.TODAY=0]="TODAY",t[t.TOMORROW=1]="TOMORROW",t[t.DISTRIBUTED=2]="DISTRIBUTED",t))(b||{});const de="_btnBox_feepl_17",ue="_btnText_feepl_22",ve="_resetCountdown_feepl_36",I={btnBox:de,btnText:ue,resetCountdown:ve,"distributed-btn":"_distributed-btn_feepl_40"},[me]=C("pages-dialogs-can-receive-pop-list-btn"),G=k({name:me,props:{listItem:{type:Object,default:null},type:{type:Number,default:b.TODAY}},setup(t){const{t:l}=A(),p=ee(),r=te("refreshData"),{textMapper:i}=X(),R=m(()=>{var n;return((n=t.listItem)==null?void 0:n.receiveDuration)<0}),h=m(()=>{var n;return((n=t.listItem)==null?void 0:n.receiveDuration)>0}),D=async()=>{var n;if((n=t.listItem)!=null&&n.canGo){q(t.listItem);return}r&&p.handleReceive(t.listItem,r)},o=()=>{r==null||r()};return()=>{const{id:n,receiveDuration:u,canGo:c}=t.listItem;if(t.type===b.TODAY){const d=c?B.Goto:B.PendingReceive;return e("div",{class:I.btnBox},[e(U,{type:c?"primary":"success",size:"small",onClick:D},{default:()=>{var s,w;return[e("span",{class:I.btnText},[(w=(s=i.value)[d])==null?void 0:w.call(s)]),R.value&&e(L,{class:I.resetCountdown,textFormatType:P.None,duration:u,onComplete:o},null),h.value&&e(L,{class:I.resetCountdown,textFormatType:P.None,duration:u,onComplete:o},null)]}})])}else{if(t.type===b.TOMORROW)return e("div",{class:[I.btnBox,p.shakeId.value===n?I.shake:""]},[e(U,{disabled:!0,size:"small",onClick:()=>p.handleBtnShake(n)},{default:()=>{var d,s,w;return[(s=(d=i.value)[B.GrayPendingReceive])==null?void 0:s.call(d),((w=t.listItem)==null?void 0:w.receiveDuration)>0&&h.value&&e(L,{class:I.resetCountdown,textFormatType:P.None,duration:u,onComplete:o},null)]}})]);if(t.type===b.DISTRIBUTED)return e("div",{class:I["distributed-btn"]},[l("lobby.event.listedRewards.distributed")])}}}}),pe="_placeholder_kn4bm_17",T={placeholder:pe,"list-chunk":"_list-chunk_kn4bm_22","claim-title":"_claim-title_kn4bm_27"},[fe]=C("pages-dialogs-can-receive-pop-list"),ye=k({name:fe,setup(){const{t}=A(),l=W(),p=m(()=>l.isLoading?"nested-loading":l.listErr?"retry":!i.value&&!R.value&&!h.value?"empty":null),r=m(()=>{const{pendingRewardList:o=[]}=(l==null?void 0:l.receiveRewardPop)||{},n=(o==null?void 0:o.filter(c=>!c.canGo&&c.receiveDuration<=0))||[],u=(o==null?void 0:o.filter(c=>c.canGo||c.receiveDuration>0))||[];return[...n,...u]}),i=m(()=>{var o,n;return((n=(o=l.receiveRewardPop)==null?void 0:o.pendingRewardList)==null?void 0:n.length)!==0}),R=m(()=>{var o,n;return((n=(o=l.receiveRewardPop)==null?void 0:o.collectTomorrowList)==null?void 0:n.length)!==0}),h=m(()=>{var o,n;return((n=(o=l.receiveRewardPop)==null?void 0:o.receivedTodayList)==null?void 0:n.length)!==0});return M("refreshData",async()=>{await F.setCacheExpired([K]),l.getCanReceiveRewardPop()}),()=>e($,{class:T.placeholder,type:p.value},{default:()=>{var o,n,u,c,d;return[i.value&&e("div",{class:[T["claim-title"]]},[t("lobby.event.listedRewards.toBeCollectedToday")]),i.value&&e("div",{class:T["list-chunk"]},[(o=r.value)==null?void 0:o.map(s=>e(N,{listItem:s,key:s.id},{default:()=>[e(G,{listItem:s,type:b.TODAY},null)]}))]),R.value&&e(z,{html:t("lobby.event.listedRewards.collectTomorrow"),class:[T["claim-title"]],tag:"div"},null),R.value&&e("div",{class:T["list-chunk"]},[(u=(n=l.receiveRewardPop)==null?void 0:n.collectTomorrowList)==null?void 0:u.map(s=>e(N,{listItem:s,key:s.id},{default:()=>[e(G,{listItem:s,type:b.TOMORROW},null)]}))]),h.value&&e("div",{class:[T["claim-title"]]},[t("lobby.event.listedRewards.receivedToday")]),h.value&&e("div",{class:T["list-chunk"]},[(d=(c=l.receiveRewardPop)==null?void 0:c.receivedTodayList)==null?void 0:d.map(s=>e(N,{listItem:s,key:s.id},{default:()=>[e(G,{listItem:s,type:b.DISTRIBUTED},null)]}))])]}})}}),_={"canreceive-top-box":"_canreceive-top-box_u0d3o_17","canreceive-header":"_canreceive-header_u0d3o_25","canreceive-placeholder":"_canreceive-placeholder_u0d3o_32","redpack-mode":"_redpack-mode_u0d3o_36","swiper-container":"_swiper-container_u0d3o_36","swiper-slide":"_swiper-slide_u0d3o_40","treasure-mode":"_treasure-mode_u0d3o_46","image-loaded":"_image-loaded_u0d3o_58","claim-title":"_claim-title_u0d3o_71","receive-records":"_receive-records_u0d3o_82"},[Re]=C("pages-dialogs-can-receive-pop-swiper"),he=k({name:Re,props:{canReceiveStyle:{type:Number,default:S.Normal}},setup(t){const{t:l}=A(),p=g(),r=W(),i=g(null),R=g(!1),h=g(void 0),D=a=>{i.value=a},o=()=>{R.value=!0},n=()=>{var f,v;const a=r.receivedList;(f=i.value)!=null&&f.id&&r.updateReceivedList([...a,(v=i.value)==null?void 0:v.id]),i.value=null,R.value=!1,u()},u=async()=>{var a;await F.setCacheExpired([K]),r.getCanReceiveRewardPop(),(a=p.value)==null||a.initRecordData(!0)};M("refreshData",u),M("receiveSuccess",D);const c=m(()=>{var a;return r.isLoading||H().isListLoading?"nested-loading":r.listErr?"retry":(a=d.value)!=null&&a.length?null:"empty"}),d=m(()=>{const{pendingRewardList:a=[],collectTomorrowList:f=[]}=(r==null?void 0:r.receiveRewardPop)||{},v=(a==null?void 0:a.filter(x=>!x.canGo&&x.receiveDuration<=0))||[],O=(a==null?void 0:a.filter(x=>x.canGo||x.receiveDuration>0))||[],y=[...v,...O,...f];let E=[];return(y==null?void 0:y.length)<Y?E=y:E=[y[1],y[0],...y.slice(2)],E}),s=a=>{ne(()=>{var f,v;a&&((f=d.value)==null?void 0:f.length)>=Y&&((v=a==null?void 0:a.slideTo)==null||v.call(a,1,0))})},w=a=>{h.value=a.realIndex},j=m(()=>oe().getSwiperConfig(t.canReceiveStyle,!0));return()=>e("div",null,[e("div",{class:[_["claim-title"]]},[l("lobby.event.listedRewards.toBeCollectedToday")]),e("div",{class:{[_["canreceive-top-box"]]:!0,[_["redpack-mode"]]:t.canReceiveStyle===S.RedPocket,[_["treasure-mode"]]:t.canReceiveStyle===S.Treasure,[_["image-loaded"]]:R.value}},[e($,{empty:{text:l("lobby.event.luckyWheel.tabs.noData")},class:{[_["canreceive-placeholder"]]:!0},type:c.value},{default:()=>{var a;return[!!((a=d.value)!=null&&a.length)&&e(ie,ae({class:_["swiper-container"]},j.value,{"data-touchmove-allowed":!0,onInit:s,onTransitionEnd:w}),{default:()=>{var f;return[(f=d.value)==null?void 0:f.map((v,O)=>e(ce,{class:_["swiper-slide"],key:v.id},{default:()=>{var y;return[e(le,{key:v.id,slideItem:v,totolLength:(y=d.value)==null?void 0:y.length,swiperNowIdx:h.value,idx:O,canReceiveStyle:t.canReceiveStyle},null)]}}))]}})]}})]),e(se,{canReceiveStyle:t.canReceiveStyle,ref:p,class:_["receive-records"]},null),!!i.value&&e(re,{canReceiveStyle:t.canReceiveStyle,targetItem:i.value,onAnimatedEnd:n,onImageShowEnd:o},null)])}}),[_e]=C("pages-dialogs-can-receive"),je=k({name:_e,setup(){const{visible:t}=V("canReceive"),l=Z(),p=m(()=>l.canReceiveStyle===S.RedPocket||l.canReceiveStyle===S.Treasure);return()=>e(Q,{direction:"vertical",show:t.value,"onUpdate:show":r=>t.value=r,persistName:J.canReceive},{default:()=>[p.value?e(he,{canReceiveStyle:l.canReceiveStyle},null):e(ye,null,null)]})}});export{je as default};
//# sourceMappingURL=CanReceiveIndex.p_IpVbVw.js.map
